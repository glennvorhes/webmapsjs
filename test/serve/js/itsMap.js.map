{"version":3,"sources":["webpack:///itsMap.js","webpack:///webpack/bootstrap 99693f14fcb3e83c98ca?ad23","webpack:///./src/util/provide.ts?5c82","webpack:///external \"$\"?57aa","webpack:///external \"ol\"?81ed","webpack:///./src/util/makeGuid.ts?e80e","webpack:///./src/olHelpers/mapPopup.ts?5d6c","webpack:///./src/olHelpers/mapInteractionBase.ts?f419","webpack:///./src/olHelpers/quickMap.ts?1069","webpack:///./src/olHelpers/mapMove.ts?6a2b","webpack:///./src/olHelpers/projections.ts?804b","webpack:///./src/util/checkDefined.ts?bcd7","webpack:///./src/layers/LayerBase.ts?bf94","webpack:///./src/olHelpers/geocode.ts?5a2f","webpack:///./src/olHelpers/mapMoveCls.ts?cd45","webpack:///./src/olHelpers/mapPopupCls.ts?e3f7","webpack:///./src/olHelpers/quickMapBase.ts?fb65","webpack:///./src/olHelpers/zoomResolutionConvert.ts?dd4b","webpack:///./src/layers/LayerBaseVector.ts?c105","webpack:///./src/collections/LayerLegend.ts","webpack:///./src/layers/LayerBaseVectorGeoJson.ts","webpack:///./src/collections/ItsLayerCollection.ts","webpack:///./src/layers/LayerItsInventory.ts","webpack:///./src/util/colors.ts","webpack:///./src/_tests/demos/itsMap.ts"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","provide","namespace","window","gv","parts","split","nameSpace","length","util","default","$","ol","makeGuid","replace","r","Math","random","toString","provide_1","nm","mapPopupCls_1","mapPopup","MapInteractionBase","subtype","this","_map","_initialized","_subtype","init","theMap","_checkInit","initialized","msg","alert","console","log","checkInit","quickMap","options","quickMapBase_1","quickMapBase","mapMove_1","mapPopup_1","mapMoveCls_1","mapMove","proj4326","proj","Projection","code","proj3857","proj3070","undefinedOrNull","input","definedAndNotNull","zoomResolutionConvert","makeGuid_1","LayerBase","url","_url","_params","params","_legendCollapse","legendCollapse","_legendCheckbox","legendCheckbox","id","_name","animate","_opacity","opacity","_visible","visible","_source","undefined","_olLayer","_loaded","_maxResolution","zoomToResolution","minZoom","_minResolution","maxZoom","_minZoom","_maxZoom","_zIndex","zIndex","loadCallback","_legendContent","_$legendDiv","_applyCollapseCalled","_addLegendContent","legendContent","_load","loaded","getLegendDiv","additionalContent","indexOf","append","applyCollapse","addLegendContent","$expander","find","click","$this","siblings","slideToggle","hasClass","removeClass","html","addClass","trigger","refresh","source","_id","set","newId","_animate","newVal","newParams","visibility","setVisible","olLayer","setOpacity","newName","getSource","newZ","setZIndex","getOlLayer","projections_1","invalidClass","geocoderLoadingClass","Geocode","mapDiv","map","_this","inputGuid","buttonGuid","indicationLayer","layer","Vector","style","Style","image","Circle","radius","fill","Fill","color","stroke","Stroke","width","addLayer","theButton","document","getElementById","theInput","reset","$theButton","$theInput","evt","preventDefault","disabled","clear","lat","parseFloat","lon","title","v","getView","geom","Point","feat","Feature","addFeature","transform","setCenter","getCoordinates","setZoom","keyup","keyCode","__extends","extendStatics","setPrototypeOf","__proto__","Array","b","__","constructor","create","mapInteractionBase_1","checkDefined","MapMoveCls","_super","_arrLyrRequest","_arrLyrTimeout","_arrLayer","_lookupLayer","_mapMoveCallbacks","_mapMoveCallbacksLookup","_mapMoveCallbackDelays","_mapMoveCallbackContext","_mapMoveCallbackTimeout","_mapExtent","_zoomLevel","on","e","_updateMapExtent","triggerLyrLoad","type","triggerMoveCallback","theView","getZoom","extentArray","calculateExtent","getSize","minX","minY","maxX","maxY","lyr","index","eventType","clearTimeout","abort","callbackFunc","mapMoveBefore","mapMoveMakeGetParams","__this_1","innerFunction","theLayer","theIndex","_innerThis","mapMoveParams","mapMoveCallback","fail","jqXHR","statusText","always","setTimeout","onDemandDelay","ind","functionId","ctx","theFunc","__this","f","addVectorLayer","triggerOnAdd","push","addCallback","func","context","delay","FeatureLayerProperties","feature","layerIndex","selectionLayer","esriLayerName","popupContent","MapPopupCls","_arrPopupLayerIds","_arrPopupLayers","_arrPopupContentFunction","_$popupContainer","_$popupContent","_$popupCloser","_popupOverlay","_selectionLayers","_selectionLayerLookup","_mapClickFunctions","_popupChangedFunctions","_esriMapServiceLayers","_popupOpen","_popupCoordinate","_passThroughLayerFeatureArray","_currentPopupIndex","_popupContentLength","$map","target","getTarget","_ease","easing","inAndOut","Overlay","element","autoPan","autoPanAnimation","duration","getCenter","addOverlay","closePopup","queryParams","geometry","join","geometryType","layers","sr","getProjection","getCode","mapExtent","imageDisplay","returnGeometry","tolerance","_i","_a","getPopupInfo","layerFeatureObjectArray","_featuresAtPixel","featObj","props","getProperties","popupContentResponse","popupHtml","_triggerFeatSelect","nextPopup","setPosition","scrollTop","pixel","getEventPixel","hit","forEachFeatureAtPixel","vLyr","getTargetElement","cursor","$currentPopupItemNumber","$innerPopup","$layerNameSpan","clearSelection","lyrFeatObj","toFixed","layerName","addMapServicePopupContent","esriName","featLayerObject","j","hasLyr","blur","addPopupChangedFunction","chgFunction","_addPopupLayer","selectionStyle","theStyle","olStyle","addVectorPopup","popupContentFunction","removeVectorPopup","idx","splice","addMapServicePopup","addMapClickFunction","divId","center","x","y","zoom","baseSwitcher","fullScreen","addGeocode","css","osmLayer","Tile","OSM","coordinates","controls","control","defaults","attributionOptions","collapsible","view","View","Map","addControl","FullScreen","geocode_1","zoomLevel","_zoomResLookup","resolutionToZoom","resolution","LayerBase_1","LayerBaseVector","trim","_style","_autoLoad","_onDemand","onDemand","_onDemandDelay","mapMoveObj","_mapMove","_mapMoveMakeGetParams","_mapMoveParams","minResolution","maxResolution","renderOrder","_projectionMap","_projection4326","addFeatures","featureCollection","evtType","extent","extend","setStyle","mapProj","getFeatures","LayerGroup","groupConfig","parent","groupLayers","groupLayersLookup","groupGroups","groupGroupsLookup","itemIdArray","groupId","groupName","allGroupLookup","root","allGroupArray","allLayerArray","allLayerLookup","layerParentLookup","collapse","addCheck","addGroup","parents","parentGroup","newGroup","addLegendLayer","newLayer","getLegendHtml","legendId","legendHtml","legendTitle","_buildLegend","layerDivClasses","itemIds","theGroup","theHml","itemId","otherGroup","slice","LayerLegend","legendItems","legendItems_1","scaleDependent","$divElement","_legendItems","layerGroup","_buildTree","_b","ext","$lyrLi","change","legendLayerLis","checked","lyrId","prop","oneItem","groupItem","items","layerItem","LayerBaseVector_1","LayerBaseVectorGeoJson","_geoJsonFormat","format","GeoJSON","_transform","dataProjection","featureProjection","autoLoad","readFeatures","colors","LayerItsInventory_1","itsConfig","itsType","itsIconConfig","defaultName","defaultIcon","iconArray","itsIcon","itsLineConfig","defaultColor","hexAlphaToRgbOrRgba","lineArray","ItsLayerCollection","exclude","_layers","lyrConfig","inventLyr","checkStyleNumber","itsLineStyle","configCount","defaultWidth","defineStyle","_iconUrlRoot","Icon","src","crossOrigin","symbolProp","iconUrl","thisProp","toLocaleLowerCase","colr","defineLegend","iconHeight","outHtml","a","_c","ls","LayerBaseVectorGeoJson_1","LayerItsInventory","addToLegend","resource","addPopup","featureGuid","lowerLeft","lowerLeftCoordinates","upperRight","upperRightCoordinates","L","R","B","T","_hex","hexDigits","isNaN","rgb2hex","rgb","rgb1","match","toUpperCase","hexString","alphaVal","charAt","substring","parseInt","g","rgbToRgba","alpha","pieces","makeBlueGreenRedGradient","minVal","maxVal","flipColors","theVal","ratio","chk","percent","floor","makeBlueGreenRedGradientZScore","median","stdDev","grd","zScore","ItsLayerCollection_1","LayerLegend_1","quickMap_1","itsLayerCollection","layerArray"],"mappings":"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","file":"itsMap.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 72);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 12/10/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * create a namespace on the gv object\r\n * @param {string} namespace to create\r\n * @returns {object} object representing the namespace\r\n */\r\nfunction provide(namespace) {\r\n    \"use strict\";\r\n    if (typeof window.gv == 'undefined') {\r\n        window.gv = {};\r\n    }\r\n    var parts = namespace.split('.');\r\n    var nameSpace = window.gv;\r\n    for (var i = 0; i < parts.length; i++) {\r\n        var newObject = nameSpace[parts[i]];\r\n        if (typeof newObject == 'undefined') {\r\n            nameSpace[parts[i]] = {};\r\n        }\r\n        nameSpace = nameSpace[parts[i]];\r\n    }\r\n    return nameSpace;\r\n}\r\nprovide('util');\r\nwindow.gv.util.provide = provide;\r\nexports.default = provide;\r\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\nmodule.exports = $;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\nmodule.exports = ol;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar provide_1 = __webpack_require__(0);\r\nvar nm = provide_1.default('util');\r\n/**\r\n * guids are used to uniquely identify groups and features\r\n * @returns {string} a new guid\r\n */\r\nfunction makeGuid() {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'\r\n        .replace(/[xy]/g, function (c) {\r\n        var r = Math.random() * 16 | 0, v = c == 'x' ? r : r & 0x3 | 0x8;\r\n        return v.toString(16);\r\n    });\r\n}\r\nexports.makeGuid = makeGuid;\r\nnm.makeGuid = makeGuid;\r\nexports.default = makeGuid;\r\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar mapPopupCls_1 = __webpack_require__(13);\r\n/**\r\n * The single popup object catch is that it is common to multimap pages\r\n * @type {MapPopupCls}\r\n */\r\nexports.mapPopup = new mapPopupCls_1.default();\r\nexports.default = exports.mapPopup;\r\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Created by gavorhes on 12/8/2015.\r\n */\r\nvar provide_1 = __webpack_require__(0);\r\nvar nm = provide_1.default('olHelpers');\r\n/**\r\n * base interaction\r\n */\r\nvar MapInteractionBase = (function () {\r\n    /**\r\n     * map interaction base\r\n     * @param subtype - the interaction subtype\r\n     */\r\n    function MapInteractionBase(subtype) {\r\n        this._map = null;\r\n        this._initialized = false;\r\n        this._subtype = subtype;\r\n    }\r\n    /**\r\n     * base initializer, returns true for already initialized\r\n     * @param theMap - the ol Map\r\n     * @returns true for already initialized\r\n     */\r\n    MapInteractionBase.prototype.init = function (theMap) {\r\n        if (!this._initialized) {\r\n            this._map = theMap;\r\n            this._initialized = true;\r\n        }\r\n    };\r\n    Object.defineProperty(MapInteractionBase.prototype, \"map\", {\r\n        /**\r\n         * get reference to the ol map object\r\n         * @returns {ol.Map} the map object\r\n         */\r\n        get: function () {\r\n            return this._map;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MapInteractionBase.prototype, \"initialized\", {\r\n        /**\r\n         * get if is initialized\r\n         * @returns {boolean} is initialized\r\n         */\r\n        get: function () {\r\n            return this._initialized;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Check the initialization status and throw exception if not valid yet\r\n     * @protected\r\n     */\r\n    MapInteractionBase.prototype._checkInit = function () {\r\n        if (!this.initialized) {\r\n            var msg = this._subtype + \" object not initialized\";\r\n            alert(msg);\r\n            console.log(msg);\r\n            throw msg;\r\n        }\r\n    };\r\n    /**\r\n     * Check the initialization status and throw exception if not valid yet\r\n     */\r\n    MapInteractionBase.prototype.checkInit = function () {\r\n        this._checkInit();\r\n    };\r\n    return MapInteractionBase;\r\n}());\r\nexports.MapInteractionBase = MapInteractionBase;\r\nnm.MapInteractionBase = MapInteractionBase;\r\nexports.default = MapInteractionBase;\r\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 12/15/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar quickMapBase_1 = __webpack_require__(14);\r\nvar provide_1 = __webpack_require__(0);\r\nvar mapMove_1 = __webpack_require__(7);\r\nvar mapPopup_1 = __webpack_require__(4);\r\nvar nm = provide_1.default('olHelpers');\r\n/**\r\n * Sets up a map with some default parameters and initializes\r\n * mapMove and mapPopup\r\n *\r\n * @param {object} [options={}] config options\r\n * @param {string} [options.divId=map] map div id\r\n * @param {object} [options.center={}] center config object\r\n * @param {number} [options.center.x=-10018378] center x, web mercator x or lon\r\n * @param {number} [options.center.y=5574910] center y, web mercator y or lat\r\n * @param {number} [options.zoom=7] zoom level\r\n * @param {number} [options.minZoom=undefined] min zoom\r\n * @param {number} [options.maxZoom=undefined] max zoom\r\n * @param {boolean} [options.baseSwitcher=true] if add base map switcher\r\n * @param {boolean} [options.fullScreen=false] if add base map switcher\r\n * @returns {ol.Map} the ol map\r\n */\r\nfunction quickMap(options) {\r\n    if (options === void 0) { options = {}; }\r\n    var m = quickMapBase_1.quickMapBase(options);\r\n    mapMove_1.default.init(m);\r\n    mapPopup_1.default.init(m);\r\n    return m;\r\n}\r\nexports.quickMap = quickMap;\r\nnm.quickMap = quickMap;\r\nexports.default = quickMap;\r\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar mapMoveCls_1 = __webpack_require__(12);\r\n/**\r\n * The single map move object catch is that it is common to multimap pages\r\n * @type {MapMoveCls}\r\n */\r\nexports.mapMove = new mapMoveCls_1.default();\r\nexports.default = exports.mapMove;\r\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Created by gavorhes on 10/3/2016.\r\n */\r\nvar ol = __webpack_require__(2);\r\nexports.proj4326 = new ol.proj.Projection({ code: 'EPSG:4326' });\r\nexports.proj3857 = new ol.proj.Projection({ code: 'EPSG:3857' });\r\nexports.proj3070 = new ol.proj.Projection({ code: 'EPSG:3070' });\r\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar provide_1 = __webpack_require__(0);\r\nvar nm = provide_1.default('util.checkDefined');\r\n/**\r\n * check if the input is undefined or null\r\n * @param input - input pointer\r\n * @returns true undefined or null\r\n */\r\nfunction undefinedOrNull(input) {\r\n    \"use strict\";\r\n    return (typeof input === 'undefined' || input === null);\r\n}\r\nexports.undefinedOrNull = undefinedOrNull;\r\nnm.undefinedOrNull = undefinedOrNull;\r\n/**\r\n * check if the input is defined and not null\r\n * @param input - input pointer\r\n * @returns true defined and not null\r\n */\r\nfunction definedAndNotNull(input) {\r\n    \"use strict\";\r\n    return !(undefinedOrNull(input));\r\n}\r\nexports.definedAndNotNull = definedAndNotNull;\r\nnm.definedAndNotNull = definedAndNotNull;\r\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar zoomResolutionConvert = __webpack_require__(17);\r\nvar provide_1 = __webpack_require__(0);\r\nvar makeGuid_1 = __webpack_require__(3);\r\nvar $ = __webpack_require__(1);\r\nvar nm = provide_1.default('layers');\r\n/**\r\n * The base layer class\r\n * @abstract\r\n */\r\nvar LayerBase = (function () {\r\n    /**\r\n     * The base layer for all others\r\n     * @param {string} url - url for source\r\n     * @param {object} options - config\r\n     * @param {string} [options.id=makeGuid()] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] - the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] - the z index for the layer\r\n     * @param {function} [options.loadCallback] - function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] - if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] - if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent=undefined] - additional content to add to the legend\r\n     */\r\n    function LayerBase(url, options) {\r\n        if (options === void 0) { options = {}; }\r\n        options = options || {};\r\n        if (typeof url !== 'string') {\r\n            throw 'Invalid URL';\r\n        }\r\n        this._url = url;\r\n        this._params = typeof options.params == 'object' ? options.params : {};\r\n        this._legendCollapse = typeof options.legendCollapse == 'boolean' ? options.legendCollapse : false;\r\n        this._legendCheckbox = typeof options.legendCheckbox == 'boolean' ? options.legendCheckbox : true;\r\n        this.id = options.id || makeGuid_1.default();\r\n        this._name = options.name || 'Unnamed Layer';\r\n        this.animate = false;\r\n        this._opacity = typeof options.opacity == 'number' ? options.opacity : 1;\r\n        if (this._opacity > 1) {\r\n            this._opacity = 1;\r\n        }\r\n        else if (this._opacity < 0) {\r\n            this._opacity = 0;\r\n        }\r\n        this._visible = typeof options.visible === 'boolean' ? options.visible : true;\r\n        this._source = undefined;\r\n        /**\r\n         *\r\n         * @protected\r\n         */\r\n        this._olLayer = undefined;\r\n        this._loaded = false;\r\n        this._maxResolution = zoomResolutionConvert.zoomToResolution(options.minZoom);\r\n        if (typeof this._maxResolution !== 'undefined') {\r\n            this._maxResolution += 0.00001;\r\n        }\r\n        this._minResolution = zoomResolutionConvert.zoomToResolution(options.maxZoom);\r\n        this._minZoom = typeof options.minZoom == 'number' ? options.minZoom : undefined;\r\n        this._maxZoom = typeof options.maxZoom == 'number' ? options.maxZoom : undefined;\r\n        this._zIndex = typeof options.zIndex == 'number' ? options.zIndex : 0;\r\n        this.loadCallback = typeof options.loadCallback == 'function' ? options.loadCallback : function () {\r\n        };\r\n        this._legendContent = '';\r\n        if (this._legendCheckbox) {\r\n            this._legendContent += \"<input type=\\\"checkbox\\\" \" + (this.visible ? 'checked' : '') + \" \" +\r\n                (\"class=\\\"legend-check\\\" id=\\\"\" + this.id + \"-legend-layer-check\\\"><span></span>\");\r\n            this._legendContent += \"<label for=\\\"\" + this.id + \"-legend-layer-check\\\" class=\\\"legend-layer-name\\\">\" + this.name + \"</label>\";\r\n        }\r\n        else {\r\n            this._legendContent += \"<label class=\\\"legend-layer-name\\\">\" + this.name + \"</label>\";\r\n        }\r\n        this._$legendDiv = null;\r\n        this._applyCollapseCalled = false;\r\n        this._addLegendContent(typeof options.legendContent === 'string' ? options.legendContent : undefined);\r\n    }\r\n    /**\r\n     * base load function, sets _loaded = true if it is not already\r\n     * @protected\r\n     * @returns {boolean} if already loaded\r\n     */\r\n    LayerBase.prototype._load = function () {\r\n        if (this.loaded == true) {\r\n            return true;\r\n        }\r\n        else {\r\n            this._loaded = true;\r\n            return false;\r\n        }\r\n    };\r\n    /**\r\n     * Get the legend html, be sure to only add to the DOM once\r\n     * @returns {string} html for layer wrapped in a div\r\n     */\r\n    LayerBase.prototype.getLegendDiv = function () {\r\n        return \"<div class=\\\"legend-layer-div\\\" id=\\\"\" + this.id + \"-legend-layer-div\\\">\" + this._legendContent + \"</div>\";\r\n    };\r\n    /**\r\n     *\r\n     * @param additionalContent - additional content to add to legend\r\n     * @private\r\n     */\r\n    LayerBase.prototype._addLegendContent = function (additionalContent) {\r\n        if (additionalContent === void 0) { additionalContent = ''; }\r\n        var addCollapse = additionalContent.indexOf('<ul>') > -1;\r\n        if (addCollapse) {\r\n            additionalContent = '<span class=\"legend-items-expander\" title=\"Expand/Collapse\">&#9660;</span>' + additionalContent;\r\n        }\r\n        this._legendContent += additionalContent;\r\n        this._$legendDiv = $(\"#\" + this.id + \"-legend-layer-div\");\r\n        if (this._$legendDiv.length > 0) {\r\n            this._$legendDiv.append(additionalContent);\r\n            this.applyCollapse();\r\n        }\r\n    };\r\n    /**\r\n     * add additional content to the legend\r\n     * @param {string} [additionalContent=] - additonal content to add\r\n     */\r\n    LayerBase.prototype.addLegendContent = function (additionalContent) {\r\n        this._addLegendContent(additionalContent);\r\n    };\r\n    LayerBase.prototype.applyCollapse = function () {\r\n        if (this._applyCollapseCalled) {\r\n            console.log('collapse already applied');\r\n            return undefined;\r\n        }\r\n        this._$legendDiv = $(\"#\" + this.id + \"-legend-layer-div\");\r\n        if (this._$legendDiv.length > 0) {\r\n            var $expander = this._$legendDiv.find('.legend-items-expander');\r\n            if ($expander.length > 0) {\r\n                this._applyCollapseCalled = true;\r\n                $expander.click(function () {\r\n                    var $this = $(this);\r\n                    $this.siblings('ul').slideToggle();\r\n                    if ($this.hasClass('legend-layer-group-collapsed')) {\r\n                        $this.removeClass('legend-layer-group-collapsed');\r\n                        $this.html('&#9660;');\r\n                    }\r\n                    else {\r\n                        $this.addClass('legend-layer-group-collapsed');\r\n                        $this.html('&#9654;');\r\n                    }\r\n                });\r\n                if (this._legendCollapse) {\r\n                    $expander.trigger('click');\r\n                }\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * trick to refresh the layer\r\n     */\r\n    LayerBase.prototype.refresh = function () {\r\n        if (this.source) {\r\n            this.source.refresh();\r\n        }\r\n    };\r\n    Object.defineProperty(LayerBase.prototype, \"id\", {\r\n        get: function () {\r\n            return this._id;\r\n        },\r\n        set: function (newId) {\r\n            this._id = newId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"animate\", {\r\n        get: function () {\r\n            return this._animate;\r\n        },\r\n        set: function (animate) {\r\n            this._animate = animate;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"legendContent\", {\r\n        /**\r\n         * get the legend content\r\n         * @type {string}\r\n         */\r\n        get: function () {\r\n            return this._legendContent;\r\n        },\r\n        /**\r\n         * set the legend content directly\r\n         * @param {string} newVal - new content\r\n         * @protected\r\n         */\r\n        set: function (newVal) {\r\n            this._legendContent = newVal;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"params\", {\r\n        /**\r\n         * get the map get params\r\n         * @type {object}\r\n         */\r\n        get: function () {\r\n            return this._params;\r\n        },\r\n        /**\r\n         * set the map get params\r\n         * @param {object} newParams - new get params\r\n         * @protected\r\n         */\r\n        set: function (newParams) {\r\n            this._params = newParams;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"minResolution\", {\r\n        /**\r\n         * get the minimum resolution\r\n         * @type {number|*}\r\n         */\r\n        get: function () {\r\n            return this._minResolution;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"maxResolution\", {\r\n        /**\r\n         * get the maximum resolution\r\n         * @type {number|*}\r\n         */\r\n        get: function () {\r\n            return this._maxResolution;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"minZoom\", {\r\n        /**\r\n         * get min zoom\r\n         * @type {number|*}\r\n         */\r\n        get: function () {\r\n            return this._minZoom;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"maxZoom\", {\r\n        /**\r\n         * get max zoom\r\n         * @type {number|*}\r\n         */\r\n        get: function () {\r\n            return this._maxZoom;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"url\", {\r\n        /**\r\n         * get the url\r\n         * @type {string}\r\n         */\r\n        get: function () {\r\n            return this._url;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"visible\", {\r\n        /**\r\n         * Get the layer visibility\r\n         * @type {boolean}\r\n         */\r\n        get: function () {\r\n            return this._visible;\r\n        },\r\n        /**\r\n         * set the visibility\r\n         * @param visibility\r\n         */\r\n        set: function (visibility) {\r\n            this.setVisible(visibility);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LayerBase.prototype.setVisible = function (visibility) {\r\n        this._visible = visibility;\r\n        if (this.olLayer) {\r\n            this.olLayer.setVisible(this._visible);\r\n            if (visibility && !this._loaded) {\r\n                this._load();\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(LayerBase.prototype, \"opacity\", {\r\n        /**\r\n         * Get the layer opacity\r\n         * @type {number}\r\n         */\r\n        get: function () {\r\n            return this._opacity;\r\n        },\r\n        /**\r\n         * Set the layer opacity\r\n         * @param {number} opacity - layer opacity\r\n         */\r\n        set: function (opacity) {\r\n            this._opacity = opacity;\r\n            if (this.olLayer) {\r\n                this.olLayer.setOpacity(this._opacity);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"name\", {\r\n        /**\r\n         * Get the layer name\r\n         * @type {string}\r\n         */\r\n        get: function () {\r\n            return this._name;\r\n        },\r\n        /**\r\n         * set the layer name\r\n         * @param {string} newName - the new name\r\n         */\r\n        set: function (newName) {\r\n            this._name = newName;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"loaded\", {\r\n        /**\r\n         * Check if the layer is loaded\r\n         * @type {boolean}\r\n         */\r\n        get: function () {\r\n            return this._loaded;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"source\", {\r\n        /**\r\n         * get the layer source\r\n         * @type {*}\r\n         */\r\n        get: function () {\r\n            return this.getSource();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LayerBase.prototype.getSource = function () {\r\n        return this._source;\r\n    };\r\n    Object.defineProperty(LayerBase.prototype, \"zIndex\", {\r\n        /**\r\n         * get the z index\r\n         */\r\n        get: function () {\r\n            return this._zIndex;\r\n        },\r\n        /**\r\n         * set the z index\r\n         */\r\n        set: function (newZ) {\r\n            this._zIndex = newZ;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LayerBase.prototype.setZIndex = function (newZ) {\r\n    };\r\n    Object.defineProperty(LayerBase.prototype, \"olLayer\", {\r\n        /**\r\n         * the the ol layer\r\n         */\r\n        get: function () {\r\n            return this.getOlLayer();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LayerBase.prototype.getOlLayer = function () {\r\n        return this._olLayer;\r\n    };\r\n    return LayerBase;\r\n}());\r\nexports.LayerBase = LayerBase;\r\nnm.LayerBase = LayerBase;\r\nexports.default = LayerBase;\r\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar $ = __webpack_require__(1);\r\nvar makeGuid_1 = __webpack_require__(3);\r\nvar ol = __webpack_require__(2);\r\nvar projections_1 = __webpack_require__(8);\r\nvar invalidClass = 'geocoder-invalid';\r\nvar geocoderLoadingClass = 'geocoder-loading';\r\n// let testAddress = '65 7th Street, Prairie du Sac, WI';\r\nvar Geocode = (function () {\r\n    function Geocode(mapDiv, map) {\r\n        var _this = this;\r\n        var inputGuid = makeGuid_1.makeGuid();\r\n        var buttonGuid = makeGuid_1.makeGuid();\r\n        this.map = map;\r\n        this.indicationLayer = new ol.layer.Vector({\r\n            source: new ol.source.Vector(),\r\n            style: new ol.style.Style({\r\n                image: new ol.style.Circle({\r\n                    radius: 12,\r\n                    fill: new ol.style.Fill({ color: 'rgba(255,0,0,0.5)' }),\r\n                    stroke: new ol.style.Stroke({ color: 'red', width: 1 })\r\n                })\r\n            })\r\n        });\r\n        this.map.addLayer(this.indicationLayer);\r\n        $(mapDiv).append('<div class=\"geocoder-el\">' +\r\n            (\"<input type=\\\"text\\\" id=\\\"\" + inputGuid + \"\\\">\") +\r\n            (\"<button id=\\\"\" + buttonGuid + \"\\\">Search</button>\") +\r\n            '</div>');\r\n        this.theButton = document.getElementById(buttonGuid);\r\n        this.theInput = document.getElementById(inputGuid);\r\n        this.reset();\r\n        var $theButton = $(this.theButton);\r\n        var $theInput = $(this.theInput);\r\n        $theButton.click(function (evt) {\r\n            evt.preventDefault();\r\n            $theButton.addClass(geocoderLoadingClass);\r\n            _this.theButton.disabled = true;\r\n            _this.indicationLayer.getSource().clear();\r\n            $.get(\"https://geocode.xyz/\" + _this.theInput.value + \"?geoit=json\", {}, function (d) {\r\n                var lat = parseFloat(d['latt']);\r\n                var lon = parseFloat(d['longt']);\r\n                if ((lat == 0 && lon == 0) || d['error']) {\r\n                    $theInput.addClass(invalidClass);\r\n                    _this.theInput.title = 'Specified Location Invalid';\r\n                    _this.theButton.title = 'Specified Location Invalid';\r\n                }\r\n                else {\r\n                    var v = _this.map.getView();\r\n                    var p = new ol.geom.Point([lon, lat]);\r\n                    var feat = new ol.Feature(p);\r\n                    _this.indicationLayer.getSource().addFeature(feat);\r\n                    p.transform(projections_1.proj4326, projections_1.proj3857);\r\n                    v.setCenter(p.getCoordinates());\r\n                    v.setZoom(13);\r\n                }\r\n                $theButton.removeClass(geocoderLoadingClass);\r\n                _this.theButton.disabled = false;\r\n            }, 'json');\r\n        });\r\n        $(this.theInput).keyup(function (evt) {\r\n            evt.preventDefault();\r\n            _this.theButton.disabled = _this.theInput.value.length == 0;\r\n            $theInput.removeClass(invalidClass);\r\n            _this.theInput.title = '';\r\n            _this.theButton.title = '';\r\n            if (!_this.theButton.disabled && evt.keyCode == 13) {\r\n                $theButton.click();\r\n            }\r\n        });\r\n    }\r\n    Geocode.prototype.reset = function () {\r\n        this.theButton.disabled = true;\r\n        this.theInput.value = '';\r\n    };\r\n    return Geocode;\r\n}());\r\nexports.Geocode = Geocode;\r\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar mapInteractionBase_1 = __webpack_require__(5);\r\nvar checkDefined = __webpack_require__(9);\r\nvar provide_1 = __webpack_require__(0);\r\nvar makeGuid_1 = __webpack_require__(3);\r\nvar $ = __webpack_require__(1);\r\nvar nm = provide_1.default('olHelpers');\r\n/**\r\n * assists with map move interactions, trigger callback functions\r\n * @augments MapInteractionBase\r\n */\r\nvar MapMoveCls = (function (_super) {\r\n    __extends(MapMoveCls, _super);\r\n    /**\r\n     * constructor called implicitly\r\n     */\r\n    function MapMoveCls() {\r\n        var _this = _super.call(this, 'map move') || this;\r\n        _this._arrLyrRequest = [];\r\n        _this._arrLyrTimeout = [];\r\n        _this._arrLayer = [];\r\n        _this._lookupLayer = {};\r\n        _this._mapMoveCallbacks = [];\r\n        _this._mapMoveCallbacksLookup = {};\r\n        _this._mapMoveCallbackDelays = [];\r\n        _this._mapMoveCallbackContext = [];\r\n        _this._mapMoveCallbackTimeout = [];\r\n        _this._mapExtent = undefined;\r\n        _this._zoomLevel = undefined;\r\n        return _this;\r\n    }\r\n    /**\r\n     * initialize the map move object\r\n     * @param theMap - the ol map\r\n     */\r\n    MapMoveCls.prototype.init = function (theMap) {\r\n        var _this = this;\r\n        _super.prototype.init.call(this, theMap);\r\n        this.map.getView().on(['change:center', 'change:resolution'], function (e) {\r\n            _this._updateMapExtent();\r\n            // trigger the layer updates\r\n            for (var i = 0; i < _this._arrLayer.length; i++) {\r\n                _this.triggerLyrLoad(_this._arrLayer[i], i, e.type);\r\n            }\r\n            // trigger the map callbacks\r\n            for (var i = 0; i < _this._mapMoveCallbacks.length; i++) {\r\n                _this.triggerMoveCallback(i, e.type);\r\n            }\r\n        });\r\n    };\r\n    MapMoveCls.prototype._updateMapExtent = function () {\r\n        var theView = this.map.getView();\r\n        this._zoomLevel = theView.getZoom();\r\n        var extentArray = theView.calculateExtent(this.map.getSize());\r\n        this._mapExtent = {\r\n            minX: extentArray[0],\r\n            minY: extentArray[1],\r\n            maxX: extentArray[2],\r\n            maxY: extentArray[3]\r\n        };\r\n    };\r\n    Object.defineProperty(MapMoveCls.prototype, \"mapExtent\", {\r\n        /**\r\n         * return the map extent\r\n         */\r\n        get: function () {\r\n            if (!this._mapExtent) {\r\n                this._updateMapExtent();\r\n            }\r\n            return this._mapExtent;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Trigger the layer load\r\n     * @param lyr the layer being acted on\r\n     * @param index index of the layer\r\n     * @param eventType the event triggering the load, as 'change:center' or 'change:resolution'\r\n     */\r\n    MapMoveCls.prototype.triggerLyrLoad = function (lyr, index, eventType) {\r\n        if (checkDefined.undefinedOrNull(lyr) && checkDefined.undefinedOrNull(index)) {\r\n            throw 'need to define lyr or index';\r\n        }\r\n        else if (checkDefined.definedAndNotNull(lyr) && checkDefined.undefinedOrNull(index)) {\r\n            index = this._arrLayer.indexOf(lyr);\r\n        }\r\n        else if (checkDefined.undefinedOrNull(lyr) && checkDefined.definedAndNotNull(index)) {\r\n            lyr = this._arrLayer[index];\r\n        }\r\n        // clear the timeout\r\n        if (this._arrLyrTimeout[index] != null) {\r\n            clearTimeout(this._arrLyrTimeout[index]);\r\n            this._arrLyrTimeout[index] = null;\r\n        }\r\n        // abort if necessary and clear the request\r\n        if (this._arrLyrRequest[index] != null && this._arrLyrRequest[index] != 4) {\r\n            this._arrLyrRequest[index].abort();\r\n            this._arrLyrRequest[index] = null;\r\n        }\r\n        // dummy callback used if before load returns false\r\n        var callbackFunc = function () { };\r\n        if (lyr.mapMoveBefore(this._zoomLevel, eventType)) {\r\n            lyr.mapMoveMakeGetParams(this._mapExtent, this._zoomLevel);\r\n            var __this_1 = this;\r\n            callbackFunc = function () {\r\n                function innerFunction(theLayer, theIndex) {\r\n                    var _innerThis = this;\r\n                    this._arrLyrRequest[theIndex] = $.get(theLayer.url, theLayer.mapMoveParams, function (d) {\r\n                        /**\r\n                         * @type {LayerBaseVector}\r\n                         */\r\n                        theLayer.mapMoveCallback(d);\r\n                        theLayer.loadCallback();\r\n                    }, 'json').fail(function (jqXHR) {\r\n                        if (jqXHR.statusText != 'abort') {\r\n                            console.log('failed');\r\n                            console.log(theLayer.url);\r\n                            console.log(theLayer.mapMoveParams);\r\n                        }\r\n                    }).always(function () {\r\n                        _innerThis._arrLyrTimeout[theIndex] = null;\r\n                        _innerThis._arrLyrRequest[theIndex] = null;\r\n                    });\r\n                }\r\n                innerFunction.call(__this_1, lyr, index);\r\n            };\r\n        }\r\n        else {\r\n            lyr.clear();\r\n        }\r\n        this._arrLyrTimeout[index] = setTimeout(callbackFunc, lyr.onDemandDelay);\r\n    };\r\n    /**\r\n     * trigger the map move call back at the given index\r\n     * @param ind - the index of the layer\r\n     * @param eventType=undefined the event triggering the load as 'change:center' or 'change:resolution'\r\n     * @param functionId=undefined the function id used to reference the added callback function\r\n     */\r\n    MapMoveCls.prototype.triggerMoveCallback = function (ind, eventType, functionId) {\r\n        if (typeof ind == 'undefined' && typeof functionId == 'undefined') {\r\n            throw 'either the function index or the id must be defined';\r\n        }\r\n        if (typeof ind !== 'number') {\r\n            ind = this._mapMoveCallbacks.indexOf(this._mapMoveCallbacksLookup[functionId]);\r\n        }\r\n        if (ind < 0) {\r\n            console.log('function not found');\r\n            return;\r\n        }\r\n        // clear the timeout\r\n        if (this._mapMoveCallbackTimeout[ind] != null) {\r\n            clearTimeout(this._mapMoveCallbackTimeout[ind]);\r\n            this._mapMoveCallbackTimeout[ind] = null;\r\n        }\r\n        var ctx = this._mapMoveCallbackContext[ind];\r\n        var theFunc = this._mapMoveCallbacks[ind];\r\n        var __this = this;\r\n        var f = function () {\r\n            if (ctx !== null) {\r\n                theFunc.call(ctx, __this._mapExtent, __this._zoomLevel, eventType);\r\n            }\r\n            else {\r\n                theFunc(__this._mapExtent, __this._zoomLevel, eventType);\r\n            }\r\n        };\r\n        this._mapMoveCallbackTimeout[ind] = setTimeout(f, this._mapMoveCallbackDelays[ind]);\r\n    };\r\n    /**\r\n     * Add a layer to the interaction\r\n     * @param  lyr - layer to add\r\n     * @param triggerOnAdd - if the layer should be loaded on add\r\n     */\r\n    MapMoveCls.prototype.addVectorLayer = function (lyr, triggerOnAdd) {\r\n        if (triggerOnAdd === void 0) { triggerOnAdd = true; }\r\n        if (this._arrLayer.indexOf(lyr) > -1) {\r\n            console.log('already added ' + lyr.name + ' to map move');\r\n            return;\r\n        }\r\n        this._checkInit();\r\n        this._arrLyrRequest.push(null);\r\n        this._arrLyrTimeout.push(null);\r\n        this._arrLayer.push(lyr);\r\n        this._lookupLayer[lyr.id] = lyr;\r\n        triggerOnAdd = typeof triggerOnAdd == 'boolean' ? triggerOnAdd : true;\r\n        if (triggerOnAdd) {\r\n            if (this._mapExtent === undefined) {\r\n                this._updateMapExtent();\r\n            }\r\n            this.triggerLyrLoad(lyr, this._arrLayer.length - 1);\r\n        }\r\n    };\r\n    /**\r\n     * add a callback to the map move event\r\n     * @param func - callback function\r\n     * @param context - the context to use for this function\r\n     * @param delay=50 the delay before call load\r\n     * @param triggerOnAdd if the layer should be loaded on add to mapMove\r\n     * @param functionId optional id to reference the function later for outside triggering\r\n     */\r\n    MapMoveCls.prototype.addCallback = function (func, context, delay, triggerOnAdd, functionId) {\r\n        if (this._mapMoveCallbacks.indexOf(func) > -1) {\r\n            console.log('this function already added to map move');\r\n            return;\r\n        }\r\n        this._checkInit();\r\n        if (!functionId) {\r\n            functionId = makeGuid_1.default();\r\n        }\r\n        this._mapMoveCallbacks.push(func);\r\n        this._mapMoveCallbacksLookup[functionId] = func;\r\n        this._mapMoveCallbackDelays.push(typeof delay == 'number' ? delay : 50);\r\n        this._mapMoveCallbackContext.push(checkDefined.definedAndNotNull(context) ? context : null);\r\n        this._mapMoveCallbackTimeout.push(null);\r\n        triggerOnAdd = typeof triggerOnAdd == 'boolean' ? triggerOnAdd : true;\r\n        if (triggerOnAdd) {\r\n            if (this._mapExtent === undefined) {\r\n                this._updateMapExtent();\r\n            }\r\n            this.triggerMoveCallback(this._mapMoveCallbacks.length - 1);\r\n        }\r\n    };\r\n    return MapMoveCls;\r\n}(mapInteractionBase_1.default));\r\nexports.MapMoveCls = MapMoveCls;\r\nnm.MapMoveCls = MapMoveCls;\r\nexports.default = MapMoveCls;\r\n\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar mapInteractionBase_1 = __webpack_require__(5);\r\nvar provide_1 = __webpack_require__(0);\r\nvar ol = __webpack_require__(2);\r\nvar $ = __webpack_require__(1);\r\nvar nm = provide_1.default('olHelpers');\r\nvar FeatureLayerProperties = (function () {\r\n    /**\r\n     *\r\n     * @param feature the feature\r\n     * @param layer - the layer in the popup\r\n     * @param layerIndex - index of the layer\r\n     * @param selectionLayer - the ol selection layer\r\n     * @param [esriLayerName=undefined] - esri layer name\r\n     */\r\n    function FeatureLayerProperties(feature, layer, layerIndex, selectionLayer, esriLayerName) {\r\n        this.feature = feature;\r\n        this.layer = layer;\r\n        this.layerIndex = layerIndex;\r\n        this.selectionLayer = selectionLayer;\r\n        this.popupContent = '';\r\n        this.esriLayerName = typeof esriLayerName == 'string' ? esriLayerName : undefined;\r\n    }\r\n    Object.defineProperty(FeatureLayerProperties.prototype, \"layerName\", {\r\n        get: function () {\r\n            if (typeof this.esriLayerName == 'string') {\r\n                return this.esriLayerName;\r\n            }\r\n            else {\r\n                return this.layer.name;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return FeatureLayerProperties;\r\n}());\r\nexports.FeatureLayerProperties = FeatureLayerProperties;\r\n/**\r\n * map popup class\r\n * @augments MapInteractionBase\r\n */\r\nvar MapPopupCls = (function (_super) {\r\n    __extends(MapPopupCls, _super);\r\n    /**\r\n     * Definition for openlayers style function\r\n     * @callback olStyleFunction\r\n     * &param feature the openlayers vector feature\r\n     * $param\r\n     */\r\n    /**\r\n     * map popup constructor\r\n     */\r\n    function MapPopupCls() {\r\n        var _this = _super.call(this, 'map popup') || this;\r\n        _this._arrPopupLayerIds = [];\r\n        _this._arrPopupLayers = [];\r\n        // this._arrPopupOlLayers = [];\r\n        _this._arrPopupContentFunction = [];\r\n        _this._$popupContainer = undefined;\r\n        _this._$popupContent = undefined;\r\n        _this._$popupCloser = undefined;\r\n        _this._popupOverlay = undefined;\r\n        _this._selectionLayers = [];\r\n        _this._selectionLayerLookup = {};\r\n        _this._mapClickFunctions = [];\r\n        //let a = function($jqueryContent){console.log($jqueryContent)};\r\n        //this._popupChangedLookup = {'a': a};\r\n        _this._popupChangedFunctions = [];\r\n        _this._esriMapServiceLayers = [];\r\n        _this._popupOpen = false;\r\n        _this._popupCoordinate = null;\r\n        _this._passThroughLayerFeatureArray = [];\r\n        _this._currentPopupIndex = -1;\r\n        _this._popupContentLength = 0;\r\n        return _this;\r\n    }\r\n    /**\r\n     * map popup initialization\r\n     * @param {ol.Map} theMap - the ol map\r\n     */\r\n    MapPopupCls.prototype.init = function (theMap) {\r\n        var _this = this;\r\n        _super.prototype.init.call(this, theMap);\r\n        var $map;\r\n        var target = this.map.getTarget();\r\n        if (typeof target == 'string') {\r\n            $map = $('#' + target);\r\n        }\r\n        else {\r\n            $map = $(target);\r\n        }\r\n        $map.append('<div class=\"ol-popup\">' +\r\n            '<span class=\"ol-popup-closer\">X</span>' +\r\n            '<div class=\"popup-content\"></div>' +\r\n            '</div>');\r\n        this._$popupContainer = $map.find('.ol-popup');\r\n        this._$popupContent = $map.find('.popup-content');\r\n        this._$popupCloser = $map.find('.ol-popup-closer');\r\n        var _ease = function (n) {\r\n            return ol.easing.inAndOut(n);\r\n        };\r\n        this._popupOverlay = new ol.Overlay({\r\n            element: this._$popupContainer[0],\r\n            autoPan: true,\r\n            autoPanAnimation: {\r\n                duration: 250,\r\n                source: theMap.getView().getCenter(),\r\n                easing: _ease\r\n            }\r\n        });\r\n        this._map.addOverlay(this._popupOverlay);\r\n        this._$popupCloser.click(function (evt) {\r\n            _this.closePopup();\r\n        });\r\n        // display popup on click\r\n        this._map.on('singleclick', function (evt) {\r\n            _this.closePopup();\r\n            _this._popupCoordinate = evt['coordinate'];\r\n            // esri map service layers\r\n            if (_this._esriMapServiceLayers.length > 0) {\r\n                var queryParams = {\r\n                    geometry: evt['coordinate'].join(','),\r\n                    geometryType: 'esriGeometryPoint',\r\n                    layers: 'all',\r\n                    sr: _this._map.getView().getProjection().getCode().split(':')[1],\r\n                    mapExtent: _this._map.getView().calculateExtent(_this._map.getSize()).join(','),\r\n                    imageDisplay: _this._map.getSize().join(',') + ',96',\r\n                    returnGeometry: true,\r\n                    tolerance: 15,\r\n                    f: 'pjson'\r\n                };\r\n                for (var _i = 0, _a = _this._esriMapServiceLayers; _i < _a.length; _i++) {\r\n                    var l = _a[_i];\r\n                    l.getPopupInfo(queryParams);\r\n                }\r\n            }\r\n            var layerFeatureObjectArray = _this._featuresAtPixel(evt['pixel']);\r\n            _this._passThroughLayerFeatureArray = [];\r\n            _this._currentPopupIndex = -1;\r\n            for (var i = 0; i < layerFeatureObjectArray.length; i++) {\r\n                var featObj = layerFeatureObjectArray[i];\r\n                var props = featObj.feature.getProperties();\r\n                var popupContentResponse = _this._arrPopupContentFunction[featObj.layerIndex](props, _this._$popupContent);\r\n                //skip if return was false\r\n                if (popupContentResponse === false) {\r\n                    //continue;\r\n                }\r\n                else if (typeof popupContentResponse == 'string') {\r\n                    featObj.popupContent = popupContentResponse;\r\n                    _this._passThroughLayerFeatureArray.push(featObj);\r\n                }\r\n                else {\r\n                    featObj.selectionLayer.getSource().addFeature(featObj.feature);\r\n                }\r\n            }\r\n            _this._popupContentLength = _this._passThroughLayerFeatureArray.length;\r\n            _this._currentPopupIndex = -1;\r\n            var popupHtml = '<div class=\"ol-popup-nav\">';\r\n            popupHtml += '<span class=\"previous-popup ol-popup-nav-arrow\">&#9664;</span>';\r\n            popupHtml += '<span class=\"next-popup ol-popup-nav-arrow\">&#9654;</span>';\r\n            popupHtml += \"<span class=\\\"current-popup-item-number\\\" style=\\\"font-weight: bold;\\\"></span>\";\r\n            popupHtml += \"<span>&nbsp;of&nbsp;</span>\";\r\n            popupHtml += \"<span class=\\\"popup-content-length\\\" style=\\\"font-weight: bold;\\\">\" + _this._popupContentLength + \"</span>\";\r\n            popupHtml += \"<span>&nbsp;&nbsp;-&nbsp;&nbsp;</span>\";\r\n            popupHtml += \"<span class=\\\"current-popup-layer-name\\\"></span>\";\r\n            popupHtml += '</div>';\r\n            popupHtml += '<div class=\"ol-popup-inner\">';\r\n            popupHtml += '</div>';\r\n            _this._$popupContent.html(popupHtml);\r\n            _this._$popupContent.find('.previous-popup').click(function () {\r\n                if (_this._popupContentLength == 1) {\r\n                    return;\r\n                }\r\n                if (_this._currentPopupIndex == 0) {\r\n                    _this._currentPopupIndex = _this._popupContentLength - 1;\r\n                }\r\n                else {\r\n                    _this._currentPopupIndex--;\r\n                }\r\n                _this._triggerFeatSelect();\r\n            });\r\n            var nextPopup = _this._$popupContent.find('.next-popup');\r\n            nextPopup.click(function () {\r\n                if (_this._popupContentLength == 1 && _this._currentPopupIndex > -1) {\r\n                    return;\r\n                }\r\n                if (_this._currentPopupIndex == _this._popupContentLength - 1) {\r\n                    _this._currentPopupIndex = 0;\r\n                }\r\n                else {\r\n                    _this._currentPopupIndex++;\r\n                }\r\n                _this._triggerFeatSelect();\r\n            });\r\n            if (_this._popupContentLength > 0) {\r\n                nextPopup.trigger('click');\r\n                _this._popupOverlay.setPosition(_this._popupCoordinate);\r\n                _this._$popupContent.scrollTop(0);\r\n                _this._popupOpen = true;\r\n            }\r\n        });\r\n        //change mouse cursor when over marker\r\n        this._map.on('pointermove', function (evt) {\r\n            if (evt['dragging']) {\r\n                return;\r\n            }\r\n            var pixel = _this.map.getEventPixel(evt['originalEvent']);\r\n            var hit = false;\r\n            _this.map.forEachFeatureAtPixel(pixel, function (f, l) {\r\n                if (hit) {\r\n                    return;\r\n                }\r\n                for (var _i = 0, _a = _this._arrPopupLayers; _i < _a.length; _i++) {\r\n                    var vLyr = _a[_i];\r\n                    if (vLyr.olLayer == l) {\r\n                        hit = true;\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n            var mapElement = _this.map.getTargetElement();\r\n            mapElement.style.cursor = hit ? 'pointer' : '';\r\n        });\r\n    };\r\n    /**\r\n     * helper to select features\r\n     * @private\r\n     */\r\n    MapPopupCls.prototype._triggerFeatSelect = function () {\r\n        var $currentPopupItemNumber = this._$popupContent.find('.current-popup-item-number');\r\n        var $innerPopup = this._$popupContent.find('.ol-popup-inner');\r\n        var $layerNameSpan = this._$popupContent.find('.current-popup-layer-name');\r\n        this.clearSelection();\r\n        var lyrFeatObj = this._passThroughLayerFeatureArray[this._currentPopupIndex];\r\n        $currentPopupItemNumber.html((this._currentPopupIndex + 1).toFixed());\r\n        $layerNameSpan.html(lyrFeatObj.layerName);\r\n        $innerPopup.html(lyrFeatObj.popupContent);\r\n        lyrFeatObj.selectionLayer.getSource().addFeature(lyrFeatObj.feature);\r\n        for (var _i = 0, _a = this._popupChangedFunctions; _i < _a.length; _i++) {\r\n            var f = _a[_i];\r\n            f(this._$popupContent);\r\n        }\r\n    };\r\n    /**\r\n     *\r\n     * @param feature - the ol feature\r\n     * @param {LayerEsriMapServer} lyr - the map server layer\r\n     * @param {string} popupContent - popup content\r\n     * @param {string} esriName - esri layer name\r\n     */\r\n    MapPopupCls.prototype.addMapServicePopupContent = function (feature, lyr, popupContent, esriName) {\r\n        var featLayerObject = new FeatureLayerProperties(feature, lyr, this._popupContentLength, this._selectionLayerLookup[lyr.id], esriName);\r\n        featLayerObject.popupContent = popupContent;\r\n        this._passThroughLayerFeatureArray.push(featLayerObject);\r\n        this._popupContentLength++;\r\n        $('.popup-content-length').html(this._popupContentLength.toFixed());\r\n        if (!this._popupOpen) {\r\n            this._$popupContent.find('.next-popup').trigger('click');\r\n            this._popupOverlay.setPosition(this._popupCoordinate);\r\n            this._$popupContent.scrollTop(0);\r\n            this._popupOpen = true;\r\n        }\r\n    };\r\n    /**\r\n     *\r\n     * @param  pixel - the ol pixel\r\n     * @returns  feature layer properties\r\n     * @private\r\n     */\r\n    MapPopupCls.prototype._featuresAtPixel = function (pixel) {\r\n        var _this = this;\r\n        var layerFeatureObjectArray = [];\r\n        this.map.forEachFeatureAtPixel(pixel, function (feature, layer) {\r\n            var hasLyr = false;\r\n            var j;\r\n            var lyr = null;\r\n            for (j = 0; j < _this._arrPopupLayers.length; j++) {\r\n                lyr = _this._arrPopupLayers[j];\r\n                if (lyr.olLayer === layer) {\r\n                    hasLyr = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (hasLyr) {\r\n                layerFeatureObjectArray.push(new FeatureLayerProperties(feature, lyr, j, _this._selectionLayers[j]));\r\n            }\r\n        });\r\n        return layerFeatureObjectArray;\r\n    };\r\n    MapPopupCls.prototype.closePopup = function () {\r\n        this._checkInit();\r\n        this._popupOpen = false;\r\n        this._popupOverlay.setPosition(undefined);\r\n        this._$popupCloser[0].blur();\r\n        this.clearSelection();\r\n        this._$popupContent.html('');\r\n        return false;\r\n    };\r\n    ;\r\n    /**\r\n     *\r\n     * @param chgFunction - popup change function\r\n     */\r\n    MapPopupCls.prototype.addPopupChangedFunction = function (chgFunction) {\r\n        this._popupChangedFunctions.push(chgFunction);\r\n    };\r\n    /**\r\n     *\r\n     * @param {LayerBase|*} lyr - the layer being acted on\r\n     * @param {object} [selectionStyle={}] the selection style configuration\r\n     * @param {string} [selectionStyle.color=rgba(255,170,0,0.5)] the selection color\r\n     * @param {number} [selectionStyle.width=10] the selection width for linear features\r\n     * @param {object|function} [selectionStyle.olStyle=undefined] an openlayers style object or function\r\n     * @returns  the new selection layer\r\n     * @private\r\n     */\r\n    MapPopupCls.prototype._addPopupLayer = function (lyr, selectionStyle) {\r\n        this._checkInit();\r\n        selectionStyle = selectionStyle || {};\r\n        selectionStyle.color = selectionStyle.color || 'rgba(255,170,0,0.5)';\r\n        selectionStyle.width = selectionStyle.width || 10;\r\n        var theStyle;\r\n        if (selectionStyle.olStyle) {\r\n            theStyle = selectionStyle.olStyle;\r\n        }\r\n        else {\r\n            theStyle = new ol.style.Style({\r\n                stroke: new ol.style.Stroke({\r\n                    color: selectionStyle.color,\r\n                    width: selectionStyle.width\r\n                }),\r\n                image: new ol.style.Circle({\r\n                    radius: 7,\r\n                    fill: new ol.style.Fill({ color: selectionStyle.color }),\r\n                    stroke: new ol.style.Stroke({ color: selectionStyle.color, width: 1 })\r\n                }),\r\n                fill: new ol.style.Fill({\r\n                    color: selectionStyle.color\r\n                })\r\n            });\r\n        }\r\n        var selectionLayer = new ol.layer.Vector({\r\n            source: new ol.source.Vector(),\r\n            style: theStyle\r\n        });\r\n        selectionLayer.setZIndex(100);\r\n        this._selectionLayers.push(selectionLayer);\r\n        this._selectionLayerLookup[lyr.id] = selectionLayer;\r\n        this.map.addLayer(selectionLayer);\r\n        return selectionLayer;\r\n    };\r\n    /**\r\n     * Add popup to the map\r\n     * @param {LayerBase|*} lyr The layer that the popup with act on\r\n     * @param {popupCallback} popupContentFunction - popup content function that makes popup info\r\n     * @param {object} [selectionStyle={}] the selection style configuration\r\n     * @param {string} [selectionStyle.color=rgba(255,170,0,0.5)] the selection color\r\n     * @param {number} [selectionStyle.width=10] the selection width for linear features\r\n     * @param {object|function} [selectionStyle.olStyle=undefined] an openlayers style object or function\r\n     * @returns {object} a reference to the ol selection layer\r\n     */\r\n    MapPopupCls.prototype.addVectorPopup = function (lyr, popupContentFunction, selectionStyle) {\r\n        var selectionLayer = this._addPopupLayer(lyr, selectionStyle);\r\n        this._arrPopupLayerIds.push(lyr.id);\r\n        this._arrPopupLayers.push(lyr);\r\n        // this._arrPopupOlLayers.push(lyr.olLayer);\r\n        this._arrPopupContentFunction.push(popupContentFunction);\r\n        return selectionLayer;\r\n    };\r\n    ;\r\n    /**\r\n     *\r\n     * @param {LayerBase} lyr - layer\r\n     */\r\n    MapPopupCls.prototype.removeVectorPopup = function (lyr) {\r\n        var idx = this._arrPopupLayerIds.indexOf(lyr.id);\r\n        if (idx > -1) {\r\n            this._arrPopupLayerIds.splice(idx, 1);\r\n            this._arrPopupLayers.splice(idx, 1);\r\n            // this._arrPopupOlLayers.splice(idx, 1);\r\n            this._arrPopupContentFunction.splice(idx, 1);\r\n            this._selectionLayers.splice(idx, 1);\r\n            delete this._selectionLayerLookup[lyr.id];\r\n        }\r\n    };\r\n    /**\r\n     *\r\n     * @param {LayerEsriMapServer} lyr - map server layer\r\n     * @param {object} [selectionStyle={}] the selection style configuration\r\n     * @param {string} [selectionStyle.color=rgba(255,170,0,0.5)] the selection color\r\n     * @param {number} [selectionStyle.width=10] the selection width for linear features\r\n     * @param {object|function} [selectionStyle.olStyle=undefined] an openlayers style object or function\r\n     * @returns {object} a reference to the ol selection layer\r\n     */\r\n    MapPopupCls.prototype.addMapServicePopup = function (lyr, selectionStyle) {\r\n        var selectionLayer = this._addPopupLayer(lyr, selectionStyle);\r\n        this._esriMapServiceLayers.push(lyr);\r\n        return selectionLayer;\r\n    };\r\n    MapPopupCls.prototype.clearSelection = function () {\r\n        this._checkInit();\r\n        for (var i = 0; i < this._selectionLayers.length; i++) {\r\n            this._selectionLayers[i].getSource().clear();\r\n        }\r\n        for (var _i = 0, _a = this._mapClickFunctions; _i < _a.length; _i++) {\r\n            var f = _a[_i];\r\n            f();\r\n        }\r\n    };\r\n    ;\r\n    /**\r\n     * Add a function to be called when the map is clicked but before any popups are implemented\r\n     * @param {function} func - the map click function\r\n     */\r\n    MapPopupCls.prototype.addMapClickFunction = function (func) {\r\n        this._mapClickFunctions.push(func);\r\n    };\r\n    return MapPopupCls;\r\n}(mapInteractionBase_1.default));\r\nexports.MapPopupCls = MapPopupCls;\r\nnm.MapPopupCls = MapPopupCls;\r\nexports.default = MapPopupCls;\r\n\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 12/15/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar provide_1 = __webpack_require__(0);\r\nvar ol = __webpack_require__(2);\r\nvar $ = __webpack_require__(1);\r\nvar geocode_1 = __webpack_require__(11);\r\nvar nm = provide_1.default('olHelpers');\r\n/**\r\n * Sets up a map with some default parameters and initializes\r\n * mapMove and mapPopup\r\n *\r\n * @param [options={}] config options\r\n * @param [options.divId=map] map div id\r\n * @param [options.center={}] center config object\r\n * @param [options.center.x=-10018378] center x, web mercator x or lon\r\n * @param [options.center.y=5574910] center y, web mercator y or lat\r\n * @param [options.zoom=7] zoom level\r\n * @param [options.minZoom=undefined] min zoom\r\n * @param [options.maxZoom=undefined] max zoom\r\n * @param [options.baseSwitcher=true] if add base map switcher\r\n * @param [options.fullScreen=false] if add base map switcher\r\n * @returns the ol map\r\n */\r\nfunction quickMapBase(options) {\r\n    if (options === void 0) { options = {}; }\r\n    options.divId = options.divId || 'map';\r\n    options.center = options.center || { x: -10018378, y: 5574910 };\r\n    options.zoom = typeof options.zoom == 'number' ? options.zoom : 7;\r\n    options.baseSwitcher = typeof options.baseSwitcher == 'boolean' ? options.baseSwitcher : true;\r\n    options.fullScreen = typeof options.fullScreen == 'boolean' ? options.fullScreen : false;\r\n    options.addGeocode = options.addGeocode || false;\r\n    var $mapDiv = $('#' + options.divId);\r\n    $mapDiv.css('position', 'relative');\r\n    var osmLayer = new ol.layer.Tile({ source: new ol.source.OSM() });\r\n    // let satLayer = new ol.layer.Tile({visible: false, source: new ol.source.MapQuest({layer: 'sat'})});\r\n    var osmCss = \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURQAAADQ1NDk5OURFREtLS1FHSFlZWGJRVGJiYWdmZWxsbHRmaXBpanN0c3V0dHp5eX5+fIVzd4F3eeV0jud5juZ8k4aHhomHhoyGh5eGj5OVlJiVlZiYl5qZmJydnKOTlaKZmqKdnaOioaqqqKuzsbOvrrSysLa3tbW4uLm6ub27ub+/vbGXwbCZwbCgxLKlxrOqyLStybO3yrSxyrWzzbW2y7a1zbK4y7W6zbW8y760yrTAzbTFzrPKzrLOzrTJzrTOzr7CwbXC0LXK0LTO0L3I0bPQz7TQz7PS0bXQ0LnR0brW1bzT0r7U077V1Lzc2dqNqteUsdyXscaquuOHneaGmueHnOeJnuiBleiKn+eNoOiOoOWUpOiRo+iSpeiUpeqYpumaqOmdrPSynemgruSqtOmisOmlsuuqtequuOW1vOuxu+uxvOq1ve+xvPK0pvW3o/W5pfO5qvS7qfCwvMOuwc2/wNenxNyyzNe/0Nq31Nq51dy72Oy3wOu4wOu+xey4wO+6xO2+xfTAr/TCsvfFtPHLvvTJuMPDwMfHxcXKyc3DxMvFyMvLyM3PzcDV08DV1MTX1cbY1s7X1sjZ1sra2Mnd3M7b2c7c2tfH1tnB1t7F2d7M29fX1tLY1tDd2tHe3NTf3NnS19rZ1tva2Nnf3t3d28rh3tXg3Nnh3tzj393k39ni4N7k4N7n5uXDyOfLz+zAxu3CyOzEyezKzeDJ3eLM3uvP0u3P0ePf2+7R0u7Q1u/U0+7U1ezc0+7a2e/d2+3f3vbFzvLOwfHN0PPQw/TUx/LWyvLYzPDQ1fPe0ubc4vve4uHh3+nh3+/h2u/h3vHj2vHl3uHm4eTn4uDp5ebo4+Xo5ODq6ebq6OTv6+nl4+/j4O7l4e7n5ujp4+np5Ozq5e7s5urt6O7t6Orw6u7x6u3x7vPj5PDl4fDo4vDq5fDt5vDu6PDv7PTv6fDx6vHx7fH17fXw6fXy7fb07/bz8fT18vn38vr39fr48/r59Pr6+P3++//+/gAAALNTSk0AAAEAdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBT9wclAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGHRFWHRTb2Z0d2FyZQBwYWludC5uZXQgNC4wLjlsM35OAAAFNElEQVRIS1VVCZxVUxi/9l0UIUT2bMnY43bVI2c0Y01kSWIaS0j2JEtkN41piomZrPPKQ2aQ7JKImOZlnm2493TJzDufuU1Zi+v/fee+mZ//793vnPOd7zvfes5zDBEZkBBjAcIjb+Iiotqgdhat8AMK0vl7/R9N7GiWtshqIr+EZ5gYKibyUsXY1l/mfFpssvUlWQ0FkU3gy4+RB/+kwYcO8pRSnldcOU/r2lAHARSwk2ORgEmOdC1EsuRiYSqMPwwroMIraZk5V2fYJQjCKfZrRmh3gSAZi2i4b7wSylWu8EqZwS59JkFUaW96JbNSc+CEUmt4rorwuZmWdDaoc+uZETuQlTCU5xYzR7muUnVUVo+BcRhre/VwUpasgJwhH7JkYIYA0sNxhmCwUK+lw6vCKBZehw01dEiyw4Q4aE0Z4ahDhKaFQsGnJ2BgqKoTBsNjFy0SlW6whRAZTdm8DBJmkBZhDi1j4xJQBk6ywrWUTymaCxac8lROcdauRGzQSNtA7EHUYhXyEwhhgjFUqRuO+rauhF1awFpzCsmwUbjIFBR0u1bKtyGpulW/H/cVVzkyGaIWTIR9pFAV6GK2gPMXMX8gPk9zzxXgI1kimcAltEYr+cjio1imlKpEa9rOipLm+p+CZ6Bw//qd1/f/O+GwMxbSLpyoZEcwkyh2jIks+3hmdd2jWUw4scxNysnHxU7nSspTRcJjCZGL3IsjsYJMMg5mwgx7gaIOLBFCogAgBBoNa9w+DE6I+Bs7FTgwwrJbHjWDgpYo2KwtBTcYEDuloC9geQw+k2RGnPGpTaOlq7AS+YICUz4DZVaX2TiNDhuYfTtY4geLi0IoCm3XccwM9hx4kU28StQEljDs3ZEpFGA+8dKzLmV9ymIwF5FOGn2GdJM8KLHDJbXyiYVMG9MRTLiXGGg2QKaxM3khPSRrwM9zEIardxU2w/EiA0gOeYKHzDR0V7/QGV3lKIA9ktrDArxO3gdA+k6SKoBiVwcm7NjZb9+Hnztg282TuHVZ9LOISFNt9MgyCetZVczSxnyDbl17Penq6mqpg1IhRaEO2aVLUO4/r17H8tTv6f13h71dduvZI3Y+uMdWksNSauLovJw5hsqiPIUvt0ku7/iBeUR3sksmomYWtRbAjbiLfv2lX9/V7LVG4uYnUZXhQ7f2OPCZEx9wrYWTcePEQqPEML8pl4mMdr/jlXlvHiRiJ2+MSTFY4TTSYStuvz2R/JXh+PPeGXm055J+3/YDWuNu3R3DArPutyg0ZgykMVDU9Ndm22+wYalr2rse48CnsTIFcMn73vfhNrktx1EUcZnPv6ah3Yy5cDTRdBEoGoBeah71dqFyjZDJLkWk3N3v4uuktssjWpzciMPxQeHj8nMKzcGuB0tAyzFhdCKOYWv4HwOQVwIxLG99a6uvH3sJCyO3h+k4EZ+G7+xj5f4XXksoaGrdMRzSc8ARA8+cdOuk2x6fffNNt5x+Ro1omPlrT/CQDlcNlpx4NBIWXhkx7Y3Zp3ofNR7Uv89Om/beW0TLIynHv3vs1VsOFpSWSXvfuPUf9BrRFyxgXdHoKJnQFegPOovvzz59ntrzye240ig8UQ3lDI2VqwagrKIQcLXNFL3wglN2OHdBQ6/vI3kENDVBwRb3k1XtczFbjWn4EzMYi7CF3129+JTYuRSdrGuS92g5dpqn6qXoJQs5xmL8p+Wt4hLbt0mx2OLNZR2bbPy8zJNQGFM/f/CfXZekRYFjGCWjIJpM+WiCzGBPWHhoyaAsjRT/B2Gy5yzYJkwUAAAAAElFTkSuQmCC')\";\r\n    var aerialCss = \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURQALBgIMDQgOBwQOEQcTBwUSCwoVDAwdBw8ZDgUREwYUGAYZFQYZGgkTFQoVGQsZFAwZHBMeDhIbFBEbHAwWIA4bIREcIQ4hCQwjFw4lHBgkDB8sDxUiExIiGhAoGxohFRshGRorHQcrKQsiIQwmKgooJA0pKQ81Jw8yLRMiIxImKxUrJREuKhslJB0rIhooKRUuMBMyLhkwJhozKh48LxUzMRM9MBwzMiUvFCMtGiMwEiwzFCgzHDI+GSIsISkvJSQxIiM2LiY5Jic+Lyk0JSo0Ky49JSs9KSU1NSM7NCs2NS8+NDM1JzU9Ljg7IDJCHS1DLSNAMitCMSxIOjREITZLIDZJKDlFIjpFKztKJT1LKzJBMzpHMD1JMjpKPD1RKjlQNC1DQj5QQEA8MEJGJkBKJUJNK0lLLEJMMkVMPEpONENSLUdZL0pTLkpaLkRUMkRSPEVZMktUM0pVOklZMklZNEpcNU1ZMk1ZNUxfMk5dNkxcOVFUM1RUOFJbNVFZOVNYPVFdOVJdPFVaOVVaPVVdOlVdPVpaNlpdO0phN01hOlBiN1NhPFNoP1piPWFbPmRjPENOQEtPSURTQkJVS0xVQk1VSkxbQkxcS0heUVFXRFRcQlJfTFxeQlpeS05lQk1kSFRjQVRjSlZpQ1tkQlxlSlxpRF1rSVVnUVtlU1llXF9tU1xoXlxwSl9ramRfQmJlQ2FhSWFlSWFlTmVlSWRmTGFoQWFpRWFsRmVpRWVtRmNsSmtlRGpqRmpsS2BmWGRsUmFrW2ptUmZyR2RxTGpxTWVyU2RyW2d5V2tzUmt0WW15VG15WXFuTHNtVnFxTXF4T3h0TnJzUnJ1XHJ4VXN6Wnp0VHx1W315VXp8XGR0YGx0YHVzZXJ0aHR9ZXV+aHl9YHOCXXqBXXeCYHyCY3iEaHyIYn+JaXqKcYB5WIN6Y4SCXoCDZIGEaYCIZoOLa4iCaImJbIOOdYuMco6OeIuVcpOKbZKPc5aQb5eXe5ufg6KjhAAAAAAAAAAAAAAAAOGCeQgAAAEAdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBT9wclAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGHRFWHRTb2Z0d2FyZQBwYWludC5uZXQgNC4wLjlsM35OAAAH80lEQVRISy1WbXQUVxm+6wqnk3Zmpxl2FG2EGg92C8GDlWptVTwa+uF3xcKmDfFzCUzDsJNsunXipglJXJbrtJWmwZNSnHD3jojRgUIm2UumIZ0JZ7JByrALbMWW0IBW8aRa4+cf76TeX3Nm3uc+z/s+7/vugl4r/aMTrT4e1pPTqnnmJNn5AyUzRnrRle/qE33dsvrBtAQVoxtpZNK3zSzYjUjviWO2Ag+R77dl7W36n/1Ep9KBPG/S+Py0PkjU/gPKQGqwTHryiWYFAXSvMairsio7SjyNsnCzh0qKImV9/7mhfHQZx2yN1O+7rXUm33MUPaboOkAJHaoIdXfJj2xWeyD8jMFEXkvIu5qzpU988gWB5zl+GS+sFe55trEVPdWZB2miq8bBVkNFO2R0qnrfkiXhcJhtDNXE6tbW97/s9O9/7ZfVhx86/CwrROpfvvxboMqeLsuqPr1j44qEwDNMOBximUiYoU8sw7BC/a7T72uEnyJDlGxZ9KcglZRyuqqrv/tSZErgOI4NgRBTIw9EmHAoFGZZnp6aGaJ2GTxfxYs8kKVUQh7WB5hQeC3LsUxoxVKW14l3BX2WcoUYPiZyLLe8teZ+iuT4GGhvV5KpKWkpyzxEr2MZgQ1xdRjfRBoH+2k6lIHjKTHPPBo8CSJISqqq4wGGOcWylIGlgvgNX1Gd8vF5f+IUIwb30ng+Gg2QfBRIMvy0jG8SVkYo4N0zvUXVRztbJ/L6xL7lUZEXBEHkuZqlS6gEAUgKJurnhFtfpACOYd8b/hVbJPqwi44a6KA0sPVjIi/SIyxb3u8KlAJ0S8jRVgrlW+nVHPdrhiXCxu42d86ByksDc80P3MkJFBFQ8Ho1lQegpWJRWFGsDsRwwv7pIyvuQW0ZkrX6NDVFbqcvaQI8vbyqzt5AARrsbKx5yhQEGs+wPO56bOK+0rcwMrOKkpUbZWYxV04UeZZv/cBKFhRL6Qdv9y4LfEDA7/thg7tTmv1a5/GnO0wl0dQg80wglZaHUmxRvjwAHOfyN0mxrpqLUpcjsK3NHYMo4R1o6eho2ZyIb2FoeOC3ILK8kZ2HQMOuWywGXUkJBCeTbYFS0+ym1h2/6UgmvnrvKYZZtIEXGf75C2cIAp5LHNd71x7uPoTjakrWH9e3KFpaatjUvJUysFw0KrLMYMW2lTg4PeUQx6kJEALvxXEmCdVyPLHtCSjBhc01XCjIgafxou+PE6KC1dhxSCwoBCc+N4P3btM84pmdSSjJnjO/nvY4LQfVyz5/I+v6IwjUOMjy+MVCxIbKupTJaEktp7cTKU42Pvjh2m/8cSpC6aPsaX/MHSuUQLVVsIa4RUTs/r/BVAexNdjdnsNG7j/rV93xheLMzKnFrPeTEQchCyCcKb25aAIn7lrAertrZwyNXM8N6zfWrFo3d2SmOEcF83x/r+OOFgrAHYWF7cELjhV7UQo/6WAIUVl9JFl8a//HZ66VpbY3I9QKZqPru77lA+iOWAIr0hKxHCmmr0othSyeIl5y3qt4xT8gSNrKEZozs8Els67rgsLOZ+ygzwMfbtNhobfgzpEyGnz7htPtzUi6PuOoj7K0WF/MXiUFxwGajRD1hjYXHXI9p406qOyinp5/tiWcDHY0jIu4n64Qfq7kliB2gemag9QbOia0PbbDMbd43SHuvxFxrAocxins7MX5Kqbe1QixKBxoV4//PfAgGCu+Rlm4SvZizyDH+0reDHp92iO0BuX3bCfItl0PEwvYLqpwXG2MHlGsQ4S8pMJZv1JGmHiEoHQDdOjwmVlEP/nE9ADKjI8xLI0OOGITfy0SbeG/C2jKUDGSlDhM9I3IpK9iup6XnbRNC7yqueNsJCCIiXzdQhnaGN+46umnEdy5U5UbUJ48LFM9GkJo8BdDOiAZ7ZIQbKhYLMqvhU2wmNxjEAsS2AI7y4nWF64duePbk7YV3zvAVLEMD9AxJRNa3KDUibV7DjnkuprMEYjScFNcaR2ceP2u9R/5k1052Ryme5phAFRswlHjAudiP4dOy7CaxLgdJh9vUlU1702/+LPa1U9fvPi9qlA4XEUBJc3dFlpsR457IDl1iPqLp7o81NQgyV19iYU38uTiv975Pd3SiwQcsGjx+v4/6fl5T7EOOMTCtpbKxfemsQq/3olQZcminADAAI0cuGLHaHOFxbuGvRk/Z9u7CULqoVR6NE0yx1avj30oRhc/jWUoIALGxkz0dg1Dl9iaI7LqOOXKsXJFwjiuEAi70Jra2nW1PL08zLBhZsMABpW5csI7TPfew9ipFKcn5k1i+1KyCWKjC3W/8dF1d666+RaabBVTFTHacjoojBNDh0NDxk+IPTlwfqJkWpbnpFHXIbLbmpxEQ3ff/Z0g/mauXsoln9wDRjy/NHsQFw3P6vWuTJ43/+FZrk2cvAFRipCKdfD9y2+pjRj78s0KdCUDKJvdV91ChngV38T20TM+gghjpJaPlpFr2xbEz5g4A/NGt5rNwdwmYGeeeMXBSLHHUIc+6RsojRH9VTUm3/mLf/64b470XvoxoTKhlMBQ2jMEzo2PjxdGMppmn1RM24bWFJqaQv4BcuJa2Sam7Zokq1ldCsz06NCBHrhwqVQYpfFj42NZexz1EW9SR/kT58nEeQKJb2fPXjjp0u/YUkwHEgLeOnf2nOuf1TRTM02CLKLTPy60/x1CCztqn7Ev+BdsC3m+30decQvW/wBNTwU+CfUQAQAAAABJRU5ErkJggg==')\";\r\n    if (options.baseSwitcher) {\r\n        //  let switcherContent = '<div class=\"base-map-switcher\" title=\"Toggle Base Layer\" style=\"';\r\n        //  switcherContent += 'position: absolute; top: 70px; left: 4px; border: solid black 1px; ';\r\n        //  switcherContent += `height: 50px; width: 50px; z-index: 10; border-radius: 4px; background: ${aerialCss};`;\r\n        //  switcherContent += '\"></div>';\r\n        //  $mapDiv.append(switcherContent);\r\n        //\r\n        // $mapDiv.find('.base-map-switcher').click(function() {\r\n        //      \"use strict\";\r\n        //      osmLayer.setVisible(!osmLayer.getVisible());\r\n        //      satLayer.setVisible(!satLayer.getVisible());\r\n        //\r\n        //      if (osmLayer.getVisible()){\r\n        //          $(this).css('background', aerialCss);\r\n        //      } else {\r\n        //          $(this).css('background', osmCss);\r\n        //      }\r\n        //  });\r\n    }\r\n    if (options.zoom < 0 || options.zoom > 28) {\r\n        throw 'zoom out of range';\r\n    }\r\n    if (options.center.x >= -180 && options.center.x <= 180 && options.center.y >= -90 && options.center.y <= 90) {\r\n        var p = new ol.geom.Point([options.center.x, options.center.y]);\r\n        new ol.proj.Projection({ code: \"EPSG:4326\" });\r\n        p.transform(new ol.proj.Projection({ code: \"EPSG:4326\" }), new ol.proj.Projection({ code: \"EPSG:3857\" }));\r\n        var coordinates = p.getCoordinates();\r\n        options.center.x = coordinates[0];\r\n        options.center.y = coordinates[1];\r\n    }\r\n    var controls = ol.control.defaults({\r\n        attributionOptions: { collapsible: false }\r\n    });\r\n    var view = new ol.View({\r\n        center: [options.center.x, options.center.y],\r\n        zoom: options.zoom,\r\n        minZoom: options.minZoom,\r\n        maxZoom: options.maxZoom\r\n    });\r\n    var map = new ol.Map({\r\n        layers: [osmLayer],\r\n        target: options.divId,\r\n        controls: controls,\r\n        view: view\r\n    });\r\n    if (options.fullScreen) {\r\n        map.addControl(new ol.control.FullScreen({}));\r\n    }\r\n    if (options.addGeocode) {\r\n        new geocode_1.Geocode(document.getElementById(options.divId), map);\r\n    }\r\n    return map;\r\n}\r\nexports.quickMapBase = quickMapBase;\r\nnm.quickMapBase = quickMapBase;\r\nexports.default = quickMapBase;\r\n\n\n/***/ }),\n/* 15 */,\n/* 16 */,\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 12/14/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar provide_1 = __webpack_require__(0);\r\nvar nm = provide_1.default('olHelpers.zoomResolutionConvert');\r\nvar _zoomResLookup = [\r\n    156543.03392804097,\r\n    78271.51696402048,\r\n    39135.75848201024,\r\n    19567.87924100512,\r\n    9783.93962050256,\r\n    4891.96981025128,\r\n    2445.98490512564,\r\n    1222.99245256282,\r\n    611.49622628141,\r\n    305.748113140705,\r\n    152.8740565703525,\r\n    76.43702828517625,\r\n    38.21851414258813,\r\n    19.109257071294063,\r\n    9.554628535647032,\r\n    4.777314267823516,\r\n    2.388657133911758,\r\n    1.194328566955879,\r\n    0.5971642834779395,\r\n    0.29858214173896974,\r\n    0.14929107086948487,\r\n    0.07464553543474244,\r\n    0.03732276771737122,\r\n    0.01866138385868561,\r\n    0.009330691929342804,\r\n    0.004665345964671402,\r\n    0.002332672982335701,\r\n    0.0011663364911678506,\r\n    0.0005831682455839253 //28\r\n];\r\n/**\r\n * Get the resolution given the zoom level\r\n * @param {number} zoomLevel - the zoom level\r\n * @returns {number|*} the map resolution\r\n */\r\nfunction zoomToResolution(zoomLevel) {\r\n    \"use strict\";\r\n    if (typeof zoomLevel == 'number') {\r\n        if (zoomLevel % 1 === 0 && zoomLevel >= 0 && zoomLevel <= 28) {\r\n            return _zoomResLookup[zoomLevel];\r\n        }\r\n        else {\r\n            console.log(\"invalid zoom level provided: \" + zoomLevel);\r\n            return undefined;\r\n        }\r\n    }\r\n    else {\r\n        return undefined;\r\n    }\r\n}\r\nexports.zoomToResolution = zoomToResolution;\r\nnm.zoomToResolution = zoomToResolution;\r\n/**\r\n * Get resolution from the zoom level\r\n * @param {number} resolution - the resolution\r\n * @returns {number|*} the zoom level\r\n */\r\nfunction resolutionToZoom(resolution) {\r\n    for (var i = 0; i < _zoomResLookup.length; i++) {\r\n        if (resolution >= _zoomResLookup[i]) {\r\n            return i;\r\n        }\r\n    }\r\n    return 0;\r\n}\r\nexports.resolutionToZoom = resolutionToZoom;\r\nnm.resolutionToZoom = resolutionToZoom;\r\n\n\n/***/ }),\n/* 18 */,\n/* 19 */,\n/* 20 */,\n/* 21 */,\n/* 22 */,\n/* 23 */,\n/* 24 */,\n/* 25 */,\n/* 26 */,\n/* 27 */,\n/* 28 */,\n/* 29 */,\n/* 30 */,\n/* 31 */,\n/* 32 */,\n/* 33 */,\n/* 34 */,\n/* 35 */,\n/* 36 */,\n/* 37 */,\n/* 38 */,\n/* 39 */,\n/* 40 */,\n/* 41 */,\n/* 42 */,\n/* 43 */,\n/* 44 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar LayerBase_1 = __webpack_require__(10);\r\nvar mapMove_1 = __webpack_require__(7);\r\nvar provide_1 = __webpack_require__(0);\r\nvar ol = __webpack_require__(2);\r\nvar $ = __webpack_require__(1);\r\nvar nm = provide_1.default('layers');\r\n/**\r\n * The Vector layer base\r\n * @augments LayerBase\r\n * @abstract\r\n */\r\nvar LayerBaseVector = (function (_super) {\r\n    __extends(LayerBaseVector, _super);\r\n    /**\r\n     * The base vector layer\r\n     * @param {string} url - pass an empty string to prevent default load and add from a json source\r\n     * @param {object} options - config\r\n     * @param {string} [options.id] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] the z index for the layer\r\n     * @param {function} [options.loadCallback] function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent] additional content to add to the legend\r\n     *\r\n     * @param {boolean} [options.autoLoad=false] if the layer should auto load if not visible\r\n     * @param {object} [options.style=undefined] the layer style, use openlayers default style if not defined\r\n     * @param {boolean} [options.onDemand=false] if the layer should be loaded by extent on map move\r\n     * @param {number} [options.onDemandDelay=300] delay before the map move callback should be called\r\n     * @param {mapMoveMakeGetParams} [options.mapMoveMakeGetParams=function(lyr, extent, zoomLevel){}] function to create additional map move params\r\n     * @param {MapMoveCls} [options.mapMoveObj=mapMove] alternate map move object for use with multi map pages\r\n     *\r\n     */\r\n    function LayerBaseVector(url, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _this = _super.call(this, url, options) || this;\r\n        options = options;\r\n        //prevent regular load if no url has been provided\r\n        if (_this.url.trim() == '') {\r\n            _this._loaded = true;\r\n        }\r\n        _this._style = typeof options.style == 'undefined' ? undefined : options.style;\r\n        if (_this.visible) {\r\n            _this._autoLoad = true;\r\n        }\r\n        else {\r\n            _this._autoLoad = (typeof options['autoLoad'] == 'boolean' ? options['autoLoad'] : false);\r\n        }\r\n        _this._onDemand = typeof options.onDemand == 'boolean' ? options.onDemand : false;\r\n        _this._onDemandDelay = typeof options.onDemandDelay == 'number' ? options.onDemandDelay : 300;\r\n        if (options.mapMoveObj) {\r\n            _this._mapMove = options.mapMoveObj;\r\n        }\r\n        else {\r\n            _this._mapMove = _this._onDemand ? mapMove_1.default : undefined;\r\n        }\r\n        _this._mapMoveMakeGetParams = typeof options.mapMoveMakeGetParams == 'function' ? options.mapMoveMakeGetParams :\r\n            function () { return {}; };\r\n        if (_this._onDemand) {\r\n            _this._loaded = true;\r\n            _this._mapMoveParams = {};\r\n            _this._mapMove.checkInit();\r\n            _this._mapMove.addVectorLayer(_this);\r\n        }\r\n        _this._source = new ol.source.Vector();\r\n        _this._olLayer = new ol.layer.Vector({\r\n            source: _this._source,\r\n            visible: _this.visible,\r\n            style: _this.style,\r\n            minResolution: _this._minResolution,\r\n            maxResolution: _this._maxResolution,\r\n            renderOrder: options.renderOrder\r\n        });\r\n        _this.olLayer.setZIndex(_this._zIndex);\r\n        _this._projectionMap = null;\r\n        _this._projection4326 = new ol.proj.Projection({ code: \"EPSG:4326\" });\r\n        _this._olLayer.setOpacity(_this.opacity);\r\n        return _this;\r\n    }\r\n    /**\r\n     * dummy to be overridden\r\n     * @param {object} featureCollection - geojson or esrijson object\r\n     */\r\n    LayerBaseVector.prototype.addFeatures = function (featureCollection) {\r\n        console.log('Layer vector base addFeatures is a placeholder and does nothing');\r\n    };\r\n    /**\r\n     * Before call to map move callback, can prevent call by returning false\r\n     * @param {number} zoom - zoom level\r\n     * @param {string} [evtType=undefined] undefined for initial load, otherwise one of 'change:center', 'change:resolution'\r\n     * @returns {boolean} if the call should proceed\r\n     */\r\n    LayerBaseVector.prototype.mapMoveBefore = function (zoom, evtType) {\r\n        if (this.minZoom !== undefined) {\r\n            if (zoom < this.minZoom) {\r\n                return false;\r\n            }\r\n        }\r\n        if (this.maxZoom !== undefined) {\r\n            if (zoom > this.maxZoom) {\r\n                return false;\r\n            }\r\n        }\r\n        return this.visible;\r\n    };\r\n    /**\r\n     * callback to generate the parameters passed in the get request\r\n     * @param {object} extent - extent object\r\n     * @param {number} extent.minX - minX\r\n     * @param {number} extent.minY - minY\r\n     * @param {number} extent.maxX - maxX\r\n     * @param {number} extent.maxY - maxY\r\n     * @param {number} zoomLevel - zoom level\r\n     */\r\n    LayerBaseVector.prototype.mapMoveMakeGetParams = function (extent, zoomLevel) {\r\n        this._mapMoveParams = {};\r\n        $.extend(this._mapMoveParams, this.params);\r\n        $.extend(this._mapMoveParams, this._mapMoveMakeGetParams(this, extent, zoomLevel));\r\n    };\r\n    /**\r\n     * callback function on map move\r\n     * @param {object} d - the json response\r\n     */\r\n    LayerBaseVector.prototype.mapMoveCallback = function (d) {\r\n        if (this.source) {\r\n            this._source.clear();\r\n        }\r\n    };\r\n    /**\r\n     * clear features in the layer\r\n     */\r\n    LayerBaseVector.prototype.clear = function () {\r\n        if (this._source) {\r\n            this._source.clear();\r\n        }\r\n    };\r\n    Object.defineProperty(LayerBaseVector.prototype, \"onDemandDelay\", {\r\n        /**\r\n         * get on demand delay in miliseconds\r\n         */\r\n        get: function () {\r\n            return this._onDemandDelay;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"autoLoad\", {\r\n        /**\r\n         * get if the layer is autoloaded\r\n         */\r\n        get: function () {\r\n            return this._autoLoad;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"style\", {\r\n        /**\r\n         * get the style definition\r\n         */\r\n        get: function () {\r\n            return this._style;\r\n        },\r\n        /**\r\n         * set the style\r\n         * @param style - the style or function\r\n         */\r\n        set: function (style) {\r\n            this._style = style;\r\n            this.olLayer.setStyle(this._style);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"mapCrs\", {\r\n        /**\r\n         * get the map CRS if it is defined by the map move object\r\n         */\r\n        get: function () {\r\n            return this.mapProj == null ? null : this.mapProj.getCode();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"mapProj\", {\r\n        get: function () {\r\n            if (this._projectionMap != null) {\r\n                return this._projectionMap;\r\n            }\r\n            if (this._mapMove) {\r\n                this._projectionMap = this._mapMove.map.getView().getProjection();\r\n                return this._projectionMap;\r\n            }\r\n            else {\r\n                return null;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"mapMove\", {\r\n        /**\r\n         * get the map move object\r\n         * @type {MapMoveCls|*}\r\n         */\r\n        get: function () {\r\n            return this._mapMove;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"mapMoveParams\", {\r\n        /**\r\n         * map move params\r\n         * @type {object}\r\n         */\r\n        get: function () {\r\n            return this._mapMoveParams;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"visible\", {\r\n        get: function () {\r\n            return this._visible;\r\n        },\r\n        /**\r\n         * Set the layer visibility\r\n         * @type {boolean}\r\n         * @override\r\n         */\r\n        set: function (visibility) {\r\n            _super.prototype.setVisible.call(this, visibility);\r\n            if (this._onDemand) {\r\n                this.mapMove.triggerLyrLoad(this);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"source\", {\r\n        /**\r\n         * get the layer vector source\r\n         * @override\r\n         */\r\n        get: function () {\r\n            return this.getSource();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"features\", {\r\n        /**\r\n         * array of ol features\r\n         */\r\n        get: function () {\r\n            return this.source.getFeatures();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"olLayer\", {\r\n        /**\r\n         *\r\n         */\r\n        get: function () {\r\n            return _super.prototype.getOlLayer.call(this);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LayerBaseVector.prototype.setZIndex = function (newZ) {\r\n        this.olLayer.setZIndex(newZ);\r\n    };\r\n    return LayerBaseVector;\r\n}(LayerBase_1.LayerBase));\r\nexports.LayerBaseVector = LayerBaseVector;\r\nnm.LayerBaseVector = LayerBaseVector;\r\nexports.default = LayerBaseVector;\r\n\n\n/***/ }),\n/* 45 */,\n/* 46 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 12/16/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar provide_1 = __webpack_require__(0);\r\nvar makeGuid_1 = __webpack_require__(3);\r\nvar mapMove_1 = __webpack_require__(7);\r\nvar nm = provide_1.default('collections');\r\nvar $ = __webpack_require__(1);\r\nvar LayerGroup = (function () {\r\n    /**\r\n     *\r\n     * @param {object} [groupConfig={}] - group configuration object\r\n     * @param {string} groupConfig.groupName - the group name\r\n     * @param {boolean} [groupConfig.collapse=false] - if the group should be collapsed initially\r\n     * @param {boolean} [groupConfig.addCheck=true] - if the group should have a checkbox controlling visibility of all layers\r\n     * @param {LayerGroup} [parent=undefined] - the parent group\r\n     */\r\n    function LayerGroup(groupConfig, parent) {\r\n        this.groupLayers = [];\r\n        this.groupLayersLookup = {};\r\n        this.groupGroups = [];\r\n        this.groupGroupsLookup = {};\r\n        this.itemIdArray = [];\r\n        if (typeof groupConfig == 'undefined') {\r\n            this.parent = null;\r\n            this.groupId = 'root';\r\n            this.groupName = 'root';\r\n            this.allGroupLookup = { root: this };\r\n            this.allGroupArray = [this];\r\n            this.allLayerArray = [];\r\n            this.allLayerLookup = {};\r\n            this.layerParentLookup = {};\r\n            this.collapse = false;\r\n            this.addCheck = false;\r\n        }\r\n        else {\r\n            this.groupId = makeGuid_1.default();\r\n            this.parent = parent;\r\n            this.groupName = groupConfig.groupName;\r\n            this.collapse = typeof groupConfig.collapse == 'boolean' ? groupConfig.collapse : false;\r\n            this.addCheck = typeof groupConfig.addCheck == 'boolean' ? groupConfig.addCheck : true;\r\n        }\r\n    }\r\n    /**\r\n     *\r\n     * @param {object} groupConfig - configuration object\r\n     * @param {string} groupConfig.groupName - the group name\r\n     * @param {boolean} groupConfig.collapse if the group should be collapsed initially\r\n     * @param {boolean} groupConfig.addCheck if the group should have a checkbox controlling visibility of all layers\r\n     * @param {Array<LayerGroup>} parents parent groups\r\n     * @returns {LayerGroup} the layer group just added\r\n     */\r\n    LayerGroup.prototype.addGroup = function (groupConfig, parents) {\r\n        var parent;\r\n        if (parents.length > 0) {\r\n            parent = parents[parents.length - 1];\r\n        }\r\n        else {\r\n            parent = 'root';\r\n        }\r\n        /**\r\n         * @type {LayerGroup}\r\n         */\r\n        var parentGroup = this.allGroupLookup[parent];\r\n        var newGroup = new LayerGroup(groupConfig, parentGroup);\r\n        this.allGroupLookup[newGroup.groupId] = newGroup;\r\n        this.allGroupArray.push(newGroup);\r\n        parentGroup.groupGroups.push(newGroup);\r\n        parentGroup.groupGroupsLookup[newGroup.groupId] = newGroup;\r\n        if (parentGroup.itemIdArray.indexOf(newGroup.groupId) > 0) {\r\n            console.log(newGroup.groupId);\r\n            throw 'layer and group ids must be unique';\r\n        }\r\n        parentGroup.itemIdArray.push(newGroup.groupId);\r\n        return newGroup;\r\n    };\r\n    /**\r\n     *\r\n     * @param {LayerBase} newLayer the layer to be added\r\n     * @param {Array} parents array\r\n     */\r\n    LayerGroup.prototype.addLegendLayer = function (newLayer, parents) {\r\n        var parent;\r\n        if (parents.length > 0) {\r\n            parent = parents[parents.length - 1];\r\n        }\r\n        else {\r\n            parent = 'root';\r\n        }\r\n        this.allLayerLookup[newLayer.id] = newLayer;\r\n        this.allLayerArray.push(newLayer);\r\n        /**\r\n         * @type {LayerGroup}\r\n         */\r\n        var parentGroup = this.allGroupLookup[parent];\r\n        parentGroup.groupLayers.push(newLayer);\r\n        parentGroup.groupLayersLookup[newLayer.id] = newLayer;\r\n        if (parentGroup.itemIdArray.indexOf(newLayer.id) > 0) {\r\n            console.log(newLayer.id);\r\n            throw 'layer and group ids must be unique';\r\n        }\r\n        parentGroup.itemIdArray.push(newLayer.id);\r\n        this.layerParentLookup[newLayer.id] = parentGroup;\r\n    };\r\n    LayerGroup.prototype.getLegendHtml = function (legendId, options) {\r\n        var legendHtml = \"<ul id=\\\"\" + legendId + \"\\\" class=\\\"legend-container\\\">\";\r\n        legendHtml += \"<li>\" + options.legendTitle + \"<input type=\\\"checkbox\\\" checked id=\\\"suppress-by-extent-\" + legendId + \"\\\" class=\\\"suppress-by-extent\\\">\" +\r\n            (\"<label title=\\\"Suppress layers not visible at this zoom level\\\" for=\\\"suppress-by-extent-\" + legendId + \"\\\">\") +\r\n            \"<span></span>\" +\r\n            \"</label></li>\";\r\n        legendHtml += this._buildLegend(this.itemIdArray, this, options.layerDivClasses) + '</ul>';\r\n        return legendHtml;\r\n    };\r\n    /**\r\n     * @param {Array} itemIds the items to process\r\n     * @param {LayerGroup} theGroup new group\r\n     * @param {Array} [layerDivClasses=[]] optional classes to apply to the layer divs\r\n     * @static\r\n     * @returns {string} html string\r\n     */\r\n    LayerGroup.prototype._buildLegend = function (itemIds, theGroup, layerDivClasses) {\r\n        if (itemIds.length == 0) {\r\n            return '';\r\n        }\r\n        var theHml = '';\r\n        var itemId = itemIds[0];\r\n        if (theGroup.groupLayersLookup[itemId]) {\r\n            /**\r\n             * @type {LayerBase}\r\n             */\r\n            var lyr = theGroup.groupLayersLookup[itemId];\r\n            theHml += \"<li id=\\\"\" + lyr.id + \"-layer-li\\\" class=\\\"legend-layer-li \" + layerDivClasses.join(' ') + \"\\\">\" + lyr.getLegendDiv() + '</li>';\r\n        }\r\n        else if (theGroup.groupGroupsLookup[itemId]) {\r\n            /**\r\n             * type {LayerGroup}\r\n             */\r\n            var otherGroup = theGroup.groupGroupsLookup[itemId];\r\n            theHml += \"<li>\";\r\n            theHml += \"<div id=\\\"\" + otherGroup.groupId + \"-legend-layer-div\\\" \" +\r\n                (\"class=\\\"legend-layer-group  \" + layerDivClasses.join(' ') + \"\\\">\");\r\n            if (otherGroup.addCheck) {\r\n                theHml += \"<input type=\\\"checkbox\\\" checked id=\\\"\" + otherGroup.groupId + \"-group-chck\\\">\" +\r\n                    (\"<label for=\\\"\" + otherGroup.groupId + \"-group-chck\\\" title=\\\"Click arrow to expand or collapse\\\">\" + otherGroup.groupName + \"</label>\");\r\n            }\r\n            else {\r\n                theHml += \"<label title=\\\"Click arrow to expand or collapse\\\">\" + otherGroup.groupName + \"</label>\";\r\n            }\r\n            theHml += \"<span title=\\\"Expand/Collapse\\\" class=\\\"layer-group-expander\";\r\n            theHml += (otherGroup.collapse ? ' legend-layer-group-initial-collapse' : '') + \"\\\">\";\r\n            theHml += otherGroup.collapse ? '&#9654;' : '&#9660;';\r\n            theHml += '</span>';\r\n            //parents.push(groupId);\r\n            theHml += '<ul>' + this._buildLegend(otherGroup.itemIdArray, otherGroup, layerDivClasses) + '</ul>';\r\n            theHml += '</div>';\r\n            theHml += '</li>';\r\n        }\r\n        return theHml + this._buildLegend(itemIds.slice(1), theGroup, layerDivClasses);\r\n    };\r\n    return LayerGroup;\r\n}());\r\n/**\r\n * a wrapper to make a legend\r\n */\r\nvar LayerLegend = (function () {\r\n    /**``\r\n     *\r\n     * @param {Array} legendItems array of layers or objects with {groupName:  {string}, collapse: {boolean}, addCheck: {boolean}, items: {Array}}\r\n     * @param {string} divId the div where the legend should be added\r\n     * @param {object} options for legend\r\n     * @param {Array} [options.layerDivClasses=[]] optional array of classes to be applied to the layer legend divs for custom styling\r\n     * @param {string} [options.legendTitle=Legend] the legend title\r\n     * @param {boolean} [options.scaleDependent=true] if legend display is scale dependent\r\n     */\r\n    function LayerLegend(legendItems, divId, options) {\r\n        if (options === void 0) { options = {}; }\r\n        for (var _i = 0, legendItems_1 = legendItems; _i < legendItems_1.length; _i++) {\r\n            var i = legendItems_1[_i];\r\n            if (typeof i == 'undefined') {\r\n                throw 'undefined item passed in array to legend constructor';\r\n            }\r\n        }\r\n        options.legendTitle = typeof options.legendTitle == 'string' ? options.legendTitle : 'Legend';\r\n        options.scaleDependent = typeof options.scaleDependent == 'boolean' ? options.scaleDependent : true;\r\n        options.layerDivClasses = options.layerDivClasses || [];\r\n        // if legend display is scale dependent, make sure the mapMove object is initialized first\r\n        if (options.scaleDependent) {\r\n            mapMove_1.default.checkInit();\r\n        }\r\n        this.$divElement = $('#' + divId);\r\n        this._legendItems = legendItems;\r\n        this.layerGroup = new LayerGroup();\r\n        this._buildTree(legendItems);\r\n        this.legendId = makeGuid_1.default();\r\n        this.$divElement.append(this.layerGroup.getLegendHtml(this.legendId, options));\r\n        for (var _a = 0, _b = this.layerGroup.allLayerArray; _a < _b.length; _a++) {\r\n            var l = _b[_a];\r\n            l.applyCollapse();\r\n        }\r\n        var _this = this;\r\n        //// if legend display is scale dependent, make sure the mapMove object is initialized first\r\n        if (options.scaleDependent) {\r\n            mapMove_1.default.checkInit();\r\n            mapMove_1.default.addCallback(function (ext, zoom, evt) {\r\n                if (typeof evt == 'undefined' || evt == 'change:resolution') {\r\n                    for (var _i = 0, _a = this.layerGroup.allLayerArray; _i < _a.length; _i++) {\r\n                        var lyr = _a[_i];\r\n                        var $lyrLi = $('#' + lyr.id + '-layer-li');\r\n                        if (zoom > lyr.maxZoom || zoom < lyr.minZoom) {\r\n                            $lyrLi.addClass('layer-not-visible');\r\n                        }\r\n                        else {\r\n                            $lyrLi.removeClass('layer-not-visible');\r\n                        }\r\n                    }\r\n                }\r\n            }, this, 100, true, 'legend1');\r\n        }\r\n        // <editor-fold desc=\"add event listeners\">\r\n        this.$divElement.find(\".suppress-by-extent\").change(function () {\r\n            var legendLayerLis = $('.legend-layer-li');\r\n            if (this.checked) {\r\n                legendLayerLis.removeClass('layer-force-show');\r\n            }\r\n            else {\r\n                legendLayerLis.addClass('layer-force-show');\r\n            }\r\n        });\r\n        this.$divElement.find('.legend-check').change(function () {\r\n            var lyrId = this.id.replace('-legend-layer-check', '');\r\n            _this.layerGroup.allLayerLookup[lyrId].visible = this.checked;\r\n        });\r\n        this.$divElement.find('.legend-layer-group > input[type=checkbox]').change(function () {\r\n            $(this).siblings('ul').find('input[type=checkbox]').prop('checked', this.checked).trigger('change');\r\n        });\r\n        this.$divElement.find('.layer-group-expander').click(function () {\r\n            var $this = $(this);\r\n            $this.removeClass('legend-layer-group-initial-collapse');\r\n            $this.siblings('ul').slideToggle();\r\n            if ($this.hasClass('legend-layer-group-collapsed')) {\r\n                $this.removeClass('legend-layer-group-collapsed');\r\n                $this.html('&#9660;');\r\n            }\r\n            else {\r\n                $this.addClass('legend-layer-group-collapsed');\r\n                $this.html('&#9654;');\r\n            }\r\n        });\r\n        this.$divElement.find('.legend-layer-group-initial-collapse').trigger('click');\r\n        // </editor-fold>\r\n    }\r\n    /**\r\n     * @param {Array} [legendItems=this._layerConfig] the legend items\r\n     * @param {Array} [parents=[]] the ordered list of groups in which this item is a member\r\n     * @private\r\n     */\r\n    LayerLegend.prototype._buildTree = function (legendItems, parents) {\r\n        if (legendItems.length == 0) {\r\n            return;\r\n        }\r\n        var oneItem = legendItems[0];\r\n        //reset the parent if the item is in the base array\r\n        if (this._legendItems.indexOf(oneItem) > -1 || typeof parents == 'undefined') {\r\n            parents = [];\r\n        }\r\n        if (typeof oneItem.groupName !== 'undefined') {\r\n            var groupItem = legendItems[0];\r\n            var newGroup = this.layerGroup.addGroup(groupItem, parents);\r\n            parents.push(newGroup.groupId);\r\n            this._buildTree(oneItem.items, parents);\r\n        }\r\n        else {\r\n            /**\r\n             * @type {LayerBase}\r\n             */\r\n            var layerItem = legendItems[0];\r\n            this.layerGroup.addLegendLayer(layerItem, parents);\r\n        }\r\n        this._buildTree(legendItems.slice(1), parents);\r\n    };\r\n    return LayerLegend;\r\n}());\r\nexports.LayerLegend = LayerLegend;\r\nnm.LayerLegend = LayerLegend;\r\nexports.default = LayerLegend;\r\n\n\n/***/ }),\n/* 47 */,\n/* 48 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 11/2/2015.\r\n */\r\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar LayerBaseVector_1 = __webpack_require__(44);\r\nvar provide_1 = __webpack_require__(0);\r\nvar ol = __webpack_require__(2);\r\nvar $ = __webpack_require__(1);\r\nvar proj = __webpack_require__(8);\r\nvar projections_1 = __webpack_require__(8);\r\nvar nm = provide_1.default('layers');\r\n/**\r\n * The Vector GeoJson Layer\r\n * @augments LayerBaseVector\r\n */\r\nvar LayerBaseVectorGeoJson = (function (_super) {\r\n    __extends(LayerBaseVectorGeoJson, _super);\r\n    /**\r\n     * @param {string|null} url - resource url, set to '' to make blank layer\r\n     * @param {object} options - config\r\n     * @param {string} [options.id] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] the z index for the layer\r\n     * @param {function} [options.loadCallback] function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent] additional content to add to the legend\r\n     *\r\n     * @param {boolean} [options.autoLoad=false] if the layer should auto load if not visible\r\n     * @param {object} [options.style=undefined] the layer style, use openlayers default style if not defined\r\n     * @param {boolean} [options.onDemand=false] if the layer should be loaded by extent on map move\r\n     * @param {number} [options.onDemandDelay=300] delay before the map move callback should be called\r\n     *\r\n     * @param {object} [options.transform={}] SR transform, set as false for no transform\r\n     * @param {string} options.transform.dataProjection=EPSG:4326 the data CRS\r\n     * @param {string} options.transform.featureProjection=EPSG:3857 the feature/map CRS\r\n     * @param {mapMoveMakeGetParams} [options.mapMoveMakeGetParams=function(lyr, extent, zoomLevel){}] function to create additional map move params\r\n     * @param {MapMoveCls} [options.mapMoveObj=mapMove] alternate map move object for use with multi map pages\r\n     */\r\n    function LayerBaseVectorGeoJson(url, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _this = this;\r\n        url = typeof url == 'string' ? url : '';\r\n        _this = _super.call(this, url, options) || this;\r\n        _this._geoJsonFormat = new ol.format.GeoJSON();\r\n        _this._transform = options.transform || {};\r\n        _this._transform.dataProjection = _this._transform.dataProjection || proj.proj4326;\r\n        _this._transform.featureProjection = _this._transform.featureProjection || projections_1.proj3857;\r\n        if (_this.autoLoad || _this.visible) {\r\n            _this._load();\r\n        }\r\n        return _this;\r\n    }\r\n    /**\r\n     * add feature collection\r\n     * @param {object} featureCollection - as geojson object\r\n     */\r\n    LayerBaseVectorGeoJson.prototype.addFeatures = function (featureCollection) {\r\n        this.source.addFeatures(this._geoJsonFormat.readFeatures(featureCollection, { dataProjection: this._transform.dataProjection,\r\n            featureProjection: this._transform.featureProjection }));\r\n    };\r\n    /**\r\n     * trigger load features\r\n     * @protected\r\n     * @returns {boolean} if already loaded\r\n     */\r\n    LayerBaseVectorGeoJson.prototype._load = function () {\r\n        var _this = this;\r\n        if (_super.prototype._load.call(this)) {\r\n            return true;\r\n        }\r\n        $.get(this._url, this._params, function (d) {\r\n            _this.addFeatures(d);\r\n            _this.loadCallback(_this);\r\n        }, 'json').fail(function () {\r\n            this._loaded = false;\r\n        });\r\n        return false;\r\n    };\r\n    /**\r\n     * callback function on map move\r\n     * @param {object} d the json response\r\n     * @override\r\n     */\r\n    LayerBaseVectorGeoJson.prototype.mapMoveCallback = function (d) {\r\n        _super.prototype.mapMoveCallback.call(this, d);\r\n        this._source.addFeatures(this._geoJsonFormat.readFeatures(d, { featureProjection: this._transform.featureProjection, dataProjection: this._transform.dataProjection }));\r\n    };\r\n    return LayerBaseVectorGeoJson;\r\n}(LayerBaseVector_1.LayerBaseVector));\r\nexports.LayerBaseVectorGeoJson = LayerBaseVectorGeoJson;\r\nnm.LayerBaseVectorGeoJson = LayerBaseVectorGeoJson;\r\nexports.default = LayerBaseVectorGeoJson;\r\n\n\n/***/ }),\n/* 49 */,\n/* 50 */,\n/* 51 */,\n/* 52 */,\n/* 53 */,\n/* 54 */,\n/* 55 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 12/14/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar colors = __webpack_require__(67);\r\nvar provide_1 = __webpack_require__(0);\r\nvar LayerItsInventory_1 = __webpack_require__(63);\r\nvar nm = provide_1.default('collections');\r\nvar itsConfig = [\r\n    {\r\n        name: 'Camera',\r\n        itsType: 'cctv',\r\n        minZoom: 11,\r\n        itsIconConfig: {\r\n            prop: 'owner',\r\n            defaultName: 'WisDOT',\r\n            defaultIcon: 'cctv.png',\r\n            iconArray: [\r\n                ['City of Madison', 'Madison', 'cctv-mad.png']\r\n            ]\r\n        }\r\n    },\r\n    {\r\n        name: 'Message Signs',\r\n        itsType: 'DMS',\r\n        minZoom: 11,\r\n        itsIconConfig: {\r\n            prop: 'dmsType',\r\n            defaultName: 'DMS',\r\n            defaultIcon: 'dms.png',\r\n            iconArray: [\r\n                ['pcms', 'PCMS', 'pcms.png']\r\n            ]\r\n        }\r\n    },\r\n    { name: 'ATR', itsType: 'atr', minZoom: 8, itsIcon: 'atr.png', visible: false },\r\n    { name: 'Lighting', itsType: 'light', minZoom: 16, itsIcon: 'streetlight.png', visible: false, onDemand: true },\r\n    { name: 'Bluetooth', itsType: 'blue', minZoom: 10, itsIcon: 'bluetooth.png', visible: false },\r\n    { name: 'Cabinets', itsType: 'cabinet', minZoom: 10, itsIcon: 'cabinet.png', visible: false },\r\n    { name: 'Hut', itsType: 'hut', minZoom: 10, itsIcon: 'hut.png', visible: false },\r\n    { name: 'Vault', itsType: 'vault', minZoom: 13, itsIcon: 'vault.png', visible: false },\r\n    { name: 'Advisory Radio', itsType: 'har', minZoom: 10, itsIcon: 'har.png', visible: false },\r\n    {\r\n        name: 'Loop Detectors',\r\n        itsType: 'loop',\r\n        legendCollapse: true,\r\n        minZoom: 14,\r\n        visible: false,\r\n        itsIconConfig: {\r\n            prop: 'dtctrType',\r\n            defaultName: 'Other',\r\n            defaultIcon: 'loopdetectorother.png',\r\n            iconArray: [\r\n                ['detector', 'Detector', 'loopdetector.png'],\r\n                ['long', 'Long', 'loopdetectorlong.png'],\r\n                ['zone', 'Zone', 'loopdetectorzone.png']\r\n            ]\r\n        },\r\n        onDemand: true\r\n    },\r\n    { name: 'Microwave', itsType: 'microwave', minZoom: 14, itsIcon: 'microwave.png', visible: false },\r\n    { name: 'Pull Box', itsType: 'pull', minZoom: 14, itsIcon: 'pullbox.png', visible: false, onDemand: true },\r\n    { name: 'RWIS', itsType: 'rwis', minZoom: 7, itsIcon: 'rwis.png', visible: false },\r\n    { name: 'Ramp Gates', itsType: 'gate', minZoom: 10, itsIcon: 'rampgate.png', visible: false },\r\n    { name: 'Ramp Meter', itsType: 'meter', minZoom: 10, itsIcon: 'rampmeter.png', visible: false },\r\n    { name: 'Signal', itsType: 'signal', minZoom: 13, itsIcon: 'signal.png', visible: false, onDemand: true },\r\n    { name: 'Tower', itsType: 'tower', minZoom: 10, itsIcon: 'tower.png', visible: false },\r\n    {\r\n        name: 'Trench',\r\n        itsType: 'trench',\r\n        onDemand: true,\r\n        visible: false,\r\n        onDemandDelay: 500,\r\n        minZoom: 15,\r\n        legendCollapse: true,\r\n        itsLineConfig: {\r\n            prop: 'owner',\r\n            defaultName: 'Other',\r\n            //defaultWidth: 7,\r\n            defaultColor: colors.hexAlphaToRgbOrRgba('#747474', 0.8),\r\n            lineArray: [\r\n                ['WisDOT', 'WisDOT', colors.hexAlphaToRgbOrRgba('#FF032F', 0.7)],\r\n                ['WIN', 'WIN', colors.hexAlphaToRgbOrRgba('#FFC632', 0.7)],\r\n                ['USXchange', 'USXchange', colors.hexAlphaToRgbOrRgba('#2DFF46', 0.7)],\r\n                ['AT&T', 'AT&T', colors.hexAlphaToRgbOrRgba('#ff2be5', 0.7)],\r\n                ['Touch America', 'Touch America', colors.hexAlphaToRgbOrRgba('#52f3ff', 0.7)],\r\n                ['Qwest', 'Qwest', colors.hexAlphaToRgbOrRgba('#9278ff', 0.7)],\r\n                ['McLeodUSA', 'McLeodUSA', colors.hexAlphaToRgbOrRgba('#2926FF', 0.7)],\r\n                ['CINC', 'CINC', colors.hexAlphaToRgbOrRgba('#CB00FF', 0.7)],\r\n                ['City of Madison', 'Madison', colors.hexAlphaToRgbOrRgba('#000380', 0.7)]\r\n            ]\r\n        }\r\n    }\r\n];\r\nvar ItsLayerCollection = (function () {\r\n    /**\r\n     * Create a collection of all ITS layers\r\n     * @param {ol.Map} theMap the openlayers map\r\n     * @param {Array} [exclude=[]] array of Its layer identifiers to exclude\r\n     *\r\n     * BLUE Bluetooth Detector - Bluetooth Detector\r\n     * CABINET Cabinets - The cabinets\r\n     * CCTV Camera - Traffic Cameras\r\n     * HUT Communication Hut - Communication Hut\r\n     * VAULT Communication Vault - The communication vaults\r\n     * HAR Highway Advisory Radio - Advisory Radios\r\n     * LIGHT Lighting - Lighting\r\n     * LOOP Loop Detectors - Loop Detectors\r\n     * DMS Message Board - Message Boards and Signs\r\n     * MICROWAVE Microwave Detector - Microwave Detectors\r\n     * PULL Pull Box - A pull box\r\n     * RWIS RWIS - Road weather information system\r\n     * GATE Ramp Gate - The ramp Gates\r\n     * METER Ramp Meter - The ramp meters\r\n     * SIGNAL Signal - Traffic Signal\r\n     * TOWER Tower - The towers\r\n     * TRENCH\r\n     */\r\n    function ItsLayerCollection(theMap, exclude) {\r\n        this._map = theMap;\r\n        this._layers = [];\r\n        exclude = typeof exclude == 'object' ? exclude : [];\r\n        for (var i = 0; i < itsConfig.length; i++) {\r\n            var lyrConfig = itsConfig[i];\r\n            var addLayer = true;\r\n            for (var j = 0; j < exclude.length; j++) {\r\n                if (exclude[j] == lyrConfig.itsType) {\r\n                    addLayer = false;\r\n                    break;\r\n                }\r\n            }\r\n            if (addLayer) {\r\n                var inventLyr = new LayerItsInventory_1.default(lyrConfig);\r\n                this._map.addLayer(inventLyr.olLayer);\r\n                this._layers.push(inventLyr);\r\n            }\r\n        }\r\n    }\r\n    Object.defineProperty(ItsLayerCollection.prototype, \"layers\", {\r\n        /**\r\n         * Return the array of layers in this collection\r\n         * @returns {Array<LayerItsInventory>} an array of layers\r\n         */\r\n        get: function () {\r\n            return this._layers;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return ItsLayerCollection;\r\n}());\r\nexports.ItsLayerCollection = ItsLayerCollection;\r\nnm.ItsLayerCollection = ItsLayerCollection;\r\nexports.default = ItsLayerCollection;\r\n\n\n/***/ }),\n/* 56 */,\n/* 57 */,\n/* 58 */,\n/* 59 */,\n/* 60 */,\n/* 61 */,\n/* 62 */,\n/* 63 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 12/8/2015.\r\n */\r\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar LayerBaseVectorGeoJson_1 = __webpack_require__(48);\r\nvar mapPopup_1 = __webpack_require__(4);\r\nvar provide_1 = __webpack_require__(0);\r\nvar ol = __webpack_require__(2);\r\nvar $ = __webpack_require__(1);\r\nvar projections_1 = __webpack_require__(8);\r\nvar nm = provide_1.default('layers');\r\nfunction checkStyleNumber(itsIcon, itsLineStyle, itsIconConfig, itsLineConfig) {\r\n    \"use strict\";\r\n    //make sure one and only one configuration is defined;\r\n    var configCount = 0;\r\n    if (typeof itsIcon == 'string') {\r\n        configCount++;\r\n    }\r\n    if (typeof itsLineStyle == 'object') {\r\n        itsLineStyle.width = typeof itsLineStyle.width == 'number' ? itsLineStyle.width : 5;\r\n        itsLineStyle.color = typeof itsLineStyle.color == 'string' ? itsLineStyle.color : 'red';\r\n        configCount++;\r\n    }\r\n    if (typeof itsIconConfig == 'object') {\r\n        itsIconConfig.defaultName = itsIconConfig.defaultName || 'Other';\r\n        if (typeof itsIconConfig.iconArray == 'undefined') {\r\n            itsIconConfig.iconArray = [];\r\n        }\r\n        configCount++;\r\n    }\r\n    if (typeof itsLineConfig == 'object') {\r\n        itsLineConfig.defaultName = itsLineConfig.defaultName || 'Other';\r\n        itsLineConfig.defaultWidth = itsLineConfig.defaultWidth || 5;\r\n        itsLineConfig.defaultColor = itsLineConfig.defaultColor || 'red';\r\n        if (typeof itsLineConfig.lineArray == 'undefined') {\r\n            itsLineConfig.lineArray = [];\r\n        }\r\n        // set the width if not defined\r\n        for (var i = 0; i < itsLineConfig.lineArray.length; i++) {\r\n            if (itsLineConfig.lineArray[i].length == 3) {\r\n                itsLineConfig.lineArray[i].push(5);\r\n            }\r\n        }\r\n        configCount++;\r\n    }\r\n    if (configCount > 1) {\r\n        throw 'Only one style config can be defined';\r\n    }\r\n}\r\n/**\r\n *\r\n * @param {string} [itsIcon=undefined] the ITS device type icon image see https://transportal.cee.wisc.edu/its/inventory/icons/\r\n *\r\n * @param {object} [itsLineStyle=undefined] A single line style\r\n * @param {string} itsLineStyle.color the line color as rgb or hex\r\n * @param {number} [itsLineStyle.width=5] the line width\r\n *\r\n * @param {object} [itsIconConfig=undefined] The icon subtype configuration\r\n * @param {string} itsIconConfig.prop The property used to define icon attribute symbolization\r\n * @param {string} itsIconConfig.defaultName The default name to be used if no other match is found\r\n * @param {string} itsIconConfig.defaultIcon The default icon to be used for no other matches\r\n * @param {object} [itsIconConfig.iconArray=[]] an array, items with format [property, name, img]\r\n *\r\n * @param {object} [itsLineConfig=undefined] The property used to define icon attribute symbolization\r\n * @param {string} itsLineConfig.prop The property used to define icon attribute symbolization\r\n * @param {string} [itsLineConfig.defaultName=Other] The default name to be used if no other match is found\r\n * @param {string} [itsLineConfig.defaultColor=red] The default line color to be used for no other matches\r\n * @param {number} [itsLineConfig.defaultWidth=5] The default line width to be used for no other matches\r\n * @param {object} [itsLineConfig.lineArray=[]] an array, items with format [property, name, color, optional width]\r\n * @returns {*} undefined, style, or style function\r\n */\r\nfunction defineStyle(itsIcon, itsLineStyle, itsIconConfig, itsLineConfig) {\r\n    \"use strict\";\r\n    checkStyleNumber(itsIcon, itsLineStyle, itsIconConfig, itsLineConfig);\r\n    var _iconUrlRoot = 'https://transportal.cee.wisc.edu/its/inventory/icons/';\r\n    if (itsIcon) {\r\n        return new ol.style.Style({\r\n            image: new ol.style.Icon({\r\n                src: _iconUrlRoot + itsIcon,\r\n                crossOrigin: 'anonymous'\r\n            })\r\n        });\r\n    }\r\n    else if (itsLineStyle) {\r\n        return new ol.style.Style({\r\n            stroke: new ol.style.Stroke({\r\n                color: itsLineStyle.color,\r\n                width: itsLineStyle.width\r\n            })\r\n        });\r\n    }\r\n    else if (itsIconConfig) {\r\n        return function (feature) {\r\n            var symbolProp = feature.getProperties()[itsIconConfig.prop];\r\n            var iconUrl = _iconUrlRoot + itsIconConfig.defaultIcon;\r\n            for (var i = 0; i < itsIconConfig.iconArray.length; i++) {\r\n                var thisProp = itsIconConfig.iconArray[i];\r\n                if (symbolProp.trim().toLocaleLowerCase() == thisProp[0].trim().toLocaleLowerCase()) {\r\n                    iconUrl = _iconUrlRoot + thisProp[2];\r\n                    break;\r\n                }\r\n            }\r\n            return [new ol.style.Style({\r\n                    image: new ol.style.Icon({\r\n                        src: iconUrl,\r\n                        crossOrigin: 'anonymous'\r\n                    })\r\n                })];\r\n        };\r\n    }\r\n    else if (itsLineConfig) {\r\n        return function (feature) {\r\n            var symbolProp = feature.getProperties()[itsLineConfig.prop];\r\n            var colr = itsLineConfig.defaultColor || 'red';\r\n            var width = itsLineConfig.defaultWidth || 5;\r\n            for (var i = 0; i < itsLineConfig.lineArray.length; i++) {\r\n                var thisProp = itsLineConfig.lineArray[i];\r\n                if (symbolProp.trim().toLocaleLowerCase() == thisProp[0].trim().toLocaleLowerCase()) {\r\n                    colr = thisProp[2];\r\n                    width = thisProp[3];\r\n                    break;\r\n                }\r\n            }\r\n            return [new ol.style.Style({\r\n                    stroke: new ol.style.Stroke({\r\n                        color: colr,\r\n                        width: width\r\n                    })\r\n                })];\r\n        };\r\n    }\r\n    else {\r\n        return undefined;\r\n    }\r\n}\r\nfunction defineLegend(itsIcon, itsLineStyle, itsIconConfig, itsLineConfig) {\r\n    \"use strict\";\r\n    var iconHeight = 17;\r\n    checkStyleNumber(itsIcon, itsLineStyle, itsIconConfig, itsLineConfig);\r\n    var _iconUrlRoot = 'https://transportal.cee.wisc.edu/its/inventory/icons/';\r\n    if (itsIcon) {\r\n        return \"<img src=\\\"\" + (_iconUrlRoot + itsIcon) + \"\\\" class=\\\"legend-layer-icon\\\" height=\\\"\" + iconHeight + \"\\\">\";\r\n    }\r\n    else if (itsLineStyle) {\r\n        return \"<hr style=\\\"height: \" + itsLineStyle.width + \"px; background-color: \" + itsLineStyle.color + \"\\\">\";\r\n    }\r\n    else if (itsIconConfig) {\r\n        var outHtml = '';\r\n        outHtml += '<ul>';\r\n        for (var _i = 0, _a = itsIconConfig.iconArray; _i < _a.length; _i++) {\r\n            var a = _a[_i];\r\n            outHtml += \"<li><span class=\\\"legend-layer-subitem\\\">\" + a[1] + \"</span><img src=\\\"\" + (_iconUrlRoot + a[2]) + \"\\\" class=\\\"legend-layer-icon\\\" height=\\\"\" + iconHeight + \"\\\">\";\r\n        }\r\n        outHtml += \"<li><span class=\\\"legend-layer-subitem\\\">\" + itsIconConfig.defaultName + \"</span>\" +\r\n            (\"<img src=\\\"\" + (_iconUrlRoot + itsIconConfig.defaultIcon) + \"\\\" class=\\\"legend-layer-icon\\\" height=\\\"\" + iconHeight + \"\\\"></li>\");\r\n        outHtml += '</ul>';\r\n        return outHtml;\r\n    }\r\n    else if (itsLineConfig) {\r\n        var outHtml = '';\r\n        outHtml += '<ul>';\r\n        for (var _b = 0, _c = itsLineConfig.lineArray; _b < _c.length; _b++) {\r\n            var ls = _c[_b];\r\n            outHtml += \"<li><span class=\\\"legend-layer-subitem\\\">\" + ls[1] + \"</span>\" +\r\n                (\"<hr style=\\\"height: \" + ls[3] + \"px; background-color: \" + ls[2] + \"\\\">\");\r\n        }\r\n        outHtml += \"<li><span class=\\\"legend-layer-subitem\\\">\" + itsLineConfig.defaultName + \"</span>\" +\r\n            (\"<hr style=\\\"height: \" + itsLineConfig.defaultWidth + \"px; background-color: \" + itsLineConfig.defaultColor + \"\\\"></li>\");\r\n        outHtml += '</ul>';\r\n        return outHtml;\r\n    }\r\n    else {\r\n        return '';\r\n    }\r\n}\r\n/**\r\n * Its Layer class\r\n * @augments LayerBaseVectorGeoJson\r\n */\r\nvar LayerItsInventory = (function (_super) {\r\n    __extends(LayerItsInventory, _super);\r\n    /**\r\n     * ITS device layer, types available at https://transportal.cee.wisc.edu/its/inventory/\r\n     * @param {object} options - config\r\n     * @param {string} [options.id] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] the z index for the layer\r\n     * @param {function} [options.loadCallback] function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent] additional content to add to the legend\r\n     *\r\n     * @param {boolean} [options.autoLoad=false] if the layer should auto load if not visible\r\n     * @param {object|*} [options.style=undefined] the layer style, use openlayers default style if not defined\r\n     * @param {boolean} [options.onDemand=false] if the layer should be loaded by extent on map move\r\n     * @param {number} [options.onDemandDelay=300] delay before the map move callback should be called\r\n     * @param {MapMoveCls} [options.mapMoveObj=mapMove] alternate map move object for use with multi map pages\r\n     *\r\n     * @param {string} options.itsType the ITS device type, use the url flag at https://transportal.cee.wisc.edu/its/inventory/\r\n     * @param {boolean} [options.addPopup=true] if the popup should be added automatically\r\n     *\r\n     * @param {string} [options.itsIcon=undefined] the ITS device type icon image see https://transportal.cee.wisc.edu/its/inventory/icons/\r\n     *\r\n     * @param {object} [options.itsLineStyle=undefined] A single line style\r\n     * @param {string} options.itsLineStyle.color the line color as rgb or hex\r\n     * @param {number} [options.itsLineStyle.width=5] the line width\r\n     *\r\n     * @param {object} [options.itsIconConfig=undefined] The icon subtype configuration\r\n     * @param {string} options.itsIconConfig.prop The property used to define icon attribute symbolization\r\n     * @param {string} options.itsIconConfig.defaultName The default name to be used if no other match is found\r\n     * @param {string} options.itsIconConfig.defaultIcon The default icon to be used for no other matches\r\n     * @param {object} [options.itsIconConfig.iconArray=[]] an array, items with format [property, name, img]\r\n     *\r\n     * @param {object} [options.itsLineConfig=undefined] The property used to define icon attribute symbolization\r\n     * @param {string} options.itsLineConfig.prop The property used to define icon attribute symbolization\r\n     * @param {string} [options.itsLineConfig.defaultName=Other] The default name to be used if no other match is found\r\n     * @param {string} [options.itsLineConfig.defaultColor=red] The default line color to be used for no other matches\r\n     * @param {number} [options.itsLineConfig.defaultWidth] The default line width to be used for no other matches\r\n     * @param {object} [options.itsLineConfig.lineArray=[]] an array, items with format [property, name, color, optional width = 5]\r\n     */\r\n    function LayerItsInventory(options) {\r\n        var _this = this;\r\n        if (typeof options.itsType !== 'string') {\r\n            throw 'its type must be defined';\r\n        }\r\n        options.transform = { dataProjection: projections_1.proj4326, featureProjection: projections_1.proj3857 };\r\n        var addToLegend = '';\r\n        // define a style with the helper function if it is not explicitly defined\r\n        if (typeof options.style == 'undefined') {\r\n            options.style = defineStyle(options.itsIcon, options.itsLineStyle, options.itsIconConfig, options.itsLineConfig);\r\n            addToLegend = defineLegend(options.itsIcon, options.itsLineStyle, options.itsIconConfig, options.itsLineConfig);\r\n        }\r\n        options.params = typeof options.params == 'object' ? options.params : {};\r\n        $.extend(options.params, { format: 'JSON', resource: options.itsType });\r\n        _this = _super.call(this, 'https://transportal.cee.wisc.edu/its/inventory/', options) || this;\r\n        //add any additional content to the legend\r\n        _this.addLegendContent(addToLegend);\r\n        options.addPopup = typeof options.addPopup == 'boolean' ? options.addPopup : true;\r\n        if (options.addPopup) {\r\n            mapPopup_1.default.addVectorPopup(_this, function (props) {\r\n                return \"<iframe src=\\\"https://transportal.cee.wisc.edu/its/inventory/?feature=\" + props.featureGuid + \"\\\" \" +\r\n                    \"height=\\\"250\\\" width=\\\"350\\\"></iframe>\";\r\n            });\r\n        }\r\n        return _this;\r\n    }\r\n    /**\r\n     * callback to generate the parameters passed in the get request\r\n     * @callback makeGetParams\r\n     * @param {object} extent - extent object\r\n     * @param {number} extent.minX - minX\r\n     * @param {number} extent.minY - minY\r\n     * @param {number} extent.maxX - maxX\r\n     * @param {number} extent.maxY - maxY\r\n     * @param {number} zoomLevel - zoom level\r\n     */\r\n    LayerItsInventory.prototype.mapMoveMakeGetParams = function (extent, zoomLevel) {\r\n        _super.prototype.mapMoveMakeGetParams.call(this, extent, zoomLevel);\r\n        var lowerLeft = new ol.geom.Point([extent.minX, extent.minY]);\r\n        lowerLeft.transform(this.mapProj, this._projection4326);\r\n        var lowerLeftCoordinates = lowerLeft.getCoordinates();\r\n        var upperRight = new ol.geom.Point([extent.maxX, extent.maxY]);\r\n        upperRight.transform(this.mapProj, this._projection4326);\r\n        var upperRightCoordinates = upperRight.getCoordinates();\r\n        $.extend(this.mapMoveParams, {\r\n            L: lowerLeftCoordinates[0],\r\n            R: upperRightCoordinates[0],\r\n            B: lowerLeftCoordinates[1],\r\n            T: upperRightCoordinates[1]\r\n        });\r\n    };\r\n    return LayerItsInventory;\r\n}(LayerBaseVectorGeoJson_1.LayerBaseVectorGeoJson));\r\nexports.LayerItsInventory = LayerItsInventory;\r\nnm.LayerItsInventory = LayerItsInventory;\r\nexports.default = LayerItsInventory;\r\n\n\n/***/ }),\n/* 64 */,\n/* 65 */,\n/* 66 */,\n/* 67 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\nvar provide_1 = __webpack_require__(0);\r\nvar chk = __webpack_require__(9);\r\nvar nm = provide_1.default('util.colors');\r\n/**\r\n * helper function to convert to hex\r\n * @param {number|string} x - the number to convert to hex\r\n * @returns {string} number as hex\r\n * @private\r\n */\r\nfunction _hex(x) {\r\n    var hexDigits = [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f\"];\r\n    if (isNaN(x)) {\r\n        return \"00\";\r\n    }\r\n    else {\r\n        var m = x;\r\n        return hexDigits[(m - m % 16) / 16] + hexDigits[m % 16];\r\n    }\r\n    // return isNaN(x as number) ? \"00\" : hexDigits[(x - x % 16) / 16] + hexDigits[x % 16];\r\n}\r\n/**\r\n * converts an RGB string to hex\r\n * @param {string} rgb - rgb color\r\n * @returns {string} rbg as hex\r\n */\r\nfunction rgb2hex(rgb) {\r\n    var rgb1 = rgb.match(/^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)$/);\r\n    return (\"#\" + _hex(rgb1[1]) + _hex(rgb1[2]) + _hex(rgb1[3])).toUpperCase();\r\n}\r\nexports.rgb2hex = rgb2hex;\r\nnm.rgb2hex = rgb2hex;\r\n/**\r\n * Convert hex string to RGB or RGBA string\r\n * @param {string} hexString - hex color string\r\n * @param {number} [alphaVal=undefined] Alpha value\r\n * @returns {string} - rgb or rgba color\r\n */\r\nfunction hexAlphaToRgbOrRgba(hexString, alphaVal) {\r\n    hexString = ((hexString.charAt(0) == \"#\") ? hexString.substring(1, 7) : hexString);\r\n    var r = parseInt(hexString.substring(0, 2), 16).toString() || '0';\r\n    var g = parseInt(hexString.substring(2, 4), 16).toString() || '0';\r\n    var b = parseInt(hexString.substring(4, 6), 16).toString() || '0';\r\n    if (alphaVal) {\r\n        return \"rgba(\" + r + \",\" + g + \",\" + b + \",\" + alphaVal + \")\";\r\n    }\r\n    else {\r\n        return \"rgba(\" + r + \",\" + g + \",\" + b + \")\";\r\n    }\r\n}\r\nexports.hexAlphaToRgbOrRgba = hexAlphaToRgbOrRgba;\r\nnm.hexAlphaToRgbOrRgba = hexAlphaToRgbOrRgba;\r\n/**\r\n * adds alpha value to rgb string 'rgb(r, b, g)', returns 'rgba(r, g, b, a)'\r\n * @param {string} rgb - rgb color\r\n * @param {number} alpha - alpha value 0 to 1\r\n * @returns {string} rgba color\r\n */\r\nfunction rgbToRgba(rgb, alpha) {\r\n    var pieces = rgb.split(',');\r\n    pieces[0] = pieces[0].replace('rgb', 'rgba');\r\n    pieces[2] = pieces[2].replace(')', '');\r\n    pieces.push(' ' + alpha.toFixed(1) + ')');\r\n    return pieces.join(',');\r\n}\r\nexports.rgbToRgba = rgbToRgba;\r\nnm.rgbToRgba = rgbToRgba;\r\n/**\r\n * @typedef {function} colorLookupByNumber\r\n * @param {number} num - the number to use to retrieve the color\r\n * @returns {string} rgb color\r\n */\r\n/**\r\n * Make a blue green red gradient\r\n * @param {number} minVal - minimum value\r\n * @param {number} maxVal - maximum value\r\n * @param {boolean} flipColors - if the colors should be flipped\r\n * @returns {colorLookupByNumber} color lookup function\r\n */\r\nfunction makeBlueGreenRedGradient(minVal, maxVal, flipColors) {\r\n    if (flipColors === void 0) { flipColors = false; }\r\n    if (typeof flipColors != \"boolean\") {\r\n        flipColors = false;\r\n    }\r\n    return function (theVal) {\r\n        var r, g, b;\r\n        var ratio;\r\n        if (chk.undefinedOrNull(theVal)) {\r\n            return 'rgb(100,100,100)';\r\n        }\r\n        var percent = (theVal - minVal) / (maxVal - minVal);\r\n        if (flipColors == true) {\r\n            percent = 1 - percent;\r\n        }\r\n        if (percent >= 1) {\r\n            r = 255;\r\n            g = 0;\r\n            b = 0;\r\n        }\r\n        else if (percent <= 0) {\r\n            r = 0;\r\n            g = 0;\r\n            b = 255;\r\n        }\r\n        else if (percent < .25) {\r\n            // green up, blue constant\r\n            r = 0;\r\n            g = Math.floor(255 * percent / 0.25);\r\n            b = 255;\r\n        }\r\n        else if (percent < 0.50) {\r\n            //blue down, green constant\r\n            ratio = (percent - 0.25) / 0.25;\r\n            r = 0;\r\n            g = 255;\r\n            b = 255 - Math.floor(255 * ratio);\r\n        }\r\n        else if (percent < 0.75) {\r\n            // red up, green constant\r\n            ratio = (percent - 0.5) / 0.25;\r\n            r = Math.floor(255 * ratio);\r\n            g = 255;\r\n            b = 0;\r\n        }\r\n        else {\r\n            // green down, red constant\r\n            ratio = (percent - 0.75) / 0.25;\r\n            r = 255;\r\n            g = 255 - Math.floor(255 * ratio);\r\n            b = 0;\r\n        }\r\n        r = r.toFixed();\r\n        g = g.toFixed();\r\n        b = b.toFixed();\r\n        return 'rgb(' + r + ',' + g + ',' + b + ')';\r\n    };\r\n}\r\nexports.makeBlueGreenRedGradient = makeBlueGreenRedGradient;\r\nnm.makeBlueGreenRedGradient = makeBlueGreenRedGradient;\r\n/**\r\n * Create a function that will return colors based on a gradient\r\n * @param {number} median - median value\r\n * @param {number} stdDev - standard deviation\r\n * @param {boolean} flipColors - if the colors should be flipped\r\n * @returns {colorLookupByNumber} color lookup function\r\n */\r\nfunction makeBlueGreenRedGradientZScore(median, stdDev, flipColors) {\r\n    if (flipColors === void 0) { flipColors = false; }\r\n    var grd = makeBlueGreenRedGradient(-2.5, 2.5, flipColors);\r\n    return function (theVal) {\r\n        var zScore;\r\n        if (theVal == null) {\r\n            zScore = null;\r\n        }\r\n        else {\r\n            zScore = (theVal - median) / stdDev;\r\n        }\r\n        return grd(zScore);\r\n    };\r\n}\r\nexports.makeBlueGreenRedGradientZScore = makeBlueGreenRedGradientZScore;\r\nnm.makeBlueGreenRedGradientZScore = makeBlueGreenRedGradientZScore;\r\n\n\n/***/ }),\n/* 68 */,\n/* 69 */,\n/* 70 */,\n/* 71 */,\n/* 72 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 12/18/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ItsLayerCollection_1 = __webpack_require__(55);\r\nvar LayerLegend_1 = __webpack_require__(46);\r\nvar quickMap_1 = __webpack_require__(6);\r\nvar map = quickMap_1.default({ addGeocode: true });\r\nwindow['map'] = map;\r\nvar itsLayerCollection = new ItsLayerCollection_1.default(map);\r\nvar layerArray = [\r\n    {\r\n        groupName: 'ITS Inventory Layers',\r\n        collapse: false,\r\n        addCheck: true,\r\n        items: itsLayerCollection.layers\r\n    }\r\n];\r\nvar legend = new LayerLegend_1.default(layerArray, 'legend-container', {});\r\nconsole.log('it works');\r\n\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// itsMap.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 72);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 99693f14fcb3e83c98ca","/**\r\n * Created by gavorhes on 12/10/2015.\r\n */\r\n\r\ndeclare const window: Window;\r\n/**\r\n * create a namespace on the gv object\r\n * @param {string} namespace to create\r\n * @returns {object} object representing the namespace\r\n */\r\nfunction provide(namespace: string){\r\n    \"use strict\";\r\n    if (typeof (<any>window).gv == 'undefined'){\r\n        (<any>window).gv = {};\r\n    }\r\n\r\n    let parts = namespace.split('.');\r\n    let nameSpace = (<any>window).gv;\r\n\r\n    for (let i=0; i< parts.length; i++){\r\n        let newObject = nameSpace[parts[i]];\r\n\r\n        if (typeof newObject == 'undefined'){\r\n            nameSpace[parts[i]] = {};\r\n        }\r\n\r\n        nameSpace = nameSpace[parts[i]];\r\n    }\r\n\r\n    return nameSpace;\r\n}\r\n\r\nprovide('util');\r\n(<any>window).gv.util.provide = provide;\r\n\r\nexport default provide;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/provide.ts","module.exports = $;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"$\"\n// module id = 1\n// module chunks = 0 1 2 4 5 6 7 8 9 10 11","module.exports = ol;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ol\"\n// module id = 2\n// module chunks = 2 4 5 6 7 8","/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\n\r\nimport provide from './provide';\r\nlet nm = provide('util');\r\n\r\n\r\n/**\r\n * guids are used to uniquely identify groups and features\r\n * @returns {string} a new guid\r\n */\r\nexport function makeGuid() {\r\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'\r\n            .replace(/[xy]/g, function (c) {\r\n                let r = Math.random() * 16 | 0, v = c == 'x' ? r : r & 0x3 | 0x8;\r\n\r\n                return v.toString(16);\r\n            });\r\n\r\n}\r\nnm.makeGuid = makeGuid;\r\nexport default makeGuid;\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/makeGuid.ts","/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\n\r\nimport MapPopupCls from './mapPopupCls';\r\n\r\n/**\r\n * The single popup object catch is that it is common to multimap pages\r\n * @type {MapPopupCls}\r\n */\r\nexport const mapPopup = new MapPopupCls() as MapPopupCls;\r\nexport default mapPopup;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/olHelpers/mapPopup.ts","/**\r\n * Created by gavorhes on 12/8/2015.\r\n */\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nconst nm = provide('olHelpers');\r\n\r\n\r\n\r\n/**\r\n * base interaction\r\n */\r\nexport class MapInteractionBase {\r\n    _map: ol.Map;\r\n    _initialized: boolean;\r\n    _subtype: string;\r\n\r\n    /**\r\n     * map interaction base\r\n     * @param subtype - the interaction subtype\r\n     */\r\n    constructor(subtype: string) {\r\n        this._map = null;\r\n        this._initialized = false;\r\n        this._subtype = subtype;\r\n    }\r\n\r\n    /**\r\n     * base initializer, returns true for already initialized\r\n     * @param theMap - the ol Map\r\n     * @returns true for already initialized\r\n     */\r\n    init(theMap: ol.Map){\r\n        if (!this._initialized){\r\n            this._map = theMap;\r\n            this._initialized = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * get reference to the ol map object\r\n     * @returns {ol.Map} the map object\r\n     */\r\n    get map() {\r\n        return this._map;\r\n    }\r\n\r\n    /**\r\n     * get if is initialized\r\n     * @returns {boolean} is initialized\r\n     */\r\n    get initialized() {\r\n        return this._initialized;\r\n    }\r\n\r\n    /**\r\n     * Check the initialization status and throw exception if not valid yet\r\n     * @protected\r\n     */\r\n    _checkInit() {\r\n        if (!this.initialized) {\r\n            let msg = `${this._subtype} object not initialized`;\r\n            alert(msg);\r\n            console.log(msg);\r\n            throw msg;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Check the initialization status and throw exception if not valid yet\r\n     */\r\n    checkInit(){\r\n        this._checkInit();\r\n    }\r\n}\r\n\r\nnm.MapInteractionBase = MapInteractionBase;\r\nexport default MapInteractionBase;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/olHelpers/mapInteractionBase.ts","/**\r\n * Created by gavorhes on 12/15/2015.\r\n */\r\n\r\nimport {quickMapOptions, quickMapBase} from './quickMapBase';\r\nimport provide from '../util/provide';\r\nimport mapMove from './mapMove';\r\nimport mapPopup from './mapPopup';\r\nimport ol = require('custom-ol');\r\nlet nm = provide('olHelpers');\r\n\r\nexport {quickMapOptions} from './quickMapBase';\r\n\r\n/**\r\n * Sets up a map with some default parameters and initializes\r\n * mapMove and mapPopup\r\n *\r\n * @param {object} [options={}] config options\r\n * @param {string} [options.divId=map] map div id\r\n * @param {object} [options.center={}] center config object\r\n * @param {number} [options.center.x=-10018378] center x, web mercator x or lon\r\n * @param {number} [options.center.y=5574910] center y, web mercator y or lat\r\n * @param {number} [options.zoom=7] zoom level\r\n * @param {number} [options.minZoom=undefined] min zoom\r\n * @param {number} [options.maxZoom=undefined] max zoom\r\n * @param {boolean} [options.baseSwitcher=true] if add base map switcher\r\n * @param {boolean} [options.fullScreen=false] if add base map switcher\r\n * @returns {ol.Map} the ol map\r\n */\r\nexport function quickMap(options : quickMapOptions = {}): ol.Map {\r\n    let m = quickMapBase(options);\r\n    mapMove.init(m);\r\n    mapPopup.init(m);\r\n    return m;\r\n}\r\n\r\n\r\nnm.quickMap = quickMap;\r\nexport default quickMap;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/olHelpers/quickMap.ts","/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\n\r\nimport MapMoveCls from './mapMoveCls';\r\n\r\n/**\r\n * The single map move object catch is that it is common to multimap pages\r\n * @type {MapMoveCls}\r\n */\r\n\r\nexport const mapMove = new MapMoveCls();\r\nexport default mapMove;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/olHelpers/mapMove.ts","/**\r\n * Created by gavorhes on 10/3/2016.\r\n */\r\nimport ol = require('custom-ol');\r\n\r\n\r\nexport const proj4326 = new ol.proj.Projection({code: 'EPSG:4326'});\r\nexport const proj3857 = new ol.proj.Projection({code: 'EPSG:3857'});\r\nexport const proj3070 = new ol.proj.Projection({code: 'EPSG:3070'});\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/olHelpers/projections.ts","import provide from './provide';\r\nlet nm = provide('util.checkDefined');\r\n\r\n/**\r\n * check if the input is undefined or null\r\n * @param input - input pointer\r\n * @returns true undefined or null\r\n */\r\nexport function undefinedOrNull (input: any): boolean{\r\n    \"use strict\";\r\n\r\n    return (typeof input === 'undefined' || input === null);\r\n}\r\n\r\nnm.undefinedOrNull = undefinedOrNull;\r\n\r\n\r\n/**\r\n * check if the input is defined and not null\r\n * @param input - input pointer\r\n * @returns true defined and not null\r\n */\r\nexport function definedAndNotNull (input: any): boolean{\r\n    \"use strict\";\r\n\r\n    return !(undefinedOrNull(input));\r\n}\r\n\r\nnm.definedAndNotNull = definedAndNotNull;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/checkDefined.ts","import * as zoomResolutionConvert from '../olHelpers/zoomResolutionConvert';\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nimport makeGuid from '../util/makeGuid';\r\nimport $ = require('jquery');\r\n\r\nconst nm = provide('layers');\r\n\r\n\r\nexport interface LayerBaseOptions{\r\n    id?: string;\r\n    name?: string;\r\n    opacity?: number;\r\n    visible?: boolean;\r\n    minZoom?: number;\r\n    maxZoom?: number;\r\n    params?: any;\r\n    zIndex?: number;\r\n    loadCallback?: Function;\r\n    legendCollapse?: boolean;\r\n    legendCheckbox?: boolean;\r\n    legendContent?: string;\r\n}\r\n\r\n\r\n/**\r\n * The base layer class\r\n * @abstract\r\n */\r\nexport abstract class LayerBase {\r\n\r\n    protected _legendCheckbox: boolean;\r\n    protected _url: string;\r\n    protected _opacity: number;\r\n    protected _minZoom: number;\r\n    protected _maxZoom: number;\r\n    protected _visible: boolean;\r\n    protected _loaded: boolean;\r\n    protected _zIndex: number;\r\n    protected _legendContent: string;\r\n    protected _params: any;\r\n    protected _id: string;\r\n    protected _name: string;\r\n    protected _source: ol.source.Source;\r\n    protected _animate: boolean;\r\n    protected _legendCollapse: boolean;\r\n    protected _maxResolution: number;\r\n    protected _minResolution: number;\r\n    protected  _$legendDiv: JQuery;\r\n    loadCallback: Function;\r\n    protected _olLayer: ol.layer.Layer;\r\n    protected _applyCollapseCalled: boolean;\r\n\r\n\r\n\r\n    /**\r\n     * The base layer for all others\r\n     * @param {string} url - url for source\r\n     * @param {object} options - config\r\n     * @param {string} [options.id=makeGuid()] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] - the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] - the z index for the layer\r\n     * @param {function} [options.loadCallback] - function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] - if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] - if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent=undefined] - additional content to add to the legend\r\n     */\r\n    constructor(url: string, options: LayerBaseOptions = {}) {\r\n        options = options || {} as LayerBaseOptions;\r\n\r\n        if (typeof url !== 'string') {\r\n            throw 'Invalid URL';\r\n        }\r\n        this._url = url;\r\n\r\n\r\n        this._params = typeof options.params == 'object' ? options.params : {};\r\n        this._legendCollapse = typeof options.legendCollapse == 'boolean' ? options.legendCollapse : false;\r\n        this._legendCheckbox = typeof options.legendCheckbox == 'boolean' ? options.legendCheckbox : true;\r\n\r\n        this.id = options.id || makeGuid();\r\n        this._name = options.name || 'Unnamed Layer';\r\n        this.animate = false;\r\n        this._opacity = typeof options.opacity == 'number' ? options.opacity : 1;\r\n\r\n        if (this._opacity > 1) {\r\n            this._opacity = 1;\r\n        } else if (this._opacity < 0) {\r\n            this._opacity = 0;\r\n        }\r\n\r\n        this._visible = typeof options.visible === 'boolean' ? options.visible : true;\r\n\r\n        this._source = undefined;\r\n\r\n        /**\r\n         *\r\n         * @protected\r\n         */\r\n        this._olLayer = undefined;\r\n        this._loaded = false;\r\n\r\n        this._maxResolution = zoomResolutionConvert.zoomToResolution(options.minZoom);\r\n        if (typeof this._maxResolution !== 'undefined') {\r\n            this._maxResolution += 0.00001;\r\n        }\r\n        this._minResolution = zoomResolutionConvert.zoomToResolution(options.maxZoom);\r\n\r\n        this._minZoom = typeof options.minZoom == 'number' ? options.minZoom : undefined;\r\n        this._maxZoom = typeof options.maxZoom == 'number' ? options.maxZoom : undefined;\r\n        this._zIndex = typeof options.zIndex == 'number' ? options.zIndex : 0;\r\n\r\n        this.loadCallback = typeof options.loadCallback == 'function' ? options.loadCallback : function () {\r\n        };\r\n\r\n\r\n        this._legendContent = '';\r\n\r\n        if (this._legendCheckbox) {\r\n            this._legendContent += `<input type=\"checkbox\" ${this.visible ? 'checked' : ''} ` +\r\n                `class=\"legend-check\" id=\"${this.id}-legend-layer-check\"><span></span>`;\r\n            this._legendContent += `<label for=\"${this.id}-legend-layer-check\" class=\"legend-layer-name\">${this.name}</label>`;\r\n        } else {\r\n            this._legendContent += `<label class=\"legend-layer-name\">${this.name}</label>`;\r\n        }\r\n\r\n        this._$legendDiv = null;\r\n        this._applyCollapseCalled = false;\r\n        this._addLegendContent(typeof options.legendContent === 'string' ? options.legendContent : undefined);\r\n    }\r\n\r\n    /**\r\n     * base load function, sets _loaded = true if it is not already\r\n     * @protected\r\n     * @returns {boolean} if already loaded\r\n     */\r\n    _load() {\r\n        if (this.loaded == true) {\r\n            return true;\r\n        } else {\r\n            this._loaded = true;\r\n\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the legend html, be sure to only add to the DOM once\r\n     * @returns {string} html for layer wrapped in a div\r\n     */\r\n    getLegendDiv() {\r\n        return `<div class=\"legend-layer-div\" id=\"${this.id}-legend-layer-div\">${this._legendContent}</div>`;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param additionalContent - additional content to add to legend\r\n     * @private\r\n     */\r\n    _addLegendContent(additionalContent='') {\r\n\r\n        let addCollapse = additionalContent.indexOf('<ul>') > -1;\r\n\r\n        if (addCollapse) {\r\n            additionalContent = '<span class=\"legend-items-expander\" title=\"Expand/Collapse\">&#9660;</span>' + additionalContent;\r\n        }\r\n\r\n        this._legendContent += additionalContent;\r\n\r\n        this._$legendDiv = $(`#${this.id}-legend-layer-div`);\r\n\r\n        if (this._$legendDiv.length > 0) {\r\n            this._$legendDiv.append(additionalContent);\r\n            this.applyCollapse();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * add additional content to the legend\r\n     * @param {string} [additionalContent=] - additonal content to add\r\n     */\r\n    addLegendContent(additionalContent: string) {\r\n        this._addLegendContent(additionalContent);\r\n    }\r\n\r\n    applyCollapse(): void {\r\n        if (this._applyCollapseCalled) {\r\n            console.log('collapse already applied');\r\n\r\n            return undefined;\r\n        }\r\n\r\n        this._$legendDiv = $(`#${this.id}-legend-layer-div`);\r\n\r\n        if (this._$legendDiv.length > 0) {\r\n\r\n            let $expander = this._$legendDiv.find('.legend-items-expander');\r\n\r\n            if ($expander.length > 0) {\r\n                this._applyCollapseCalled = true;\r\n\r\n                $expander.click(function () {\r\n                    let $this = $(this);\r\n\r\n                    $this.siblings('ul').slideToggle();\r\n\r\n                    if ($this.hasClass('legend-layer-group-collapsed')) {\r\n                        $this.removeClass('legend-layer-group-collapsed');\r\n                        $this.html('&#9660;');\r\n                    } else {\r\n                        $this.addClass('legend-layer-group-collapsed');\r\n                        $this.html('&#9654;');\r\n                    }\r\n                });\r\n\r\n                if (this._legendCollapse) {\r\n                    $expander.trigger('click');\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * trick to refresh the layer\r\n     */\r\n    refresh() {\r\n        if (this.source) {\r\n            this.source.refresh();\r\n        }\r\n    }\r\n\r\n    get id(): string{\r\n        return this._id;\r\n    }\r\n\r\n    set id(newId: string){\r\n        this._id = newId;\r\n    }\r\n\r\n    get animate(): boolean{\r\n        return this._animate;\r\n    }\r\n\r\n    set animate(animate: boolean){\r\n        this._animate = animate;\r\n    }\r\n\r\n    /**\r\n     * get the legend content\r\n     * @type {string}\r\n     */\r\n    get legendContent(): string {\r\n        return this._legendContent;\r\n    }\r\n\r\n    /**\r\n     * set the legend content directly\r\n     * @param {string} newVal - new content\r\n     * @protected\r\n     */\r\n    set legendContent(newVal: string) {\r\n        this._legendContent = newVal;\r\n    }\r\n\r\n    /**\r\n     * get the map get params\r\n     * @type {object}\r\n     */\r\n    get params(): {[s: string]: any} {\r\n        return this._params;\r\n    }\r\n\r\n    /**\r\n     * set the map get params\r\n     * @param {object} newParams - new get params\r\n     * @protected\r\n     */\r\n    set params(newParams: {[s: string]: any}) {\r\n        this._params = newParams;\r\n    }\r\n\r\n    /**\r\n     * get the minimum resolution\r\n     * @type {number|*}\r\n     */\r\n    get minResolution(): number {\r\n        return this._minResolution;\r\n    }\r\n\r\n    /**\r\n     * get the maximum resolution\r\n     * @type {number|*}\r\n     */\r\n    get maxResolution(): number {\r\n        return this._maxResolution;\r\n    }\r\n\r\n    /**\r\n     * get min zoom\r\n     * @type {number|*}\r\n     */\r\n    get minZoom(): number {\r\n        return this._minZoom;\r\n    }\r\n\r\n    /**\r\n     * get max zoom\r\n     * @type {number|*}\r\n     */\r\n    get maxZoom(): number {\r\n        return this._maxZoom;\r\n    }\r\n\r\n    /**\r\n     * get the url\r\n     * @type {string}\r\n     */\r\n    get url(): string {\r\n        return this._url;\r\n    }\r\n\r\n    /**\r\n     * Get the layer visibility\r\n     * @type {boolean}\r\n     */\r\n    get visible(): boolean {\r\n        return this._visible;\r\n    }\r\n\r\n    /**\r\n     * set the visibility\r\n     * @param visibility\r\n     */\r\n    set visible(visibility: boolean) {\r\n        this.setVisible(visibility);\r\n    }\r\n\r\n    protected setVisible(visibility: boolean) {\r\n        this._visible = visibility;\r\n        if (this.olLayer) {\r\n            this.olLayer.setVisible(this._visible);\r\n            if (visibility && !this._loaded) {\r\n                this._load();\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * Get the layer opacity\r\n     * @type {number}\r\n     */\r\n    get opacity(): number {\r\n        return this._opacity;\r\n    }\r\n\r\n    /**\r\n     * Set the layer opacity\r\n     * @param {number} opacity - layer opacity\r\n     */\r\n    set opacity(opacity: number) {\r\n        this._opacity = opacity;\r\n        if (this.olLayer) {\r\n            this.olLayer.setOpacity(this._opacity);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the layer name\r\n     * @type {string}\r\n     */\r\n    get name(): string {\r\n        return this._name;\r\n    }\r\n\r\n    /**\r\n     * set the layer name\r\n     * @param {string} newName - the new name\r\n     */\r\n    set name(newName: string) {\r\n        this._name = newName;\r\n    }\r\n\r\n    /**\r\n     * Check if the layer is loaded\r\n     * @type {boolean}\r\n     */\r\n    get loaded():boolean {\r\n        return this._loaded;\r\n    }\r\n\r\n    /**\r\n     * get the layer source\r\n     * @type {*}\r\n     */\r\n    get source(): ol.source.Source {\r\n        return this.getSource();\r\n    }\r\n\r\n\r\n    protected getSource(): ol.source.Source{\r\n        return this._source;\r\n    }\r\n\r\n    /**\r\n     * get the z index\r\n     */\r\n    get zIndex(): number {\r\n        return this._zIndex;\r\n    }\r\n\r\n    /**\r\n     * set the z index\r\n     */\r\n    set zIndex(newZ: number) {\r\n        this._zIndex = newZ;\r\n    }\r\n\r\n    protected setZIndex(newZ: number){\r\n\r\n    }\r\n\r\n    /**\r\n     * the the ol layer\r\n     */\r\n    get olLayer(): ol.layer.Layer {\r\n        return this.getOlLayer();\r\n    }\r\n\r\n    protected getOlLayer(): ol.layer.Layer{\r\n        return this._olLayer;\r\n    }\r\n}\r\n\r\nnm.LayerBase = LayerBase;\r\nexport default LayerBase;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/layers/LayerBase.ts","import $ = require('jquery')\r\nimport {makeGuid} from '../util/makeGuid';\r\nimport ol = require('custom-ol');\r\nimport {proj3857, proj4326} from './projections';\r\n\r\n\r\nlet invalidClass = 'geocoder-invalid';\r\nlet geocoderLoadingClass = 'geocoder-loading';\r\n\r\n// let testAddress = '65 7th Street, Prairie du Sac, WI';\r\n\r\n\r\nexport class Geocode {\r\n    private theButton: HTMLButtonElement;\r\n    private theInput: HTMLInputElement;\r\n    private map: ol.Map;\r\n    private indicationLayer;\r\n\r\n    constructor(mapDiv: HTMLDivElement, map: ol.Map) {\r\n        let inputGuid = makeGuid();\r\n        let buttonGuid = makeGuid();\r\n\r\n        this.map = map;\r\n        this.indicationLayer = new ol.layer.Vector({\r\n            source: new ol.source.Vector(),\r\n            style: new ol.style.Style({\r\n                image: new ol.style.Circle({\r\n                    radius: 12,\r\n                    fill: new ol.style.Fill({color: 'rgba(255,0,0,0.5)'}),\r\n                    stroke: new ol.style.Stroke({color: 'red', width: 1})\r\n                })\r\n            })\r\n        });\r\n        this.map.addLayer(this.indicationLayer);\r\n\r\n        $(mapDiv).append('<div class=\"geocoder-el\">' +\r\n            `<input type=\"text\" id=\"${inputGuid}\">` +\r\n            `<button id=\"${buttonGuid}\">Search</button>` +\r\n            '</div>');\r\n\r\n        this.theButton = document.getElementById(buttonGuid) as HTMLButtonElement;\r\n        this.theInput = document.getElementById(inputGuid) as HTMLInputElement;\r\n\r\n        this.reset();\r\n\r\n        let $theButton = $(this.theButton);\r\n        let $theInput = $(this.theInput);\r\n\r\n        $theButton.click((evt) => {\r\n\r\n            evt.preventDefault();\r\n\r\n            $theButton.addClass(geocoderLoadingClass);\r\n            this.theButton.disabled = true;\r\n            this.indicationLayer.getSource().clear();\r\n\r\n            $.get(\r\n                `https://geocode.xyz/${this.theInput.value}?geoit=json`,\r\n                {},\r\n                (d) => {\r\n                    let lat = parseFloat(d['latt']);\r\n                    let lon = parseFloat(d['longt']);\r\n\r\n                    if ((lat == 0 && lon == 0) || d['error']) {\r\n                        $theInput.addClass(invalidClass);\r\n                        this.theInput.title = 'Specified Location Invalid';\r\n                        this.theButton.title = 'Specified Location Invalid';\r\n\r\n                    } else {\r\n                        let v = this.map.getView();\r\n                        let p = new ol.geom.Point([lon, lat]);\r\n                        let feat = new ol.Feature(p);\r\n                        this.indicationLayer.getSource().addFeature(feat);\r\n                        p.transform(proj4326, proj3857);\r\n\r\n                        v.setCenter(p.getCoordinates());\r\n                        v.setZoom(13);\r\n                    }\r\n\r\n                    $theButton.removeClass(geocoderLoadingClass);\r\n                    this.theButton.disabled = false;\r\n                },\r\n                'json');\r\n        });\r\n\r\n        $(this.theInput).keyup((evt) => {\r\n            evt.preventDefault();\r\n            this.theButton.disabled = this.theInput.value.length == 0;\r\n            $theInput.removeClass(invalidClass);\r\n            this.theInput.title = '';\r\n            this.theButton.title = '';\r\n\r\n            if (!this.theButton.disabled && evt.keyCode == 13) {\r\n                $theButton.click();\r\n            }\r\n        })\r\n    }\r\n\r\n    private reset() {\r\n        this.theButton.disabled = true;\r\n        this.theInput.value = '';\r\n    }\r\n\r\n\r\n// https://geocode.xyz/65%2075h%20street%20prairie%20du%20sac%20wi?geoit=json\r\n\r\n// error\r\n// geocoder-invalid\r\n\r\n}\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/olHelpers/geocode.ts","import LayerBaseVector from \"../layers/LayerBaseVector\";\r\nimport MapInteractionBase from './mapInteractionBase';\r\nimport * as checkDefined from '../util/checkDefined';\r\nimport provide from '../util/provide';\r\nimport makeGuid from '../util/makeGuid';\r\nimport ol = require('custom-ol');\r\nimport $ = require('jquery');\r\nconst nm = provide('olHelpers');\r\n\r\n\r\nexport interface extentObject{\r\n    minX: number;\r\n    minY: number;\r\n    maxX: number;\r\n    maxY: number;\r\n}\r\n\r\nexport interface mapMoveCallbackFunction{\r\n    /**\r\n     *\r\n     * @param extent extent as predefined object minX, minX, maxX, maxY\r\n     * @param zoomLevel current zoom level\r\n     * @param evtType the event type 'change:center', 'change:resolution'\r\n     */\r\n    (extent: extentObject, zoomLevel: number, evtType?: string): any\r\n}\r\n\r\n\r\n/**\r\n * assists with map move interactions, trigger callback functions\r\n * @augments MapInteractionBase\r\n */\r\nexport class MapMoveCls extends MapInteractionBase {\r\n    _mapExtent: extentObject;\r\n    _zoomLevel: number;\r\n    _lookupLayer: {[s: string]: LayerBaseVector};\r\n    _arrLayer: Array<LayerBaseVector>;\r\n    _arrLyrTimeout: Array<number>;\r\n    _mapMoveCallbackTimeout: Array<number>;\r\n    _mapMoveCallbackDelays: Array<number>;\r\n    _mapMoveCallbacksLookup: {[s: string]: mapMoveCallbackFunction};\r\n    _mapMoveCallbackContext: Array<Object>;\r\n    _mapMoveCallbacks: Array<mapMoveCallbackFunction>;\r\n    _arrLyrRequest: Array<any>;\r\n\r\n    /**\r\n     * constructor called implicitly\r\n     */\r\n    constructor() {\r\n        super('map move');\r\n        this._arrLyrRequest = [];\r\n        this._arrLyrTimeout = [];\r\n        this._arrLayer = [];\r\n        this._lookupLayer = {};\r\n\r\n        this._mapMoveCallbacks = [];\r\n        this._mapMoveCallbacksLookup = {};\r\n        this._mapMoveCallbackDelays = [];\r\n        this._mapMoveCallbackContext = [];\r\n        this._mapMoveCallbackTimeout = [];\r\n\r\n        this._mapExtent = undefined;\r\n        this._zoomLevel = undefined;\r\n\r\n    }\r\n\r\n    /**\r\n     * initialize the map move object\r\n     * @param theMap - the ol map\r\n     */\r\n    init(theMap: ol.Map){\r\n        super.init(theMap);\r\n\r\n        this.map.getView().on(['change:center', 'change:resolution'], (e: {type: string}) =>{\r\n\r\n           this._updateMapExtent();\r\n\r\n            // trigger the layer updates\r\n            for (let i = 0; i < this._arrLayer.length; i++) {\r\n                this.triggerLyrLoad(this._arrLayer[i], i, e.type);\r\n            }\r\n\r\n            // trigger the map callbacks\r\n            for (let i = 0; i < this._mapMoveCallbacks.length; i++) {\r\n                this.triggerMoveCallback(i, e.type);\r\n            }\r\n        });\r\n    }\r\n\r\n    _updateMapExtent() {\r\n        let theView = this.map.getView();\r\n        this._zoomLevel = theView.getZoom();\r\n\r\n        let extentArray = theView.calculateExtent(this.map.getSize());\r\n\r\n        this._mapExtent = {\r\n            minX: extentArray[0],\r\n            minY: extentArray[1],\r\n            maxX: extentArray[2],\r\n            maxY: extentArray[3]\r\n        };\r\n    }\r\n\r\n    /**\r\n     * return the map extent\r\n     */\r\n    get mapExtent() {\r\n        if (!this._mapExtent) {\r\n            this._updateMapExtent();\r\n        }\r\n\r\n        return this._mapExtent;\r\n    }\r\n\r\n    /**\r\n     * Trigger the layer load\r\n     * @param lyr the layer being acted on\r\n     * @param index index of the layer\r\n     * @param eventType the event triggering the load, as 'change:center' or 'change:resolution'\r\n     */\r\n    triggerLyrLoad(lyr: LayerBaseVector, index?: number, eventType?: string) {\r\n\r\n        if (checkDefined.undefinedOrNull(lyr) && checkDefined.undefinedOrNull(index)) {\r\n            throw 'need to define lyr or index';\r\n        } else if (checkDefined.definedAndNotNull(lyr) && checkDefined.undefinedOrNull(index)) {\r\n            index = this._arrLayer.indexOf(lyr);\r\n        } else if (checkDefined.undefinedOrNull(lyr) && checkDefined.definedAndNotNull(index)) {\r\n            lyr = this._arrLayer[index];\r\n        }\r\n\r\n        // clear the timeout\r\n        if (this._arrLyrTimeout[index] != null) {\r\n            clearTimeout(this._arrLyrTimeout[index]);\r\n            this._arrLyrTimeout[index] = null;\r\n        }\r\n\r\n        // abort if necessary and clear the request\r\n        if (this._arrLyrRequest[index] != null && this._arrLyrRequest[index] != 4) {\r\n            this._arrLyrRequest[index].abort();\r\n            this._arrLyrRequest[index] = null;\r\n        }\r\n\r\n        // dummy callback used if before load returns false\r\n        let callbackFunc = function () {};\r\n\r\n        if (lyr.mapMoveBefore(this._zoomLevel, eventType)) {\r\n            lyr.mapMoveMakeGetParams(this._mapExtent, this._zoomLevel);\r\n\r\n            let __this = this;\r\n\r\n            callbackFunc = function () {\r\n                function innerFunction(theLayer: LayerBaseVector, theIndex: number) {\r\n                    let _innerThis = this;\r\n                    this._arrLyrRequest[theIndex] = $.get(\r\n                        theLayer.url,\r\n                        theLayer.mapMoveParams,\r\n                        function (d) {\r\n                            /**\r\n                             * @type {LayerBaseVector}\r\n                             */\r\n                            theLayer.mapMoveCallback(d);\r\n                            theLayer.loadCallback();\r\n                        }, 'json').fail(\r\n                        function (jqXHR) {\r\n                            if (jqXHR.statusText != 'abort') {\r\n                                console.log('failed');\r\n                                console.log(theLayer.url);\r\n                                console.log(theLayer.mapMoveParams);\r\n                            }\r\n                        }).always(\r\n                        function () {\r\n                            _innerThis._arrLyrTimeout[theIndex] = null;\r\n                            _innerThis._arrLyrRequest[theIndex] = null;\r\n                        });\r\n                }\r\n                innerFunction.call(__this, lyr, index);\r\n            };\r\n        } else {\r\n            lyr.clear();\r\n        }\r\n        this._arrLyrTimeout[index] = setTimeout(callbackFunc, lyr.onDemandDelay);\r\n    }\r\n\r\n    /**\r\n     * trigger the map move call back at the given index\r\n     * @param ind - the index of the layer\r\n     * @param eventType=undefined the event triggering the load as 'change:center' or 'change:resolution'\r\n     * @param functionId=undefined the function id used to reference the added callback function\r\n     */\r\n    triggerMoveCallback(ind: number, eventType?: string, functionId?: string) {\r\n\r\n        if (typeof ind == 'undefined' && typeof functionId == 'undefined'){\r\n            throw 'either the function index or the id must be defined';\r\n        }\r\n\r\n        if (typeof ind !== 'number'){\r\n            ind = this._mapMoveCallbacks.indexOf(this._mapMoveCallbacksLookup[functionId]);\r\n        }\r\n\r\n        if (ind < 0){\r\n            console.log('function not found');\r\n\r\n            return;\r\n        }\r\n\r\n        // clear the timeout\r\n        if (this._mapMoveCallbackTimeout[ind] != null) {\r\n            clearTimeout(this._mapMoveCallbackTimeout[ind]);\r\n            this._mapMoveCallbackTimeout[ind] = null;\r\n        }\r\n\r\n        let ctx = this._mapMoveCallbackContext[ind];\r\n        let theFunc = this._mapMoveCallbacks[ind];\r\n\r\n        let __this = this;\r\n\r\n        let f = function () {\r\n            if (ctx !== null) {\r\n                theFunc.call(ctx, __this._mapExtent, __this._zoomLevel, eventType);\r\n            } else {\r\n                theFunc(__this._mapExtent, __this._zoomLevel, eventType);\r\n            }\r\n        };\r\n\r\n        this._mapMoveCallbackTimeout[ind] = setTimeout(f, this._mapMoveCallbackDelays[ind]);\r\n    }\r\n\r\n    /**\r\n     * Add a layer to the interaction\r\n     * @param  lyr - layer to add\r\n     * @param triggerOnAdd - if the layer should be loaded on add\r\n     */\r\n    addVectorLayer(lyr: LayerBaseVector, triggerOnAdd: boolean = true) {\r\n        if (this._arrLayer.indexOf(lyr) > -1) {\r\n            console.log('already added ' + lyr.name + ' to map move');\r\n\r\n            return;\r\n        }\r\n        this._checkInit();\r\n\r\n        this._arrLyrRequest.push(null);\r\n        this._arrLyrTimeout.push(null);\r\n        this._arrLayer.push(lyr);\r\n        this._lookupLayer[lyr.id] = lyr;\r\n\r\n        triggerOnAdd = typeof triggerOnAdd == 'boolean' ? triggerOnAdd : true;\r\n\r\n        if (triggerOnAdd) {\r\n            if (this._mapExtent === undefined) {\r\n                this._updateMapExtent();\r\n            }\r\n            this.triggerLyrLoad(lyr, this._arrLayer.length - 1);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * add a callback to the map move event\r\n     * @param func - callback function\r\n     * @param context - the context to use for this function\r\n     * @param delay=50 the delay before call load\r\n     * @param triggerOnAdd if the layer should be loaded on add to mapMove\r\n     * @param functionId optional id to reference the function later for outside triggering\r\n     */\r\n    addCallback(func: mapMoveCallbackFunction, context?: any, delay?: number, triggerOnAdd? : boolean, functionId?: string) {\r\n\r\n        if (this._mapMoveCallbacks.indexOf(func) > -1) {\r\n            console.log('this function already added to map move');\r\n            return;\r\n        }\r\n        this._checkInit();\r\n        if (!functionId){\r\n            functionId = makeGuid();\r\n        }\r\n\r\n        this._mapMoveCallbacks.push(func);\r\n        this._mapMoveCallbacksLookup[functionId] = func;\r\n        this._mapMoveCallbackDelays.push(typeof delay == 'number' ? delay : 50);\r\n        this._mapMoveCallbackContext.push(checkDefined.definedAndNotNull(context) ? context : null);\r\n        this._mapMoveCallbackTimeout.push(null);\r\n\r\n        triggerOnAdd = typeof triggerOnAdd == 'boolean' ? triggerOnAdd : true;\r\n\r\n        if (triggerOnAdd) {\r\n            if (this._mapExtent === undefined) {\r\n                this._updateMapExtent();\r\n            }\r\n            this.triggerMoveCallback(this._mapMoveCallbacks.length - 1);\r\n        }\r\n    }\r\n}\r\n\r\nnm.MapMoveCls = MapMoveCls;\r\nexport default MapMoveCls;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/olHelpers/mapMoveCls.ts","/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\n\r\nimport MapInteractionBase from './mapInteractionBase';\r\nimport propertiesZoomStyle from '../olHelpers/propertiesZoomStyle';\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nimport {LayerBaseVector} from \"../layers/LayerBaseVector\";\r\nimport {LayerBase} from \"../layers/LayerBase\";\r\nimport LayerEsriMapServer from \"../layers/LayerEsriMapServer\";\r\nimport $ = require('jquery');\r\n\r\nconst nm = provide('olHelpers');\r\n\r\nexport interface popupChangedFunction {\r\n    ($popContent: JQuery): any;\r\n}\r\n\r\n/**\r\n *\r\n */\r\nexport interface popupCallback {\r\n    /**\r\n     * Callback function for the popup\r\n     * @param featureProperties\r\n     * @param jqRef\r\n     */\r\n    (featureProperties: Object, jqRef?: JQuery): string | boolean;\r\n}\r\n\r\ninterface mapEvent {\r\n    coordinate: ol.Coordinate;\r\n    pixel: ol.Pixel;\r\n    dragging: boolean|any;\r\n    originalEvent: Event;\r\n}\r\n\r\n\r\nexport class FeatureLayerProperties {\r\n\r\n    feature: ol.Feature;\r\n    layer: LayerBaseVector|LayerEsriMapServer;\r\n    layerIndex: number;\r\n    selectionLayer: ol.layer.Vector;\r\n    popupContent: string;\r\n    esriLayerName: string;\r\n\r\n    /**\r\n     *\r\n     * @param feature the feature\r\n     * @param layer - the layer in the popup\r\n     * @param layerIndex - index of the layer\r\n     * @param selectionLayer - the ol selection layer\r\n     * @param [esriLayerName=undefined] - esri layer name\r\n     */\r\n    constructor(feature: ol.Feature, layer: LayerBaseVector|LayerEsriMapServer, layerIndex: number, selectionLayer: ol.layer.Vector, esriLayerName?: string) {\r\n        this.feature = feature;\r\n        this.layer = layer;\r\n        this.layerIndex = layerIndex;\r\n        this.selectionLayer = selectionLayer;\r\n        this.popupContent = '';\r\n        this.esriLayerName = typeof esriLayerName == 'string' ? esriLayerName : undefined;\r\n    }\r\n\r\n    get layerName() {\r\n        if (typeof this.esriLayerName == 'string') {\r\n            return this.esriLayerName;\r\n        } else {\r\n            return this.layer.name;\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * map popup class\r\n * @augments MapInteractionBase\r\n */\r\nexport class MapPopupCls extends MapInteractionBase {\r\n    private _popupOpen: boolean;\r\n    private _passThroughLayerFeatureArray: Array<FeatureLayerProperties>;\r\n    private _currentPopupIndex: number;\r\n    private _popupContentLength: number;\r\n    private _esriMapServiceLayers: Array<LayerEsriMapServer>;\r\n    private _$popupCloser: JQuery;\r\n    private _$popupContent: JQuery;\r\n    private _$popupContainer: JQuery;\r\n    private _popupOverlay: ol.Overlay;\r\n    private _arrPopupLayers: Array<LayerBaseVector>;\r\n    private _popupCoordinate: ol.Coordinate;\r\n    private _popupChangedFunctions: Array<popupChangedFunction>;\r\n    private _mapClickFunctions: Array<Function>;\r\n    private _selectionLayerLookup: {[s: string]: ol.layer.Vector};\r\n    private _arrPopupLayerIds: Array<string>;\r\n    // private _arrPopupOlLayers: Array<ol.layer.Vector>;\r\n    private _arrPopupContentFunction: Array<popupCallback>;\r\n    private _selectionLayers: Array<ol.layer.Vector>;\r\n\r\n    /**\r\n     * Definition for openlayers style function\r\n     * @callback olStyleFunction\r\n     * &param feature the openlayers vector feature\r\n     * $param\r\n     */\r\n\r\n\r\n    /**\r\n     * map popup constructor\r\n     */\r\n    constructor() {\r\n        super('map popup');\r\n        this._arrPopupLayerIds = [];\r\n        this._arrPopupLayers = [];\r\n        // this._arrPopupOlLayers = [];\r\n        this._arrPopupContentFunction = [];\r\n        this._$popupContainer = undefined;\r\n        this._$popupContent = undefined;\r\n        this._$popupCloser = undefined;\r\n        this._popupOverlay = undefined;\r\n        this._selectionLayers = [];\r\n        this._selectionLayerLookup = {};\r\n        this._mapClickFunctions = [];\r\n\r\n        //let a = function($jqueryContent){console.log($jqueryContent)};\r\n        //this._popupChangedLookup = {'a': a};\r\n        this._popupChangedFunctions = [];\r\n        this._esriMapServiceLayers = [];\r\n\r\n        this._popupOpen = false;\r\n        this._popupCoordinate = null;\r\n\r\n        this._passThroughLayerFeatureArray = [];\r\n\r\n        this._currentPopupIndex = -1;\r\n        this._popupContentLength = 0;\r\n\r\n    }\r\n\r\n    /**\r\n     * map popup initialization\r\n     * @param {ol.Map} theMap - the ol map\r\n     */\r\n    init(theMap: ol.Map) {\r\n        super.init(theMap);\r\n\r\n        let $map;\r\n        let target = this.map.getTarget();\r\n\r\n        if (typeof target == 'string') {\r\n            $map = $('#' + target);\r\n        }\r\n        else {\r\n            $map = $(target);\r\n        }\r\n\r\n        $map.append(\r\n            '<div class=\"ol-popup\">' +\r\n            '<span class=\"ol-popup-closer\">X</span>' +\r\n            '<div class=\"popup-content\"></div>' +\r\n            '</div>'\r\n        );\r\n\r\n        this._$popupContainer = $map.find('.ol-popup');\r\n        this._$popupContent = $map.find('.popup-content');\r\n        this._$popupCloser = $map.find('.ol-popup-closer');\r\n\r\n        let _ease = (n: number): number => {\r\n            return ol.easing.inAndOut(n);\r\n        };\r\n\r\n\r\n        this._popupOverlay = new ol.Overlay({\r\n            element: this._$popupContainer[0],\r\n            autoPan: true,\r\n            autoPanAnimation: {\r\n                duration: 250,\r\n                source: theMap.getView().getCenter(),\r\n                easing: _ease\r\n            }\r\n        });\r\n\r\n        this._map.addOverlay(this._popupOverlay);\r\n\r\n        this._$popupCloser.click((evt) => {\r\n            this.closePopup();\r\n        });\r\n\r\n        // display popup on click\r\n        this._map.on('singleclick', (evt: {coordinate: [number, number], pixel: ol.Pixel}) => {\r\n\r\n            this.closePopup();\r\n            this._popupCoordinate = evt['coordinate'];\r\n\r\n            // esri map service layers\r\n            if (this._esriMapServiceLayers.length > 0) {\r\n\r\n                let queryParams = {\r\n                    geometry: evt['coordinate'].join(','),\r\n                    geometryType: 'esriGeometryPoint',\r\n                    layers: 'all',\r\n                    sr: this._map.getView().getProjection().getCode().split(':')[1],\r\n                    mapExtent: (this._map.getView().calculateExtent(this._map.getSize()) as number[]).join(','),\r\n                    imageDisplay: (this._map.getSize() as number[]).join(',') + ',96',\r\n                    returnGeometry: true,\r\n                    tolerance: 15,\r\n                    f: 'pjson'\r\n                };\r\n\r\n                for (let l of this._esriMapServiceLayers) {\r\n                    l.getPopupInfo(queryParams);\r\n                }\r\n            }\r\n\r\n            let layerFeatureObjectArray = this._featuresAtPixel(evt['pixel']);\r\n\r\n            this._passThroughLayerFeatureArray = [];\r\n            this._currentPopupIndex = -1;\r\n\r\n            for (let i = 0; i < layerFeatureObjectArray.length; i++) {\r\n                let featObj = layerFeatureObjectArray[i];\r\n\r\n                let props = featObj.feature.getProperties();\r\n\r\n                let popupContentResponse = this._arrPopupContentFunction[featObj.layerIndex](props, this._$popupContent);\r\n\r\n                //skip if return was false\r\n                if (popupContentResponse === false) {\r\n                    //continue;\r\n                } else if (typeof popupContentResponse == 'string') {\r\n                    featObj.popupContent = popupContentResponse as string;\r\n                    this._passThroughLayerFeatureArray.push(featObj);\r\n                } else {\r\n                    featObj.selectionLayer.getSource().addFeature(featObj.feature);\r\n                }\r\n            }\r\n\r\n            this._popupContentLength = this._passThroughLayerFeatureArray.length;\r\n\r\n            this._currentPopupIndex = -1;\r\n\r\n            let popupHtml = '<div class=\"ol-popup-nav\">';\r\n            popupHtml += '<span class=\"previous-popup ol-popup-nav-arrow\">&#9664;</span>';\r\n            popupHtml += '<span class=\"next-popup ol-popup-nav-arrow\">&#9654;</span>';\r\n            popupHtml += `<span class=\"current-popup-item-number\" style=\"font-weight: bold;\"></span>`;\r\n            popupHtml += `<span>&nbsp;of&nbsp;</span>`;\r\n            popupHtml += `<span class=\"popup-content-length\" style=\"font-weight: bold;\">${this._popupContentLength}</span>`;\r\n            popupHtml += `<span>&nbsp;&nbsp;-&nbsp;&nbsp;</span>`;\r\n            popupHtml += `<span class=\"current-popup-layer-name\"></span>`;\r\n            popupHtml += '</div>';\r\n            popupHtml += '<div class=\"ol-popup-inner\">';\r\n\r\n            popupHtml += '</div>';\r\n\r\n            this._$popupContent.html(popupHtml);\r\n\r\n            this._$popupContent.find('.previous-popup').click(() => {\r\n                if (this._popupContentLength == 1) {\r\n                    return;\r\n                }\r\n\r\n                if (this._currentPopupIndex == 0) {\r\n                    this._currentPopupIndex = this._popupContentLength - 1;\r\n                } else {\r\n                    this._currentPopupIndex--;\r\n                }\r\n                this._triggerFeatSelect();\r\n            });\r\n\r\n            let nextPopup = this._$popupContent.find('.next-popup');\r\n\r\n            nextPopup.click(() => {\r\n                if (this._popupContentLength == 1 && this._currentPopupIndex > -1) {\r\n                    return;\r\n                }\r\n\r\n                if (this._currentPopupIndex == this._popupContentLength - 1) {\r\n                    this._currentPopupIndex = 0;\r\n                } else {\r\n                    this._currentPopupIndex++;\r\n                }\r\n                this._triggerFeatSelect();\r\n            });\r\n\r\n\r\n            if (this._popupContentLength > 0) {\r\n                nextPopup.trigger('click');\r\n                this._popupOverlay.setPosition(this._popupCoordinate);\r\n                this._$popupContent.scrollTop(0);\r\n                this._popupOpen = true;\r\n            }\r\n        });\r\n\r\n        //change mouse cursor when over marker\r\n        this._map.on('pointermove', (evt) => {\r\n\r\n            if (evt['dragging']) {\r\n                return;\r\n            }\r\n            let pixel = this.map.getEventPixel(evt['originalEvent']);\r\n\r\n            let hit = false;\r\n\r\n            this.map.forEachFeatureAtPixel(pixel, (f, l) => {\r\n                if (hit) {\r\n                    return;\r\n                }\r\n\r\n                for (let vLyr of this._arrPopupLayers){\r\n                    if (vLyr.olLayer == l){\r\n                        hit = true;\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n\r\n            let mapElement = this.map.getTargetElement() as HTMLElement;\r\n            mapElement.style.cursor = hit ? 'pointer' : '';\r\n        });\r\n    }\r\n\r\n    /**\r\n     * helper to select features\r\n     * @private\r\n     */\r\n    _triggerFeatSelect() {\r\n        let $currentPopupItemNumber = this._$popupContent.find('.current-popup-item-number');\r\n        let $innerPopup = this._$popupContent.find('.ol-popup-inner');\r\n        let $layerNameSpan = this._$popupContent.find('.current-popup-layer-name');\r\n        this.clearSelection();\r\n        let lyrFeatObj = this._passThroughLayerFeatureArray[this._currentPopupIndex];\r\n        $currentPopupItemNumber.html((this._currentPopupIndex + 1).toFixed());\r\n        $layerNameSpan.html(lyrFeatObj.layerName);\r\n        $innerPopup.html(lyrFeatObj.popupContent);\r\n        lyrFeatObj.selectionLayer.getSource().addFeature(lyrFeatObj.feature);\r\n        for (let f of this._popupChangedFunctions) {\r\n            f(this._$popupContent);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     *\r\n     * @param feature - the ol feature\r\n     * @param {LayerEsriMapServer} lyr - the map server layer\r\n     * @param {string} popupContent - popup content\r\n     * @param {string} esriName - esri layer name\r\n     */\r\n    addMapServicePopupContent(feature: ol.Feature, lyr: LayerEsriMapServer, popupContent: string, esriName: string) {\r\n\r\n        let featLayerObject = new FeatureLayerProperties(\r\n            feature, lyr, this._popupContentLength, this._selectionLayerLookup[lyr.id], esriName\r\n        );\r\n        featLayerObject.popupContent = popupContent;\r\n\r\n        this._passThroughLayerFeatureArray.push(featLayerObject);\r\n        this._popupContentLength++;\r\n\r\n        $('.popup-content-length').html(this._popupContentLength.toFixed());\r\n\r\n        if (!this._popupOpen) {\r\n            this._$popupContent.find('.next-popup').trigger('click');\r\n\r\n            this._popupOverlay.setPosition(this._popupCoordinate);\r\n            this._$popupContent.scrollTop(0);\r\n            this._popupOpen = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param  pixel - the ol pixel\r\n     * @returns  feature layer properties\r\n     * @private\r\n     */\r\n    _featuresAtPixel(pixel: ol.Pixel): Array<FeatureLayerProperties> {\r\n        let layerFeatureObjectArray: FeatureLayerProperties[] = [];\r\n\r\n        this.map.forEachFeatureAtPixel(pixel, (feature: ol.Feature, layer: ol.layer.Vector) => {\r\n            let hasLyr = false;\r\n\r\n            let j;\r\n            let lyr = null;\r\n\r\n            for (j = 0; j < this._arrPopupLayers.length; j++){\r\n                lyr = this._arrPopupLayers[j];\r\n\r\n                if (lyr.olLayer === layer){\r\n                    hasLyr = true;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (hasLyr) {\r\n                layerFeatureObjectArray.push(\r\n                    new FeatureLayerProperties(\r\n                        feature, lyr, j, this._selectionLayers[j]));\r\n            }\r\n        });\r\n\r\n        return layerFeatureObjectArray;\r\n    }\r\n\r\n    closePopup() {\r\n        this._checkInit();\r\n        this._popupOpen = false;\r\n        this._popupOverlay.setPosition(undefined);\r\n        this._$popupCloser[0].blur();\r\n        this.clearSelection();\r\n        this._$popupContent.html('');\r\n\r\n        return false;\r\n    };\r\n\r\n\r\n    /**\r\n     *\r\n     * @param chgFunction - popup change function\r\n     */\r\n    addPopupChangedFunction(chgFunction: popupChangedFunction) {\r\n        this._popupChangedFunctions.push(chgFunction);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {LayerBase|*} lyr - the layer being acted on\r\n     * @param {object} [selectionStyle={}] the selection style configuration\r\n     * @param {string} [selectionStyle.color=rgba(255,170,0,0.5)] the selection color\r\n     * @param {number} [selectionStyle.width=10] the selection width for linear features\r\n     * @param {object|function} [selectionStyle.olStyle=undefined] an openlayers style object or function\r\n     * @returns  the new selection layer\r\n     * @private\r\n     */\r\n    _addPopupLayer(lyr: LayerBaseVector|LayerEsriMapServer, selectionStyle: {color?: string, width?: number, olStyle?: ol.style.Style}): ol.layer.Vector {\r\n        this._checkInit();\r\n\r\n        selectionStyle = selectionStyle || {};\r\n        selectionStyle.color = selectionStyle.color || 'rgba(255,170,0,0.5)';\r\n        selectionStyle.width = selectionStyle.width || 10;\r\n\r\n        let theStyle;\r\n\r\n        if (selectionStyle.olStyle) {\r\n            theStyle = selectionStyle.olStyle;\r\n        } else {\r\n            theStyle = new ol.style.Style({\r\n                stroke: new ol.style.Stroke({\r\n                    color: selectionStyle.color,\r\n                    width: selectionStyle.width\r\n                }),\r\n                image: new ol.style.Circle({\r\n                    radius: 7,\r\n                    fill: new ol.style.Fill({color: selectionStyle.color}),\r\n                    stroke: new ol.style.Stroke({color: selectionStyle.color, width: 1})\r\n                }),\r\n                fill: new ol.style.Fill({\r\n                    color: selectionStyle.color\r\n                })\r\n            });\r\n        }\r\n\r\n        let selectionLayer = new ol.layer.Vector(\r\n            {\r\n                source: new ol.source.Vector(),\r\n                style: theStyle\r\n            }\r\n        );\r\n\r\n        selectionLayer.setZIndex(100);\r\n\r\n        this._selectionLayers.push(selectionLayer);\r\n        this._selectionLayerLookup[lyr.id] = selectionLayer;\r\n        this.map.addLayer(selectionLayer);\r\n\r\n        return selectionLayer;\r\n    }\r\n\r\n\r\n    /**\r\n     * Add popup to the map\r\n     * @param {LayerBase|*} lyr The layer that the popup with act on\r\n     * @param {popupCallback} popupContentFunction - popup content function that makes popup info\r\n     * @param {object} [selectionStyle={}] the selection style configuration\r\n     * @param {string} [selectionStyle.color=rgba(255,170,0,0.5)] the selection color\r\n     * @param {number} [selectionStyle.width=10] the selection width for linear features\r\n     * @param {object|function} [selectionStyle.olStyle=undefined] an openlayers style object or function\r\n     * @returns {object} a reference to the ol selection layer\r\n     */\r\n    addVectorPopup(lyr: LayerBaseVector, popupContentFunction: popupCallback,\r\n                   selectionStyle?: {color?: string, width?: number, olStyle?: ol.style.Style}) {\r\n        let selectionLayer = this._addPopupLayer(lyr, selectionStyle);\r\n        this._arrPopupLayerIds.push(lyr.id);\r\n        this._arrPopupLayers.push(lyr);\r\n        // this._arrPopupOlLayers.push(lyr.olLayer);\r\n        this._arrPopupContentFunction.push(popupContentFunction);\r\n\r\n        return selectionLayer;\r\n    };\r\n\r\n\r\n    /**\r\n     *\r\n     * @param {LayerBase} lyr - layer\r\n     */\r\n    removeVectorPopup(lyr: LayerBaseVector) {\r\n        let idx = this._arrPopupLayerIds.indexOf(lyr.id);\r\n\r\n        if (idx > -1) {\r\n            this._arrPopupLayerIds.splice(idx, 1);\r\n            this._arrPopupLayers.splice(idx, 1);\r\n            // this._arrPopupOlLayers.splice(idx, 1);\r\n            this._arrPopupContentFunction.splice(idx, 1);\r\n            this._selectionLayers.splice(idx, 1);\r\n            delete this._selectionLayerLookup[lyr.id];\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {LayerEsriMapServer} lyr - map server layer\r\n     * @param {object} [selectionStyle={}] the selection style configuration\r\n     * @param {string} [selectionStyle.color=rgba(255,170,0,0.5)] the selection color\r\n     * @param {number} [selectionStyle.width=10] the selection width for linear features\r\n     * @param {object|function} [selectionStyle.olStyle=undefined] an openlayers style object or function\r\n     * @returns {object} a reference to the ol selection layer\r\n     */\r\n    addMapServicePopup(lyr: LayerEsriMapServer, selectionStyle?: ol.style.Style|Array<ol.style.Style>|ol.StyleFunction) {\r\n        let selectionLayer = this._addPopupLayer(lyr, selectionStyle);\r\n        this._esriMapServiceLayers.push(lyr);\r\n\r\n        return selectionLayer;\r\n    }\r\n\r\n    clearSelection() {\r\n        this._checkInit();\r\n        for (let i = 0; i < this._selectionLayers.length; i++) {\r\n            this._selectionLayers[i].getSource().clear();\r\n        }\r\n        for (let f of this._mapClickFunctions) {\r\n            f();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Add a function to be called when the map is clicked but before any popups are implemented\r\n     * @param {function} func - the map click function\r\n     */\r\n    addMapClickFunction(func: Function) {\r\n        this._mapClickFunctions.push(func);\r\n    }\r\n}\r\nnm.MapPopupCls = MapPopupCls;\r\nexport default MapPopupCls;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/olHelpers/mapPopupCls.ts","/**\r\n * Created by gavorhes on 12/15/2015.\r\n */\r\n\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nimport $ = require('jquery');\r\nimport {Geocode} from './geocode';\r\nconst nm = provide('olHelpers');\r\n\r\nexport interface quickMapOptions {\r\n    divId?: string;\r\n    center?: {x: number, y: number};\r\n    zoom?: number;\r\n    minZoom?: number;\r\n    maxZoom?: number;\r\n    baseSwitcher?: boolean;\r\n    fullScreen?: boolean;\r\n    addGeocode?: boolean;\r\n}\r\n\r\n/**\r\n * Sets up a map with some default parameters and initializes\r\n * mapMove and mapPopup\r\n *\r\n * @param [options={}] config options\r\n * @param [options.divId=map] map div id\r\n * @param [options.center={}] center config object\r\n * @param [options.center.x=-10018378] center x, web mercator x or lon\r\n * @param [options.center.y=5574910] center y, web mercator y or lat\r\n * @param [options.zoom=7] zoom level\r\n * @param [options.minZoom=undefined] min zoom\r\n * @param [options.maxZoom=undefined] max zoom\r\n * @param [options.baseSwitcher=true] if add base map switcher\r\n * @param [options.fullScreen=false] if add base map switcher\r\n * @returns the ol map\r\n */\r\nexport function quickMapBase(options: quickMapOptions = {}): ol.Map {\r\n    options.divId = options.divId || 'map';\r\n    options.center = options.center || {x: -10018378, y: 5574910};\r\n    options.zoom = typeof options.zoom == 'number' ? options.zoom : 7;\r\n    options.baseSwitcher = typeof options.baseSwitcher == 'boolean' ? options.baseSwitcher : true;\r\n    options.fullScreen = typeof options.fullScreen == 'boolean' ? options.fullScreen : false;\r\n    options.addGeocode = options.addGeocode || false;\r\n\r\n\r\n    let $mapDiv = $('#' + options.divId);\r\n    $mapDiv.css('position', 'relative');\r\n\r\n    let osmLayer = new ol.layer.Tile({source: new ol.source.OSM()});\r\n    // let satLayer = new ol.layer.Tile({visible: false, source: new ol.source.MapQuest({layer: 'sat'})});\r\n\r\n    let osmCss = \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURQAAADQ1NDk5OURFREtLS1FHSFlZWGJRVGJiYWdmZWxsbHRmaXBpanN0c3V0dHp5eX5+fIVzd4F3eeV0jud5juZ8k4aHhomHhoyGh5eGj5OVlJiVlZiYl5qZmJydnKOTlaKZmqKdnaOioaqqqKuzsbOvrrSysLa3tbW4uLm6ub27ub+/vbGXwbCZwbCgxLKlxrOqyLStybO3yrSxyrWzzbW2y7a1zbK4y7W6zbW8y760yrTAzbTFzrPKzrLOzrTJzrTOzr7CwbXC0LXK0LTO0L3I0bPQz7TQz7PS0bXQ0LnR0brW1bzT0r7U077V1Lzc2dqNqteUsdyXscaquuOHneaGmueHnOeJnuiBleiKn+eNoOiOoOWUpOiRo+iSpeiUpeqYpumaqOmdrPSynemgruSqtOmisOmlsuuqtequuOW1vOuxu+uxvOq1ve+xvPK0pvW3o/W5pfO5qvS7qfCwvMOuwc2/wNenxNyyzNe/0Nq31Nq51dy72Oy3wOu4wOu+xey4wO+6xO2+xfTAr/TCsvfFtPHLvvTJuMPDwMfHxcXKyc3DxMvFyMvLyM3PzcDV08DV1MTX1cbY1s7X1sjZ1sra2Mnd3M7b2c7c2tfH1tnB1t7F2d7M29fX1tLY1tDd2tHe3NTf3NnS19rZ1tva2Nnf3t3d28rh3tXg3Nnh3tzj393k39ni4N7k4N7n5uXDyOfLz+zAxu3CyOzEyezKzeDJ3eLM3uvP0u3P0ePf2+7R0u7Q1u/U0+7U1ezc0+7a2e/d2+3f3vbFzvLOwfHN0PPQw/TUx/LWyvLYzPDQ1fPe0ubc4vve4uHh3+nh3+/h2u/h3vHj2vHl3uHm4eTn4uDp5ebo4+Xo5ODq6ebq6OTv6+nl4+/j4O7l4e7n5ujp4+np5Ozq5e7s5urt6O7t6Orw6u7x6u3x7vPj5PDl4fDo4vDq5fDt5vDu6PDv7PTv6fDx6vHx7fH17fXw6fXy7fb07/bz8fT18vn38vr39fr48/r59Pr6+P3++//+/gAAALNTSk0AAAEAdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBT9wclAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGHRFWHRTb2Z0d2FyZQBwYWludC5uZXQgNC4wLjlsM35OAAAFNElEQVRIS1VVCZxVUxi/9l0UIUT2bMnY43bVI2c0Y01kSWIaS0j2JEtkN41piomZrPPKQ2aQ7JKImOZlnm2493TJzDufuU1Zi+v/fee+mZ//793vnPOd7zvfes5zDBEZkBBjAcIjb+Iiotqgdhat8AMK0vl7/R9N7GiWtshqIr+EZ5gYKibyUsXY1l/mfFpssvUlWQ0FkU3gy4+RB/+kwYcO8pRSnldcOU/r2lAHARSwk2ORgEmOdC1EsuRiYSqMPwwroMIraZk5V2fYJQjCKfZrRmh3gSAZi2i4b7wSylWu8EqZwS59JkFUaW96JbNSc+CEUmt4rorwuZmWdDaoc+uZETuQlTCU5xYzR7muUnVUVo+BcRhre/VwUpasgJwhH7JkYIYA0sNxhmCwUK+lw6vCKBZehw01dEiyw4Q4aE0Z4ahDhKaFQsGnJ2BgqKoTBsNjFy0SlW6whRAZTdm8DBJmkBZhDi1j4xJQBk6ywrWUTymaCxac8lROcdauRGzQSNtA7EHUYhXyEwhhgjFUqRuO+rauhF1awFpzCsmwUbjIFBR0u1bKtyGpulW/H/cVVzkyGaIWTIR9pFAV6GK2gPMXMX8gPk9zzxXgI1kimcAltEYr+cjio1imlKpEa9rOipLm+p+CZ6Bw//qd1/f/O+GwMxbSLpyoZEcwkyh2jIks+3hmdd2jWUw4scxNysnHxU7nSspTRcJjCZGL3IsjsYJMMg5mwgx7gaIOLBFCogAgBBoNa9w+DE6I+Bs7FTgwwrJbHjWDgpYo2KwtBTcYEDuloC9geQw+k2RGnPGpTaOlq7AS+YICUz4DZVaX2TiNDhuYfTtY4geLi0IoCm3XccwM9hx4kU28StQEljDs3ZEpFGA+8dKzLmV9ymIwF5FOGn2GdJM8KLHDJbXyiYVMG9MRTLiXGGg2QKaxM3khPSRrwM9zEIardxU2w/EiA0gOeYKHzDR0V7/QGV3lKIA9ktrDArxO3gdA+k6SKoBiVwcm7NjZb9+Hnztg282TuHVZ9LOISFNt9MgyCetZVczSxnyDbl17Penq6mqpg1IhRaEO2aVLUO4/r17H8tTv6f13h71dduvZI3Y+uMdWksNSauLovJw5hsqiPIUvt0ku7/iBeUR3sksmomYWtRbAjbiLfv2lX9/V7LVG4uYnUZXhQ7f2OPCZEx9wrYWTcePEQqPEML8pl4mMdr/jlXlvHiRiJ2+MSTFY4TTSYStuvz2R/JXh+PPeGXm055J+3/YDWuNu3R3DArPutyg0ZgykMVDU9Ndm22+wYalr2rse48CnsTIFcMn73vfhNrktx1EUcZnPv6ah3Yy5cDTRdBEoGoBeah71dqFyjZDJLkWk3N3v4uuktssjWpzciMPxQeHj8nMKzcGuB0tAyzFhdCKOYWv4HwOQVwIxLG99a6uvH3sJCyO3h+k4EZ+G7+xj5f4XXksoaGrdMRzSc8ARA8+cdOuk2x6fffNNt5x+Ro1omPlrT/CQDlcNlpx4NBIWXhkx7Y3Zp3ofNR7Uv89Om/beW0TLIynHv3vs1VsOFpSWSXvfuPUf9BrRFyxgXdHoKJnQFegPOovvzz59ntrzye240ig8UQ3lDI2VqwagrKIQcLXNFL3wglN2OHdBQ6/vI3kENDVBwRb3k1XtczFbjWn4EzMYi7CF3129+JTYuRSdrGuS92g5dpqn6qXoJQs5xmL8p+Wt4hLbt0mx2OLNZR2bbPy8zJNQGFM/f/CfXZekRYFjGCWjIJpM+WiCzGBPWHhoyaAsjRT/B2Gy5yzYJkwUAAAAAElFTkSuQmCC')\";\r\n    let aerialCss = \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURQALBgIMDQgOBwQOEQcTBwUSCwoVDAwdBw8ZDgUREwYUGAYZFQYZGgkTFQoVGQsZFAwZHBMeDhIbFBEbHAwWIA4bIREcIQ4hCQwjFw4lHBgkDB8sDxUiExIiGhAoGxohFRshGRorHQcrKQsiIQwmKgooJA0pKQ81Jw8yLRMiIxImKxUrJREuKhslJB0rIhooKRUuMBMyLhkwJhozKh48LxUzMRM9MBwzMiUvFCMtGiMwEiwzFCgzHDI+GSIsISkvJSQxIiM2LiY5Jic+Lyk0JSo0Ky49JSs9KSU1NSM7NCs2NS8+NDM1JzU9Ljg7IDJCHS1DLSNAMitCMSxIOjREITZLIDZJKDlFIjpFKztKJT1LKzJBMzpHMD1JMjpKPD1RKjlQNC1DQj5QQEA8MEJGJkBKJUJNK0lLLEJMMkVMPEpONENSLUdZL0pTLkpaLkRUMkRSPEVZMktUM0pVOklZMklZNEpcNU1ZMk1ZNUxfMk5dNkxcOVFUM1RUOFJbNVFZOVNYPVFdOVJdPFVaOVVaPVVdOlVdPVpaNlpdO0phN01hOlBiN1NhPFNoP1piPWFbPmRjPENOQEtPSURTQkJVS0xVQk1VSkxbQkxcS0heUVFXRFRcQlJfTFxeQlpeS05lQk1kSFRjQVRjSlZpQ1tkQlxlSlxpRF1rSVVnUVtlU1llXF9tU1xoXlxwSl9ramRfQmJlQ2FhSWFlSWFlTmVlSWRmTGFoQWFpRWFsRmVpRWVtRmNsSmtlRGpqRmpsS2BmWGRsUmFrW2ptUmZyR2RxTGpxTWVyU2RyW2d5V2tzUmt0WW15VG15WXFuTHNtVnFxTXF4T3h0TnJzUnJ1XHJ4VXN6Wnp0VHx1W315VXp8XGR0YGx0YHVzZXJ0aHR9ZXV+aHl9YHOCXXqBXXeCYHyCY3iEaHyIYn+JaXqKcYB5WIN6Y4SCXoCDZIGEaYCIZoOLa4iCaImJbIOOdYuMco6OeIuVcpOKbZKPc5aQb5eXe5ufg6KjhAAAAAAAAAAAAAAAAOGCeQgAAAEAdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBT9wclAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGHRFWHRTb2Z0d2FyZQBwYWludC5uZXQgNC4wLjlsM35OAAAH80lEQVRISy1WbXQUVxm+6wqnk3Zmpxl2FG2EGg92C8GDlWptVTwa+uF3xcKmDfFzCUzDsJNsunXipglJXJbrtJWmwZNSnHD3jojRgUIm2UumIZ0JZ7JByrALbMWW0IBW8aRa4+cf76TeX3Nm3uc+z/s+7/vugl4r/aMTrT4e1pPTqnnmJNn5AyUzRnrRle/qE33dsvrBtAQVoxtpZNK3zSzYjUjviWO2Ag+R77dl7W36n/1Ep9KBPG/S+Py0PkjU/gPKQGqwTHryiWYFAXSvMairsio7SjyNsnCzh0qKImV9/7mhfHQZx2yN1O+7rXUm33MUPaboOkAJHaoIdXfJj2xWeyD8jMFEXkvIu5qzpU988gWB5zl+GS+sFe55trEVPdWZB2miq8bBVkNFO2R0qnrfkiXhcJhtDNXE6tbW97/s9O9/7ZfVhx86/CwrROpfvvxboMqeLsuqPr1j44qEwDNMOBximUiYoU8sw7BC/a7T72uEnyJDlGxZ9KcglZRyuqqrv/tSZErgOI4NgRBTIw9EmHAoFGZZnp6aGaJ2GTxfxYs8kKVUQh7WB5hQeC3LsUxoxVKW14l3BX2WcoUYPiZyLLe8teZ+iuT4GGhvV5KpKWkpyzxEr2MZgQ1xdRjfRBoH+2k6lIHjKTHPPBo8CSJISqqq4wGGOcWylIGlgvgNX1Gd8vF5f+IUIwb30ng+Gg2QfBRIMvy0jG8SVkYo4N0zvUXVRztbJ/L6xL7lUZEXBEHkuZqlS6gEAUgKJurnhFtfpACOYd8b/hVbJPqwi44a6KA0sPVjIi/SIyxb3u8KlAJ0S8jRVgrlW+nVHPdrhiXCxu42d86ByksDc80P3MkJFBFQ8Ho1lQegpWJRWFGsDsRwwv7pIyvuQW0ZkrX6NDVFbqcvaQI8vbyqzt5AARrsbKx5yhQEGs+wPO56bOK+0rcwMrOKkpUbZWYxV04UeZZv/cBKFhRL6Qdv9y4LfEDA7/thg7tTmv1a5/GnO0wl0dQg80wglZaHUmxRvjwAHOfyN0mxrpqLUpcjsK3NHYMo4R1o6eho2ZyIb2FoeOC3ILK8kZ2HQMOuWywGXUkJBCeTbYFS0+ym1h2/6UgmvnrvKYZZtIEXGf75C2cIAp5LHNd71x7uPoTjakrWH9e3KFpaatjUvJUysFw0KrLMYMW2lTg4PeUQx6kJEALvxXEmCdVyPLHtCSjBhc01XCjIgafxou+PE6KC1dhxSCwoBCc+N4P3btM84pmdSSjJnjO/nvY4LQfVyz5/I+v6IwjUOMjy+MVCxIbKupTJaEktp7cTKU42Pvjh2m/8cSpC6aPsaX/MHSuUQLVVsIa4RUTs/r/BVAexNdjdnsNG7j/rV93xheLMzKnFrPeTEQchCyCcKb25aAIn7lrAertrZwyNXM8N6zfWrFo3d2SmOEcF83x/r+OOFgrAHYWF7cELjhV7UQo/6WAIUVl9JFl8a//HZ66VpbY3I9QKZqPru77lA+iOWAIr0hKxHCmmr0othSyeIl5y3qt4xT8gSNrKEZozs8Els67rgsLOZ+ygzwMfbtNhobfgzpEyGnz7htPtzUi6PuOoj7K0WF/MXiUFxwGajRD1hjYXHXI9p406qOyinp5/tiWcDHY0jIu4n64Qfq7kliB2gemag9QbOia0PbbDMbd43SHuvxFxrAocxins7MX5Kqbe1QixKBxoV4//PfAgGCu+Rlm4SvZizyDH+0reDHp92iO0BuX3bCfItl0PEwvYLqpwXG2MHlGsQ4S8pMJZv1JGmHiEoHQDdOjwmVlEP/nE9ADKjI8xLI0OOGITfy0SbeG/C2jKUDGSlDhM9I3IpK9iup6XnbRNC7yqueNsJCCIiXzdQhnaGN+46umnEdy5U5UbUJ48LFM9GkJo8BdDOiAZ7ZIQbKhYLMqvhU2wmNxjEAsS2AI7y4nWF64duePbk7YV3zvAVLEMD9AxJRNa3KDUibV7DjnkuprMEYjScFNcaR2ceP2u9R/5k1052Ryme5phAFRswlHjAudiP4dOy7CaxLgdJh9vUlU1702/+LPa1U9fvPi9qlA4XEUBJc3dFlpsR457IDl1iPqLp7o81NQgyV19iYU38uTiv975Pd3SiwQcsGjx+v4/6fl5T7EOOMTCtpbKxfemsQq/3olQZcminADAAI0cuGLHaHOFxbuGvRk/Z9u7CULqoVR6NE0yx1avj30oRhc/jWUoIALGxkz0dg1Dl9iaI7LqOOXKsXJFwjiuEAi70Jra2nW1PL08zLBhZsMABpW5csI7TPfew9ipFKcn5k1i+1KyCWKjC3W/8dF1d666+RaabBVTFTHacjoojBNDh0NDxk+IPTlwfqJkWpbnpFHXIbLbmpxEQ3ff/Z0g/mauXsoln9wDRjy/NHsQFw3P6vWuTJ43/+FZrk2cvAFRipCKdfD9y2+pjRj78s0KdCUDKJvdV91ChngV38T20TM+gghjpJaPlpFr2xbEz5g4A/NGt5rNwdwmYGeeeMXBSLHHUIc+6RsojRH9VTUm3/mLf/64b470XvoxoTKhlMBQ2jMEzo2PjxdGMppmn1RM24bWFJqaQv4BcuJa2Sam7Zokq1ldCsz06NCBHrhwqVQYpfFj42NZexz1EW9SR/kT58nEeQKJb2fPXjjp0u/YUkwHEgLeOnf2nOuf1TRTM02CLKLTPy60/x1CCztqn7Ev+BdsC3m+30decQvW/wBNTwU+CfUQAQAAAABJRU5ErkJggg==')\";\r\n\r\n    if (options.baseSwitcher) {\r\n        //  let switcherContent = '<div class=\"base-map-switcher\" title=\"Toggle Base Layer\" style=\"';\r\n        //  switcherContent += 'position: absolute; top: 70px; left: 4px; border: solid black 1px; ';\r\n        //  switcherContent += `height: 50px; width: 50px; z-index: 10; border-radius: 4px; background: ${aerialCss};`;\r\n        //  switcherContent += '\"></div>';\r\n        //  $mapDiv.append(switcherContent);\r\n        //\r\n        // $mapDiv.find('.base-map-switcher').click(function() {\r\n        //      \"use strict\";\r\n        //      osmLayer.setVisible(!osmLayer.getVisible());\r\n        //      satLayer.setVisible(!satLayer.getVisible());\r\n        //\r\n        //      if (osmLayer.getVisible()){\r\n        //          $(this).css('background', aerialCss);\r\n        //      } else {\r\n        //          $(this).css('background', osmCss);\r\n        //      }\r\n        //  });\r\n    }\r\n\r\n    if (options.zoom < 0 || options.zoom > 28) {\r\n        throw 'zoom out of range';\r\n    }\r\n\r\n    if (options.center.x >= -180 && options.center.x <= 180 && options.center.y >= -90 && options.center.y <= 90) {\r\n        let p = new ol.geom.Point([options.center.x, options.center.y]);\r\n        new ol.proj.Projection({code: \"EPSG:4326\"});\r\n\r\n        p.transform(new ol.proj.Projection({code: \"EPSG:4326\"}), new ol.proj.Projection({code: \"EPSG:3857\"}));\r\n        let coordinates = p.getCoordinates();\r\n        options.center.x = coordinates[0];\r\n        options.center.y = coordinates[1];\r\n    }\r\n\r\n    const controls = ol.control.defaults({\r\n            attributionOptions: {collapsible: false}\r\n        }\r\n    );\r\n\r\n    const view = new ol.View({\r\n        center: [options.center.x, options.center.y],\r\n        zoom: options.zoom,\r\n        minZoom: options.minZoom,\r\n        maxZoom: options.maxZoom\r\n    });\r\n\r\n    let map = new ol.Map({\r\n        layers: [osmLayer],\r\n        target: options.divId,\r\n        controls: controls,\r\n        view: view\r\n    });\r\n\r\n    if (options.fullScreen) {\r\n        map.addControl(new ol.control.FullScreen({}));\r\n    }\r\n\r\n    if (options.addGeocode){\r\n        new Geocode(document.getElementById(options.divId) as HTMLDivElement, map);\r\n    }\r\n\r\n    return map;\r\n}\r\n\r\nnm.quickMapBase = quickMapBase;\r\nexport default quickMapBase;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/olHelpers/quickMapBase.ts","/**\r\n * Created by gavorhes on 12/14/2015.\r\n */\r\n\r\nimport provide from '../util/provide';\r\nconst nm = provide('olHelpers.zoomResolutionConvert');\r\n\r\nlet _zoomResLookup = [\r\n    156543.03392804097, //0\r\n    78271.51696402048, //1\r\n    39135.75848201024, //2\r\n    19567.87924100512, //3\r\n    9783.93962050256, //4\r\n    4891.96981025128, //5\r\n    2445.98490512564, //6\r\n    1222.99245256282, //7\r\n    611.49622628141, //8\r\n    305.748113140705, //9\r\n    152.8740565703525, //10\r\n    76.43702828517625, //11\r\n    38.21851414258813, //12\r\n    19.109257071294063, //13\r\n    9.554628535647032, //14\r\n    4.777314267823516, //15\r\n    2.388657133911758, //16\r\n    1.194328566955879, //17\r\n    0.5971642834779395, //18\r\n    0.29858214173896974, //19\r\n    0.14929107086948487, //20\r\n    0.07464553543474244, //21\r\n    0.03732276771737122, //22\r\n    0.01866138385868561, //23\r\n    0.009330691929342804, //24\r\n    0.004665345964671402, //25\r\n    0.002332672982335701, //26\r\n    0.0011663364911678506, //27\r\n    0.0005831682455839253 //28\r\n];\r\n\r\n/**\r\n * Get the resolution given the zoom level\r\n * @param {number} zoomLevel - the zoom level\r\n * @returns {number|*} the map resolution\r\n */\r\nexport function zoomToResolution(zoomLevel: number): number {\r\n    \"use strict\";\r\n\r\n    if (typeof zoomLevel == 'number') {\r\n        if (zoomLevel % 1 === 0 && zoomLevel >= 0 && zoomLevel <= 28) {\r\n            return _zoomResLookup[zoomLevel];\r\n        } else {\r\n            console.log(`invalid zoom level provided: ${zoomLevel}`);\r\n\r\n            return undefined;\r\n        }\r\n    } else {\r\n        return undefined;\r\n    }\r\n}\r\nnm.zoomToResolution = zoomToResolution;\r\n\r\n\r\n/**\r\n * Get resolution from the zoom level\r\n * @param {number} resolution - the resolution\r\n * @returns {number|*} the zoom level\r\n */\r\nexport function resolutionToZoom(resolution: number): number{\r\n    for (let i = 0; i < _zoomResLookup.length; i++){\r\n        if (resolution >= _zoomResLookup[i] ){\r\n            return i;\r\n        }\r\n    }\r\n\r\n    return 0;\r\n}\r\n\r\nnm.resolutionToZoom = resolutionToZoom;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/olHelpers/zoomResolutionConvert.ts","import {LayerBase, LayerBaseOptions} from './LayerBase';\r\nimport mapMove from '../olHelpers/mapMove';\r\nimport MapMoveCls from '../olHelpers/mapMoveCls'\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nimport $ = require('jquery');\r\n\r\nconst nm = provide('layers');\r\n\r\nexport interface makeMapMoveParams {\r\n    /**\r\n     *\r\n     * @param lyr\r\n     * @param extent\r\n     * @param zoomLevel\r\n     */\r\n    (lyr: LayerBaseVector, extent: {minX: number, minY: number, maxX: number, maxY: number}, zoomLevel?: number): any\r\n}\r\n\r\n\r\n\r\nexport interface LayerBaseVectorOptions extends LayerBaseOptions{\r\n    autoLoad?: boolean;\r\n    style?: ol.style.Style|Array<ol.style.Style>|ol.StyleFunction;\r\n    onDemand?: boolean;\r\n    onDemandDelay?: number;\r\n    mapMoveMakeGetParams?: makeMapMoveParams;\r\n    mapMoveObj?: MapMoveCls;\r\n    renderOrder?: (a: ol.Feature, b: ol.Feature) => number;\r\n\r\n}\r\n\r\n\r\n\r\n/**\r\n * The Vector layer base\r\n * @augments LayerBase\r\n * @abstract\r\n */\r\nexport class LayerBaseVector extends LayerBase {\r\n    _olLayer: ol.layer.Vector;\r\n    _source: ol.source.Vector;\r\n    _style: ol.style.Style|Array<ol.style.Style>|ol.StyleFunction;\r\n    _autoLoad: boolean;\r\n    _onDemand: boolean;\r\n    _onDemandDelay: number;\r\n    _mapMoveMakeGetParams: makeMapMoveParams;\r\n    _mapMoveParams: any;\r\n    _mapMove: MapMoveCls;\r\n    _projectionMap: ol.proj.Projection;\r\n    _projection4326: ol.proj.Projection;\r\n\r\n\r\n\r\n    /**\r\n     * The base vector layer\r\n     * @param {string} url - pass an empty string to prevent default load and add from a json source\r\n     * @param {object} options - config\r\n     * @param {string} [options.id] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] the z index for the layer\r\n     * @param {function} [options.loadCallback] function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent] additional content to add to the legend\r\n     *\r\n     * @param {boolean} [options.autoLoad=false] if the layer should auto load if not visible\r\n     * @param {object} [options.style=undefined] the layer style, use openlayers default style if not defined\r\n     * @param {boolean} [options.onDemand=false] if the layer should be loaded by extent on map move\r\n     * @param {number} [options.onDemandDelay=300] delay before the map move callback should be called\r\n     * @param {mapMoveMakeGetParams} [options.mapMoveMakeGetParams=function(lyr, extent, zoomLevel){}] function to create additional map move params\r\n     * @param {MapMoveCls} [options.mapMoveObj=mapMove] alternate map move object for use with multi map pages\r\n     *\r\n     */\r\n    constructor(url: string, options: LayerBaseVectorOptions = {}) {\r\n        super(url, options);\r\n\r\n        options = options as LayerBaseVectorOptions;\r\n\r\n        //prevent regular load if no url has been provided\r\n        if (this.url.trim() == '') {\r\n            this._loaded = true;\r\n        }\r\n\r\n        this._style = typeof options.style == 'undefined' ? undefined : options.style;\r\n\r\n        if (this.visible) {\r\n            this._autoLoad = true;\r\n        } else {\r\n            this._autoLoad = (typeof options['autoLoad'] == 'boolean' ? options['autoLoad'] : false);\r\n        }\r\n\r\n        this._onDemand = typeof options.onDemand == 'boolean' ? options.onDemand : false;\r\n        this._onDemandDelay = typeof options.onDemandDelay == 'number' ? options.onDemandDelay : 300;\r\n\r\n        if (options.mapMoveObj) {\r\n            this._mapMove = options.mapMoveObj;\r\n        } else {\r\n            this._mapMove = this._onDemand ? mapMove : undefined;\r\n        }\r\n\r\n\r\n        this._mapMoveMakeGetParams = typeof options.mapMoveMakeGetParams == 'function' ? options.mapMoveMakeGetParams :\r\n            function () {return {};};\r\n\r\n        if (this._onDemand) {\r\n            this._loaded = true;\r\n            this._mapMoveParams = {};\r\n            this._mapMove.checkInit();\r\n            this._mapMove.addVectorLayer(this);\r\n        }\r\n\r\n        this._source = new ol.source.Vector();\r\n\r\n\r\n        this._olLayer = new ol.layer.Vector(\r\n            {\r\n                source: this._source,\r\n                visible: this.visible,\r\n                style: this.style,\r\n                minResolution: this._minResolution,\r\n                maxResolution: this._maxResolution,\r\n                renderOrder: options.renderOrder\r\n            }\r\n        );\r\n\r\n        this.olLayer.setZIndex(this._zIndex);\r\n\r\n        this._projectionMap = null;\r\n        this._projection4326 = new ol.proj.Projection({code: \"EPSG:4326\"});\r\n        this._olLayer.setOpacity(this.opacity)\r\n    }\r\n\r\n    /**\r\n     * dummy to be overridden\r\n     * @param {object} featureCollection - geojson or esrijson object\r\n     */\r\n    addFeatures(featureCollection: Object) {\r\n        console.log('Layer vector base addFeatures is a placeholder and does nothing');\r\n    }\r\n\r\n    /**\r\n     * Before call to map move callback, can prevent call by returning false\r\n     * @param {number} zoom - zoom level\r\n     * @param {string} [evtType=undefined] undefined for initial load, otherwise one of 'change:center', 'change:resolution'\r\n     * @returns {boolean} if the call should proceed\r\n     */\r\n    mapMoveBefore(zoom: number, evtType: string) {\r\n        if (this.minZoom !== undefined) {\r\n            if (zoom < this.minZoom) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        if (this.maxZoom !== undefined) {\r\n            if (zoom > this.maxZoom) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return this.visible;\r\n    }\r\n\r\n    /**\r\n     * callback to generate the parameters passed in the get request\r\n     * @param {object} extent - extent object\r\n     * @param {number} extent.minX - minX\r\n     * @param {number} extent.minY - minY\r\n     * @param {number} extent.maxX - maxX\r\n     * @param {number} extent.maxY - maxY\r\n     * @param {number} zoomLevel - zoom level\r\n     */\r\n    mapMoveMakeGetParams(extent: {minX: number, minY: number, maxX: number, maxY: number}, zoomLevel: number) {\r\n        this._mapMoveParams = {};\r\n        $.extend(this._mapMoveParams, this.params);\r\n        $.extend(this._mapMoveParams, this._mapMoveMakeGetParams(this, extent, zoomLevel));\r\n    }\r\n\r\n    /**\r\n     * callback function on map move\r\n     * @param {object} d - the json response\r\n     */\r\n    mapMoveCallback(d: Object) {\r\n        if (this.source) {\r\n            this._source.clear();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * clear features in the layer\r\n     */\r\n    clear() {\r\n        if (this._source) {\r\n            this._source.clear();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * get on demand delay in miliseconds\r\n     */\r\n    get onDemandDelay(): number {\r\n        return this._onDemandDelay;\r\n    }\r\n\r\n    /**\r\n     * get if the layer is autoloaded\r\n     */\r\n    get autoLoad(): boolean {\r\n        return this._autoLoad;\r\n    }\r\n\r\n    /**\r\n     * get the style definition\r\n     */\r\n    get style(): ol.StyleFunction|Array<ol.style.Style>|ol.style.Style {\r\n        return this._style;\r\n    }\r\n\r\n    /**\r\n     * set the style\r\n     * @param style - the style or function\r\n     */\r\n    set style(style: ol.StyleFunction|Array<ol.style.Style>|ol.style.Style) {\r\n        this._style = style;\r\n        this.olLayer.setStyle(this._style as ol.style.Style);\r\n    }\r\n\r\n    /**\r\n     * get the map CRS if it is defined by the map move object\r\n     */\r\n    get mapCrs(): string {\r\n        return this.mapProj == null ? null : this.mapProj.getCode();\r\n    }\r\n\r\n    get mapProj(): ol.proj.Projection{\r\n        if (this._projectionMap != null){\r\n            return this._projectionMap;\r\n        }\r\n\r\n        if (this._mapMove) {\r\n            this._projectionMap = this._mapMove.map.getView().getProjection();\r\n            return this._projectionMap;\r\n        } else {\r\n            return null;\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * get the map move object\r\n     * @type {MapMoveCls|*}\r\n     */\r\n    get mapMove(): MapMoveCls {\r\n        return this._mapMove;\r\n    }\r\n\r\n    /**\r\n     * map move params\r\n     * @type {object}\r\n     */\r\n    get mapMoveParams() {\r\n        return this._mapMoveParams;\r\n    }\r\n\r\n    get visible(): boolean{\r\n        return this._visible;\r\n    }\r\n\r\n    /**\r\n     * Set the layer visibility\r\n     * @type {boolean}\r\n     * @override\r\n     */\r\n    set visible(visibility) {\r\n        super.setVisible(visibility);\r\n\r\n        if (this._onDemand) {\r\n            this.mapMove.triggerLyrLoad(this);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * get the layer vector source\r\n     * @override\r\n     */\r\n    get source(): ol.source.Vector {\r\n        return this.getSource() as ol.source.Vector;\r\n    }\r\n\r\n    /**\r\n     * array of ol features\r\n     */\r\n    get features(): Array<ol.Feature> {\r\n        return this.source.getFeatures();\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    get olLayer(): ol.layer.Vector {\r\n        return super.getOlLayer() as ol.layer.Vector;\r\n    }\r\n\r\n    protected setZIndex(newZ: number) {\r\n        this.olLayer.setZIndex(newZ);\r\n    }\r\n}\r\n\r\nnm.LayerBaseVector = LayerBaseVector;\r\nexport default LayerBaseVector;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/layers/LayerBaseVector.ts","/**\r\n * Created by gavorhes on 12/16/2015.\r\n */\r\n\r\nimport provide from '../util/provide';\r\nimport makeGuid from '../util/makeGuid';\r\nimport mapMove from '../olHelpers/mapMove';\r\n\r\nlet nm = provide('collections');\r\nimport $ = require('jquery');\r\nimport {LayerBase} from \"../layers\";\r\n\r\nexport interface iLegendItem{\r\n    groupName: string;\r\n    collapse?: boolean;\r\n    addCheck?: boolean;\r\n    items: Array<iLegendItem|LayerBase>\r\n}\r\n\r\nexport interface iLegendOptions{\r\n    layerDivClasses?: string[]\r\n    legendTitle?: string\r\n    scaleDependent?: boolean\r\n}\r\n\r\nclass LayerGroup {\r\n    groupLayers: any;\r\n    groupLayersLookup: any;\r\n    groupGroupsLookup: any;\r\n    groupGroups: any;\r\n    itemIdArray: any;\r\n    groupId: any;\r\n    groupName: any;\r\n    allLayerArray: any;\r\n    parent: any;\r\n    allGroupArray: any;\r\n    allGroupLookup: any;\r\n    allLayerLookup: any;\r\n    collapse: boolean;\r\n    addCheck: boolean;\r\n    layerParentLookup: any;\r\n\r\n    /**\r\n     *\r\n     * @param {object} [groupConfig={}] - group configuration object\r\n     * @param {string} groupConfig.groupName - the group name\r\n     * @param {boolean} [groupConfig.collapse=false] - if the group should be collapsed initially\r\n     * @param {boolean} [groupConfig.addCheck=true] - if the group should have a checkbox controlling visibility of all layers\r\n     * @param {LayerGroup} [parent=undefined] - the parent group\r\n     */\r\n    constructor(groupConfig?: iLegendItem, parent?: LayerGroup) {\r\n        this.groupLayers = [];\r\n        this.groupLayersLookup = {};\r\n        this.groupGroups = [];\r\n        this.groupGroupsLookup = {};\r\n        this.itemIdArray = [];\r\n\r\n        if (typeof groupConfig == 'undefined') {\r\n            this.parent = null;\r\n            this.groupId = 'root';\r\n            this.groupName = 'root';\r\n            this.allGroupLookup = {root: this};\r\n            this.allGroupArray = [this];\r\n            this.allLayerArray = [];\r\n            this.allLayerLookup = {};\r\n            this.layerParentLookup = {};\r\n            this.collapse = false;\r\n            this.addCheck = false;\r\n        } else {\r\n            this.groupId = makeGuid();\r\n            this.parent = parent;\r\n            this.groupName = groupConfig.groupName;\r\n            this.collapse = typeof  groupConfig.collapse == 'boolean' ? groupConfig.collapse : false;\r\n            this.addCheck = typeof  groupConfig.addCheck == 'boolean' ? groupConfig.addCheck : true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {object} groupConfig - configuration object\r\n     * @param {string} groupConfig.groupName - the group name\r\n     * @param {boolean} groupConfig.collapse if the group should be collapsed initially\r\n     * @param {boolean} groupConfig.addCheck if the group should have a checkbox controlling visibility of all layers\r\n     * @param {Array<LayerGroup>} parents parent groups\r\n     * @returns {LayerGroup} the layer group just added\r\n     */\r\n    addGroup(groupConfig: iLegendItem, parents: string[]) {\r\n        let parent;\r\n        if (parents.length > 0) {\r\n            parent = parents[parents.length - 1];\r\n        } else {\r\n            parent = 'root';\r\n        }\r\n\r\n\r\n        /**\r\n         * @type {LayerGroup}\r\n         */\r\n        let parentGroup = this.allGroupLookup[parent];\r\n        let newGroup = new LayerGroup(groupConfig, parentGroup);\r\n        this.allGroupLookup[newGroup.groupId] = newGroup;\r\n        this.allGroupArray.push(newGroup);\r\n\r\n        parentGroup.groupGroups.push(newGroup);\r\n        parentGroup.groupGroupsLookup[newGroup.groupId] = newGroup;\r\n\r\n        if (parentGroup.itemIdArray.indexOf(newGroup.groupId) > 0) {\r\n            console.log(newGroup.groupId);\r\n            throw 'layer and group ids must be unique';\r\n        }\r\n        parentGroup.itemIdArray.push(newGroup.groupId);\r\n\r\n        return newGroup;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {LayerBase} newLayer the layer to be added\r\n     * @param {Array} parents array\r\n     */\r\n    addLegendLayer(newLayer: LayerBase, parents: string[]) {\r\n        let parent;\r\n        if (parents.length > 0) {\r\n            parent = parents[parents.length - 1];\r\n        } else {\r\n            parent = 'root';\r\n        }\r\n\r\n        this.allLayerLookup[newLayer.id] = newLayer;\r\n        this.allLayerArray.push(newLayer);\r\n\r\n        /**\r\n         * @type {LayerGroup}\r\n         */\r\n        let parentGroup = this.allGroupLookup[parent];\r\n\r\n        parentGroup.groupLayers.push(newLayer);\r\n        parentGroup.groupLayersLookup[newLayer.id] = newLayer;\r\n        if (parentGroup.itemIdArray.indexOf(newLayer.id) > 0) {\r\n            console.log(newLayer.id);\r\n            throw 'layer and group ids must be unique';\r\n        }\r\n        parentGroup.itemIdArray.push(newLayer.id);\r\n\r\n        this.layerParentLookup[newLayer.id] = parentGroup;\r\n\r\n    }\r\n\r\n\r\n\r\n    getLegendHtml(legendId: string, options: iLegendOptions) {\r\n\r\n\r\n        let legendHtml = `<ul id=\"${legendId}\" class=\"legend-container\">`;\r\n\r\n        legendHtml += `<li>${options.legendTitle}<input type=\"checkbox\" checked id=\"suppress-by-extent-${legendId}\" class=\"suppress-by-extent\">` +\r\n            `<label title=\"Suppress layers not visible at this zoom level\" for=\"suppress-by-extent-${legendId}\">` +\r\n            `<span></span>` +\r\n            `</label></li>`;\r\n\r\n        legendHtml += this._buildLegend(this.itemIdArray, this, options.layerDivClasses) + '</ul>';\r\n\r\n        return legendHtml;\r\n    }\r\n\r\n    /**\r\n     * @param {Array} itemIds the items to process\r\n     * @param {LayerGroup} theGroup new group\r\n     * @param {Array} [layerDivClasses=[]] optional classes to apply to the layer divs\r\n     * @static\r\n     * @returns {string} html string\r\n     */\r\n    _buildLegend(itemIds: string[], theGroup: LayerGroup, layerDivClasses: string[]): string {\r\n\r\n        if (itemIds.length == 0) {\r\n            return '';\r\n        }\r\n\r\n        let theHml = '';\r\n\r\n        let itemId = itemIds[0];\r\n\r\n        if (theGroup.groupLayersLookup[itemId]) {\r\n\r\n            /**\r\n             * @type {LayerBase}\r\n             */\r\n            let lyr = theGroup.groupLayersLookup[itemId];\r\n            theHml += `<li id=\"${lyr.id}-layer-li\" class=\"legend-layer-li ${layerDivClasses.join(' ')}\">` + lyr.getLegendDiv() + '</li>';\r\n\r\n\r\n        } else if (theGroup.groupGroupsLookup[itemId]) {\r\n            /**\r\n             * type {LayerGroup}\r\n             */\r\n            let otherGroup = theGroup.groupGroupsLookup[itemId];\r\n\r\n            theHml += `<li>`;\r\n            theHml += `<div id=\"${otherGroup.groupId}-legend-layer-div\" ` +\r\n                `class=\"legend-layer-group  ${layerDivClasses.join(' ')}\">`;\r\n\r\n            if (otherGroup.addCheck) {\r\n                theHml += `<input type=\"checkbox\" checked id=\"${otherGroup.groupId}-group-chck\">` +\r\n                    `<label for=\"${otherGroup.groupId}-group-chck\" title=\"Click arrow to expand or collapse\">${otherGroup.groupName}</label>`;\r\n            } else {\r\n                theHml += `<label title=\"Click arrow to expand or collapse\">${otherGroup.groupName}</label>`;\r\n            }\r\n\r\n            theHml += `<span title=\"Expand/Collapse\" class=\"layer-group-expander`;\r\n            theHml += `${otherGroup.collapse ? ' legend-layer-group-initial-collapse' : ''}\">`;\r\n            theHml += otherGroup.collapse ? '&#9654;' : '&#9660;';\r\n            theHml += '</span>';\r\n\r\n            //parents.push(groupId);\r\n            theHml += '<ul>' + this._buildLegend(otherGroup.itemIdArray, otherGroup, layerDivClasses) + '</ul>';\r\n            theHml += '</div>';\r\n            theHml += '</li>';\r\n        }\r\n\r\n        return theHml + this._buildLegend(itemIds.slice(1), theGroup, layerDivClasses);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * a wrapper to make a legend\r\n */\r\nexport class LayerLegend {\r\n\r\n    $divElement: JQuery;\r\n    _legendItems: Array<iLegendItem|LayerBase>;\r\n    layerGroup: any;\r\n    legendId: string;\r\n\r\n    /**``\r\n     *\r\n     * @param {Array} legendItems array of layers or objects with {groupName:  {string}, collapse: {boolean}, addCheck: {boolean}, items: {Array}}\r\n     * @param {string} divId the div where the legend should be added\r\n     * @param {object} options for legend\r\n     * @param {Array} [options.layerDivClasses=[]] optional array of classes to be applied to the layer legend divs for custom styling\r\n     * @param {string} [options.legendTitle=Legend] the legend title\r\n     * @param {boolean} [options.scaleDependent=true] if legend display is scale dependent\r\n     */\r\n    constructor(legendItems: Array<iLegendItem|LayerBase>, divId: string, options: iLegendOptions = {}) {\r\n        for (let i of legendItems) {\r\n            if (typeof i == 'undefined') {\r\n                throw 'undefined item passed in array to legend constructor';\r\n            }\r\n        }\r\n\r\n        options.legendTitle = typeof options.legendTitle == 'string' ? options.legendTitle : 'Legend';\r\n        options.scaleDependent = typeof options.scaleDependent == 'boolean' ? options.scaleDependent : true;\r\n        options.layerDivClasses = options.layerDivClasses || [];\r\n\r\n        // if legend display is scale dependent, make sure the mapMove object is initialized first\r\n        if (options.scaleDependent) {\r\n            mapMove.checkInit();\r\n        }\r\n\r\n        this.$divElement = $('#' + divId);\r\n\r\n        this._legendItems = legendItems;\r\n\r\n        this.layerGroup = new LayerGroup();\r\n\r\n        this._buildTree(legendItems);\r\n\r\n        this.legendId = makeGuid();\r\n\r\n        this.$divElement.append(this.layerGroup.getLegendHtml(this.legendId, options));\r\n\r\n        for (let l of this.layerGroup.allLayerArray){\r\n            l.applyCollapse();\r\n        }\r\n\r\n        let _this = this;\r\n        //// if legend display is scale dependent, make sure the mapMove object is initialized first\r\n        if (options.scaleDependent) {\r\n            mapMove.checkInit();\r\n\r\n            mapMove.addCallback(function (ext, zoom, evt) {\r\n\r\n                if (typeof evt == 'undefined' || evt == 'change:resolution') {\r\n                    for (let lyr of this.layerGroup.allLayerArray) {\r\n                        let $lyrLi = $('#' + lyr.id + '-layer-li');\r\n                        if (zoom > lyr.maxZoom || zoom < lyr.minZoom) {\r\n                            $lyrLi.addClass('layer-not-visible');\r\n                        } else {\r\n                            $lyrLi.removeClass('layer-not-visible');\r\n                        }\r\n                    }\r\n                }\r\n            }, this, 100, true, 'legend1');\r\n        }\r\n\r\n        // <editor-fold desc=\"add event listeners\">\r\n\r\n        this.$divElement.find(\".suppress-by-extent\").change(function () {\r\n            let legendLayerLis = $('.legend-layer-li');\r\n            if (this.checked) {\r\n                legendLayerLis.removeClass('layer-force-show');\r\n            } else {\r\n                legendLayerLis.addClass('layer-force-show');\r\n            }\r\n        });\r\n\r\n        this.$divElement.find('.legend-check').change(function () {\r\n            let lyrId = this.id.replace('-legend-layer-check', '');\r\n            _this.layerGroup.allLayerLookup[lyrId].visible = this.checked;\r\n        });\r\n\r\n        this.$divElement.find('.legend-layer-group > input[type=checkbox]').change(function () {\r\n            $(this).siblings('ul').find('input[type=checkbox]').prop('checked', this.checked).trigger('change');\r\n        });\r\n\r\n        this.$divElement.find('.layer-group-expander').click(function () {\r\n            let $this = $(this);\r\n            $this.removeClass('legend-layer-group-initial-collapse');\r\n\r\n            $this.siblings('ul').slideToggle();\r\n\r\n            if ($this.hasClass('legend-layer-group-collapsed')){\r\n                $this.removeClass('legend-layer-group-collapsed');\r\n                $this.html('&#9660;');\r\n            } else {\r\n                $this.addClass('legend-layer-group-collapsed');\r\n                $this.html('&#9654;');\r\n            }\r\n        });\r\n\r\n        this.$divElement.find('.legend-layer-group-initial-collapse').trigger('click');\r\n        // </editor-fold>\r\n    }\r\n\r\n\r\n    /**\r\n     * @param {Array} [legendItems=this._layerConfig] the legend items\r\n     * @param {Array} [parents=[]] the ordered list of groups in which this item is a member\r\n     * @private\r\n     */\r\n    _buildTree(legendItems: Array<iLegendItem|LayerBase>, parents?: string[]) {\r\n\r\n        if (legendItems.length == 0) {\r\n            return;\r\n        }\r\n\r\n        let oneItem = legendItems[0];\r\n\r\n        //reset the parent if the item is in the base array\r\n        if ((this._legendItems as Array<any>).indexOf(oneItem) > -1 || typeof parents == 'undefined') {\r\n            parents = [];\r\n        }\r\n\r\n        if (typeof (oneItem as iLegendItem).groupName !== 'undefined') {\r\n            let groupItem = legendItems[0];\r\n            let newGroup = this.layerGroup.addGroup(groupItem, parents);\r\n            parents.push(newGroup.groupId);\r\n            this._buildTree((oneItem as iLegendItem).items, parents);\r\n        } else {\r\n            /**\r\n             * @type {LayerBase}\r\n             */\r\n            let layerItem: LayerBase = legendItems[0] as LayerBase;\r\n\r\n            this.layerGroup.addLegendLayer(layerItem, parents);\r\n        }\r\n\r\n        this._buildTree(legendItems.slice(1), parents);\r\n    }\r\n}\r\n\r\nnm.LayerLegend = LayerLegend;\r\nexport default LayerLegend;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/collections/LayerLegend.ts","/**\r\n * Created by gavorhes on 11/2/2015.\r\n */\r\n\r\nimport {LayerBaseVector, LayerBaseVectorOptions} from './LayerBaseVector';\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nimport $ = require('jquery');\r\nimport {MapMoveCls} from \"../olHelpers/mapMoveCls\";\r\nimport * as proj from '../olHelpers/projections';\r\nimport {proj3857} from \"../olHelpers/projections\";\r\n\r\nlet nm = provide('layers');\r\n\r\nexport interface crsTransform {\r\n    dataProjection?: ol.proj.Projection;\r\n    featureProjection?: ol.proj.Projection;\r\n}\r\n\r\n\r\nexport interface LayerBaseVectorGeoJsonOptions extends LayerBaseVectorOptions {\r\n    transform?: crsTransform;\r\n    mapMoveObj?: MapMoveCls;\r\n}\r\n\r\n/**\r\n * The Vector GeoJson Layer\r\n * @augments LayerBaseVector\r\n */\r\nexport class LayerBaseVectorGeoJson extends LayerBaseVector {\r\n    _geoJsonFormat: ol.format.GeoJSON;\r\n    _transform: crsTransform;\r\n\r\n    /**\r\n     * @param {string|null} url - resource url, set to '' to make blank layer\r\n     * @param {object} options - config\r\n     * @param {string} [options.id] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] the z index for the layer\r\n     * @param {function} [options.loadCallback] function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent] additional content to add to the legend\r\n     *\r\n     * @param {boolean} [options.autoLoad=false] if the layer should auto load if not visible\r\n     * @param {object} [options.style=undefined] the layer style, use openlayers default style if not defined\r\n     * @param {boolean} [options.onDemand=false] if the layer should be loaded by extent on map move\r\n     * @param {number} [options.onDemandDelay=300] delay before the map move callback should be called\r\n     *\r\n     * @param {object} [options.transform={}] SR transform, set as false for no transform\r\n     * @param {string} options.transform.dataProjection=EPSG:4326 the data CRS\r\n     * @param {string} options.transform.featureProjection=EPSG:3857 the feature/map CRS\r\n     * @param {mapMoveMakeGetParams} [options.mapMoveMakeGetParams=function(lyr, extent, zoomLevel){}] function to create additional map move params\r\n     * @param {MapMoveCls} [options.mapMoveObj=mapMove] alternate map move object for use with multi map pages\r\n     */\r\n    constructor(url?: string, options: LayerBaseVectorGeoJsonOptions = {}) {\r\n        url = typeof url == 'string' ? url : '';\r\n        super(url, options);\r\n\r\n        this._geoJsonFormat = new ol.format.GeoJSON();\r\n\r\n        this._transform = options.transform || {};\r\n        this._transform.dataProjection = this._transform.dataProjection || proj.proj4326;\r\n        this._transform.featureProjection = this._transform.featureProjection || proj3857;\r\n\r\n        if (this.autoLoad || this.visible) {\r\n            this._load();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * add feature collection\r\n     * @param {object} featureCollection - as geojson object\r\n     */\r\n    addFeatures(featureCollection: any) {\r\n        this.source.addFeatures(\r\n            this._geoJsonFormat.readFeatures(featureCollection,\r\n                {dataProjection: this._transform.dataProjection,\r\n                    featureProjection: this._transform.featureProjection}\r\n                )\r\n        );\r\n    }\r\n\r\n\r\n    /**\r\n     * trigger load features\r\n     * @protected\r\n     * @returns {boolean} if already loaded\r\n     */\r\n    _load() {\r\n\r\n        if (super._load()) {\r\n            return true;\r\n        }\r\n\r\n        $.get(this._url,\r\n            this._params,\r\n            (d) => {\r\n                this.addFeatures(d);\r\n                this.loadCallback(this);\r\n            }, 'json').fail(\r\n            function () {\r\n                this._loaded = false;\r\n            }\r\n        );\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * callback function on map move\r\n     * @param {object} d the json response\r\n     * @override\r\n     */\r\n    mapMoveCallback(d: Object) {\r\n        super.mapMoveCallback(d);\r\n        this._source.addFeatures(this._geoJsonFormat.readFeatures(d,\r\n            {featureProjection: this._transform.featureProjection, dataProjection: this._transform.dataProjection}));\r\n    }\r\n}\r\n\r\nnm.LayerBaseVectorGeoJson = LayerBaseVectorGeoJson;\r\nexport default LayerBaseVectorGeoJson;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/layers/LayerBaseVectorGeoJson.ts","/**\r\n * Created by gavorhes on 12/14/2015.\r\n */\r\n\r\nimport * as colors from '../util/colors';\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nimport LayerItsInventory from \"../layers/LayerItsInventory\";\r\nlet nm = provide('collections');\r\n\r\n\r\nlet itsConfig = [\r\n    {\r\n        name: 'Camera',\r\n        itsType: 'cctv',\r\n        minZoom: 11,\r\n        itsIconConfig: {\r\n            prop: 'owner',\r\n            defaultName: 'WisDOT',\r\n            defaultIcon: 'cctv.png',\r\n            iconArray: [\r\n                ['City of Madison', 'Madison', 'cctv-mad.png']\r\n            ]\r\n        }\r\n    },\r\n    {\r\n        name: 'Message Signs',\r\n        itsType: 'DMS',\r\n        minZoom: 11,\r\n        itsIconConfig: {\r\n            prop: 'dmsType',\r\n            defaultName: 'DMS',\r\n            defaultIcon: 'dms.png',\r\n            iconArray: [\r\n                ['pcms', 'PCMS', 'pcms.png']\r\n            ]\r\n        }\r\n    },\r\n    {name: 'ATR', itsType: 'atr', minZoom: 8, itsIcon: 'atr.png', visible: false},\r\n    {name: 'Lighting', itsType: 'light', minZoom: 16, itsIcon: 'streetlight.png', visible: false, onDemand: true},\r\n    {name: 'Bluetooth', itsType: 'blue', minZoom: 10, itsIcon: 'bluetooth.png', visible: false},\r\n    {name: 'Cabinets', itsType: 'cabinet', minZoom: 10, itsIcon: 'cabinet.png', visible: false},\r\n    {name: 'Hut', itsType: 'hut', minZoom: 10, itsIcon: 'hut.png', visible: false},\r\n    {name: 'Vault', itsType: 'vault', minZoom: 13, itsIcon: 'vault.png', visible: false},\r\n    {name: 'Advisory Radio', itsType: 'har', minZoom: 10, itsIcon: 'har.png', visible: false},\r\n    {\r\n        name: 'Loop Detectors',\r\n        itsType: 'loop',\r\n        legendCollapse: true,\r\n        minZoom: 14,\r\n        visible: false,\r\n        itsIconConfig: {\r\n            prop: 'dtctrType',\r\n            defaultName: 'Other',\r\n            defaultIcon: 'loopdetectorother.png',\r\n            iconArray: [\r\n                ['detector', 'Detector', 'loopdetector.png'],\r\n                ['long', 'Long', 'loopdetectorlong.png'],\r\n                ['zone', 'Zone', 'loopdetectorzone.png']\r\n            ]\r\n        },\r\n        onDemand: true\r\n    },\r\n    {name: 'Microwave', itsType: 'microwave', minZoom: 14, itsIcon: 'microwave.png', visible: false},\r\n    {name: 'Pull Box', itsType: 'pull', minZoom: 14, itsIcon: 'pullbox.png', visible: false, onDemand: true},\r\n    {name: 'RWIS', itsType: 'rwis', minZoom: 7, itsIcon: 'rwis.png', visible: false},\r\n    {name: 'Ramp Gates', itsType: 'gate', minZoom: 10, itsIcon: 'rampgate.png', visible: false},\r\n    {name: 'Ramp Meter', itsType: 'meter', minZoom: 10, itsIcon: 'rampmeter.png', visible: false},\r\n    {name: 'Signal', itsType: 'signal', minZoom: 13, itsIcon: 'signal.png', visible: false, onDemand: true},\r\n    {name: 'Tower', itsType: 'tower', minZoom: 10, itsIcon: 'tower.png', visible: false},\r\n    {\r\n        name: 'Trench',\r\n        itsType: 'trench',\r\n        onDemand: true,\r\n        visible: false,\r\n        onDemandDelay: 500,\r\n        minZoom: 15,\r\n        legendCollapse: true,\r\n        itsLineConfig: {\r\n            prop: 'owner',\r\n            defaultName: 'Other',\r\n            //defaultWidth: 7,\r\n            defaultColor: colors.hexAlphaToRgbOrRgba('#747474', 0.8),\r\n            lineArray: [\r\n                ['WisDOT', 'WisDOT', colors.hexAlphaToRgbOrRgba('#FF032F', 0.7)],\r\n                ['WIN', 'WIN', colors.hexAlphaToRgbOrRgba('#FFC632', 0.7)],\r\n                ['USXchange', 'USXchange', colors.hexAlphaToRgbOrRgba('#2DFF46', 0.7)],\r\n                ['AT&T', 'AT&T', colors.hexAlphaToRgbOrRgba('#ff2be5', 0.7)],\r\n                ['Touch America', 'Touch America', colors.hexAlphaToRgbOrRgba('#52f3ff', 0.7)],\r\n                ['Qwest', 'Qwest', colors.hexAlphaToRgbOrRgba('#9278ff', 0.7)],\r\n                ['McLeodUSA', 'McLeodUSA', colors.hexAlphaToRgbOrRgba('#2926FF', 0.7)],\r\n                ['CINC', 'CINC', colors.hexAlphaToRgbOrRgba('#CB00FF', 0.7)],\r\n                ['City of Madison', 'Madison', colors.hexAlphaToRgbOrRgba('#000380', 0.7)]\r\n            ]\r\n        }\r\n    }\r\n];\r\n\r\n\r\nexport class ItsLayerCollection {\r\n    _map: ol.Map;\r\n    _layers: Array<LayerItsInventory>;\r\n\r\n\r\n    /**\r\n     * Create a collection of all ITS layers\r\n     * @param {ol.Map} theMap the openlayers map\r\n     * @param {Array} [exclude=[]] array of Its layer identifiers to exclude\r\n     *\r\n     * BLUE Bluetooth Detector - Bluetooth Detector\r\n     * CABINET Cabinets - The cabinets\r\n     * CCTV Camera - Traffic Cameras\r\n     * HUT Communication Hut - Communication Hut\r\n     * VAULT Communication Vault - The communication vaults\r\n     * HAR Highway Advisory Radio - Advisory Radios\r\n     * LIGHT Lighting - Lighting\r\n     * LOOP Loop Detectors - Loop Detectors\r\n     * DMS Message Board - Message Boards and Signs\r\n     * MICROWAVE Microwave Detector - Microwave Detectors\r\n     * PULL Pull Box - A pull box\r\n     * RWIS RWIS - Road weather information system\r\n     * GATE Ramp Gate - The ramp Gates\r\n     * METER Ramp Meter - The ramp meters\r\n     * SIGNAL Signal - Traffic Signal\r\n     * TOWER Tower - The towers\r\n     * TRENCH\r\n     */\r\n    constructor(theMap: ol.Map, exclude?: Array<string>) {\r\n\r\n        this._map = theMap;\r\n        this._layers = [];\r\n\r\n        exclude = typeof exclude == 'object' ? exclude : [];\r\n\r\n        for (let i = 0; i < itsConfig.length; i++) {\r\n            let lyrConfig = itsConfig[i];\r\n            let addLayer = true;\r\n\r\n            for (let j = 0; j < exclude.length; j++) {\r\n                if (exclude[j] == lyrConfig.itsType) {\r\n                    addLayer = false;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (addLayer) {\r\n                let inventLyr = new LayerItsInventory(lyrConfig);\r\n                this._map.addLayer(inventLyr.olLayer);\r\n                this._layers.push(inventLyr);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Return the array of layers in this collection\r\n     * @returns {Array<LayerItsInventory>} an array of layers\r\n     */\r\n    get layers(): LayerItsInventory[] {\r\n        return this._layers;\r\n    }\r\n\r\n}\r\n\r\nnm.ItsLayerCollection = ItsLayerCollection;\r\nexport default ItsLayerCollection;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/collections/ItsLayerCollection.ts","/**\r\n * Created by gavorhes on 12/8/2015.\r\n */\r\n\r\nimport {LayerBaseVectorGeoJson, LayerBaseVectorGeoJsonOptions} from './LayerBaseVectorGeoJson';\r\nimport mapPopup from '../olHelpers/mapPopup';\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nimport $ = require('jquery');\r\nimport {proj4326, proj3857} from '../olHelpers/projections'\r\n\r\nlet nm = provide('layers');\r\n\r\n\r\nexport interface iLineStyle {\r\n    color: string;\r\n    width?: number\r\n}\r\n\r\nexport interface iMultiConfig {\r\n    prop: string;\r\n    defaultName: string;\r\n}\r\n\r\nexport interface iIconConfig extends iMultiConfig {\r\n    defaultIcon: string;\r\n    iconArray: string[][]\r\n}\r\n\r\nexport interface iLineConfig extends iMultiConfig {\r\n    defaultColor: string;\r\n    defaultWidth?: number;\r\n    lineArray: any[][]\r\n}\r\n\r\nexport interface iLayerItsInventory extends LayerBaseVectorGeoJsonOptions {\r\n    itsType: string;\r\n    addPopup?: boolean;\r\n    itsIcon?: string;\r\n    itsLineStyle?: iLineStyle;\r\n    itsIconConfig?: iIconConfig;\r\n    itsLineConfig?: iLineConfig\r\n}\r\n\r\n\r\n\r\n\r\nfunction checkStyleNumber(itsIcon: string, itsLineStyle: iLineStyle, itsIconConfig: iIconConfig, itsLineConfig: iLineConfig) {\r\n    \"use strict\";\r\n\r\n    //make sure one and only one configuration is defined;\r\n    let configCount = 0;\r\n    if (typeof itsIcon == 'string') {\r\n        configCount++;\r\n    }\r\n\r\n    if (typeof itsLineStyle == 'object') {\r\n        itsLineStyle.width = typeof itsLineStyle.width == 'number' ? itsLineStyle.width : 5;\r\n        itsLineStyle.color = typeof itsLineStyle.color == 'string' ? itsLineStyle.color : 'red';\r\n        configCount++;\r\n    }\r\n\r\n    if (typeof itsIconConfig == 'object') {\r\n        itsIconConfig.defaultName = itsIconConfig.defaultName || 'Other';\r\n\r\n        if (typeof itsIconConfig.iconArray == 'undefined') {\r\n            itsIconConfig.iconArray = [];\r\n        }\r\n\r\n        configCount++;\r\n    }\r\n\r\n    if (typeof itsLineConfig == 'object') {\r\n        itsLineConfig.defaultName = itsLineConfig.defaultName || 'Other';\r\n        itsLineConfig.defaultWidth = itsLineConfig.defaultWidth || 5;\r\n        itsLineConfig.defaultColor = itsLineConfig.defaultColor || 'red';\r\n\r\n\r\n        if (typeof itsLineConfig.lineArray == 'undefined') {\r\n            itsLineConfig.lineArray = [];\r\n        }\r\n\r\n        // set the width if not defined\r\n        for (let i = 0; i < itsLineConfig.lineArray.length; i++) {\r\n            if (itsLineConfig.lineArray[i].length == 3) {\r\n                itsLineConfig.lineArray[i].push(5);\r\n            }\r\n        }\r\n\r\n        configCount++;\r\n    }\r\n\r\n    if (configCount > 1) {\r\n        throw 'Only one style config can be defined';\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n * @param {string} [itsIcon=undefined] the ITS device type icon image see https://transportal.cee.wisc.edu/its/inventory/icons/\r\n *\r\n * @param {object} [itsLineStyle=undefined] A single line style\r\n * @param {string} itsLineStyle.color the line color as rgb or hex\r\n * @param {number} [itsLineStyle.width=5] the line width\r\n *\r\n * @param {object} [itsIconConfig=undefined] The icon subtype configuration\r\n * @param {string} itsIconConfig.prop The property used to define icon attribute symbolization\r\n * @param {string} itsIconConfig.defaultName The default name to be used if no other match is found\r\n * @param {string} itsIconConfig.defaultIcon The default icon to be used for no other matches\r\n * @param {object} [itsIconConfig.iconArray=[]] an array, items with format [property, name, img]\r\n *\r\n * @param {object} [itsLineConfig=undefined] The property used to define icon attribute symbolization\r\n * @param {string} itsLineConfig.prop The property used to define icon attribute symbolization\r\n * @param {string} [itsLineConfig.defaultName=Other] The default name to be used if no other match is found\r\n * @param {string} [itsLineConfig.defaultColor=red] The default line color to be used for no other matches\r\n * @param {number} [itsLineConfig.defaultWidth=5] The default line width to be used for no other matches\r\n * @param {object} [itsLineConfig.lineArray=[]] an array, items with format [property, name, color, optional width]\r\n * @returns {*} undefined, style, or style function\r\n */\r\nfunction defineStyle(itsIcon: string, itsLineStyle: iLineStyle, itsIconConfig: iIconConfig, itsLineConfig: iLineConfig): ol.style.Style | Array<ol.style.Style> | ol.StyleFunction {\r\n    \"use strict\";\r\n    checkStyleNumber(itsIcon, itsLineStyle, itsIconConfig, itsLineConfig);\r\n\r\n    let _iconUrlRoot = 'https://transportal.cee.wisc.edu/its/inventory/icons/';\r\n\r\n    if (itsIcon) {\r\n        return new ol.style.Style({\r\n            image: new ol.style.Icon(\r\n                {\r\n                    src: _iconUrlRoot + itsIcon,\r\n                    crossOrigin: 'anonymous'\r\n                }\r\n            )\r\n        });\r\n    } else if (itsLineStyle) {\r\n        return new ol.style.Style({\r\n            stroke: new ol.style.Stroke({\r\n                color: itsLineStyle.color,\r\n                width: itsLineStyle.width\r\n            })\r\n        });\r\n    } else if (itsIconConfig) {\r\n        return function (feature: ol.Feature) {\r\n            let symbolProp = feature.getProperties()[itsIconConfig.prop];\r\n            let iconUrl = _iconUrlRoot + itsIconConfig.defaultIcon;\r\n\r\n            for (let i = 0; i < itsIconConfig.iconArray.length; i++) {\r\n                let thisProp = itsIconConfig.iconArray[i];\r\n\r\n                if (symbolProp.trim().toLocaleLowerCase() == thisProp[0].trim().toLocaleLowerCase()) {\r\n                    iconUrl = _iconUrlRoot + thisProp[2];\r\n                    break;\r\n                }\r\n            }\r\n\r\n            return [new ol.style.Style({\r\n                image: new ol.style.Icon(\r\n                    {\r\n                        src: iconUrl,\r\n                        crossOrigin: 'anonymous'\r\n                    }\r\n                )\r\n            })];\r\n        };\r\n    } else if (itsLineConfig) {\r\n        return function (feature: ol.Feature) {\r\n            let symbolProp = feature.getProperties()[itsLineConfig.prop];\r\n            let colr = itsLineConfig.defaultColor || 'red';\r\n            let width = itsLineConfig.defaultWidth || 5;\r\n\r\n            for (let i = 0; i < itsLineConfig.lineArray.length; i++) {\r\n                let thisProp = itsLineConfig.lineArray[i];\r\n\r\n                if (symbolProp.trim().toLocaleLowerCase() == thisProp[0].trim().toLocaleLowerCase()) {\r\n                    colr = thisProp[2];\r\n                    width = thisProp[3];\r\n                    break;\r\n                }\r\n            }\r\n\r\n            return [new ol.style.Style({\r\n                stroke: new ol.style.Stroke({\r\n                    color: colr,\r\n                    width: width\r\n                })\r\n            })];\r\n        };\r\n    } else {\r\n        return undefined;\r\n    }\r\n}\r\n\r\nfunction defineLegend(itsIcon: string, itsLineStyle: iLineStyle, itsIconConfig: iIconConfig, itsLineConfig: iLineConfig) {\r\n    \"use strict\";\r\n\r\n    let iconHeight = 17;\r\n\r\n    checkStyleNumber(itsIcon, itsLineStyle, itsIconConfig, itsLineConfig);\r\n\r\n    let _iconUrlRoot = 'https://transportal.cee.wisc.edu/its/inventory/icons/';\r\n\r\n    if (itsIcon) {\r\n        return `<img src=\"${_iconUrlRoot + itsIcon}\" class=\"legend-layer-icon\" height=\"${iconHeight}\">`;\r\n    } else if (itsLineStyle) {\r\n        return `<hr style=\"height: ${itsLineStyle.width}px; background-color: ${itsLineStyle.color}\">`;\r\n    } else if (itsIconConfig) {\r\n        let outHtml = '';\r\n        outHtml += '<ul>';\r\n\r\n        for (let a of itsIconConfig.iconArray) {\r\n            outHtml += `<li><span class=\"legend-layer-subitem\">${a[1]}</span><img src=\"${_iconUrlRoot + a[2]}\" class=\"legend-layer-icon\" height=\"${iconHeight}\">`;\r\n        }\r\n\r\n        outHtml += `<li><span class=\"legend-layer-subitem\">${itsIconConfig.defaultName}</span>` +\r\n            `<img src=\"${_iconUrlRoot + itsIconConfig.defaultIcon}\" class=\"legend-layer-icon\" height=\"${iconHeight}\"></li>`;\r\n\r\n        outHtml += '</ul>';\r\n\r\n        return outHtml;\r\n    } else if (itsLineConfig) {\r\n        let outHtml = '';\r\n        outHtml += '<ul>';\r\n        for (let ls of itsLineConfig.lineArray) {\r\n            outHtml += `<li><span class=\"legend-layer-subitem\">${ls[1]}</span>` +\r\n                `<hr style=\"height: ${ls[3]}px; background-color: ${ls[2]}\">`;\r\n        }\r\n        outHtml += `<li><span class=\"legend-layer-subitem\">${itsLineConfig.defaultName}</span>` +\r\n            `<hr style=\"height: ${itsLineConfig.defaultWidth}px; background-color: ${itsLineConfig.defaultColor}\"></li>`;\r\n        outHtml += '</ul>';\r\n\r\n        return outHtml;\r\n    } else {\r\n        return '';\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Its Layer class\r\n * @augments LayerBaseVectorGeoJson\r\n */\r\nexport class LayerItsInventory extends LayerBaseVectorGeoJson {\r\n\r\n    /**\r\n     * ITS device layer, types available at https://transportal.cee.wisc.edu/its/inventory/\r\n     * @param {object} options - config\r\n     * @param {string} [options.id] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] the z index for the layer\r\n     * @param {function} [options.loadCallback] function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent] additional content to add to the legend\r\n     *\r\n     * @param {boolean} [options.autoLoad=false] if the layer should auto load if not visible\r\n     * @param {object|*} [options.style=undefined] the layer style, use openlayers default style if not defined\r\n     * @param {boolean} [options.onDemand=false] if the layer should be loaded by extent on map move\r\n     * @param {number} [options.onDemandDelay=300] delay before the map move callback should be called\r\n     * @param {MapMoveCls} [options.mapMoveObj=mapMove] alternate map move object for use with multi map pages\r\n     *\r\n     * @param {string} options.itsType the ITS device type, use the url flag at https://transportal.cee.wisc.edu/its/inventory/\r\n     * @param {boolean} [options.addPopup=true] if the popup should be added automatically\r\n     *\r\n     * @param {string} [options.itsIcon=undefined] the ITS device type icon image see https://transportal.cee.wisc.edu/its/inventory/icons/\r\n     *\r\n     * @param {object} [options.itsLineStyle=undefined] A single line style\r\n     * @param {string} options.itsLineStyle.color the line color as rgb or hex\r\n     * @param {number} [options.itsLineStyle.width=5] the line width\r\n     *\r\n     * @param {object} [options.itsIconConfig=undefined] The icon subtype configuration\r\n     * @param {string} options.itsIconConfig.prop The property used to define icon attribute symbolization\r\n     * @param {string} options.itsIconConfig.defaultName The default name to be used if no other match is found\r\n     * @param {string} options.itsIconConfig.defaultIcon The default icon to be used for no other matches\r\n     * @param {object} [options.itsIconConfig.iconArray=[]] an array, items with format [property, name, img]\r\n     *\r\n     * @param {object} [options.itsLineConfig=undefined] The property used to define icon attribute symbolization\r\n     * @param {string} options.itsLineConfig.prop The property used to define icon attribute symbolization\r\n     * @param {string} [options.itsLineConfig.defaultName=Other] The default name to be used if no other match is found\r\n     * @param {string} [options.itsLineConfig.defaultColor=red] The default line color to be used for no other matches\r\n     * @param {number} [options.itsLineConfig.defaultWidth] The default line width to be used for no other matches\r\n     * @param {object} [options.itsLineConfig.lineArray=[]] an array, items with format [property, name, color, optional width = 5]\r\n     */\r\n    constructor(options: iLayerItsInventory) {\r\n        if (typeof options.itsType !== 'string') {\r\n            throw 'its type must be defined';\r\n        }\r\n\r\n        options.transform = {dataProjection: proj4326, featureProjection: proj3857};\r\n\r\n        let addToLegend = '';\r\n\r\n        // define a style with the helper function if it is not explicitly defined\r\n        if (typeof options.style == 'undefined') {\r\n            options.style = defineStyle(\r\n                options.itsIcon, options.itsLineStyle, options.itsIconConfig, options.itsLineConfig\r\n            );\r\n            addToLegend = defineLegend(\r\n                options.itsIcon, options.itsLineStyle, options.itsIconConfig, options.itsLineConfig\r\n            );\r\n        }\r\n\r\n        options.params = typeof options.params == 'object' ? options.params : {};\r\n        $.extend(options.params, {format: 'JSON', resource: options.itsType});\r\n\r\n        super('https://transportal.cee.wisc.edu/its/inventory/', options);\r\n\r\n        //add any additional content to the legend\r\n        this.addLegendContent(addToLegend);\r\n\r\n        options.addPopup = typeof options.addPopup == 'boolean' ? options.addPopup : true;\r\n\r\n        if (options.addPopup) {\r\n            mapPopup.addVectorPopup(this, function (props: { featureGuid: string }) {\r\n                return `<iframe src=\"https://transportal.cee.wisc.edu/its/inventory/?feature=${props.featureGuid}\" ` +\r\n                    `height=\"250\" width=\"350\"></iframe>`;\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * callback to generate the parameters passed in the get request\r\n     * @callback makeGetParams\r\n     * @param {object} extent - extent object\r\n     * @param {number} extent.minX - minX\r\n     * @param {number} extent.minY - minY\r\n     * @param {number} extent.maxX - maxX\r\n     * @param {number} extent.maxY - maxY\r\n     * @param {number} zoomLevel - zoom level\r\n     */\r\n    mapMoveMakeGetParams(extent: { minX: number, minY: number, maxX: number, maxY: number }, zoomLevel: number) {\r\n        super.mapMoveMakeGetParams(extent, zoomLevel);\r\n        let lowerLeft = new ol.geom.Point([extent.minX, extent.minY]);\r\n        lowerLeft.transform(this.mapProj, this._projection4326);\r\n        let lowerLeftCoordinates = lowerLeft.getCoordinates();\r\n        let upperRight = new ol.geom.Point([extent.maxX, extent.maxY]);\r\n        upperRight.transform(this.mapProj, this._projection4326);\r\n        let upperRightCoordinates = upperRight.getCoordinates();\r\n\r\n        $.extend(this.mapMoveParams,\r\n            {\r\n                L: lowerLeftCoordinates[0],\r\n                R: upperRightCoordinates[0],\r\n                B: lowerLeftCoordinates[1],\r\n                T: upperRightCoordinates[1]\r\n            });\r\n    }\r\n}\r\n\r\nnm.LayerItsInventory = LayerItsInventory;\r\nexport default LayerItsInventory;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/layers/LayerItsInventory.ts","/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\nimport provide from './provide';\r\nimport * as chk from './checkDefined';\r\n\r\nlet nm = provide('util.colors');\r\n\r\n\r\n/**\r\n * helper function to convert to hex\r\n * @param {number|string} x - the number to convert to hex\r\n * @returns {string} number as hex\r\n * @private\r\n */\r\nfunction _hex(x: number|string): string {\r\n    let hexDigits = [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f\"];\r\n\r\n    if (isNaN(x as number)){\r\n        return \"00\";\r\n    } else {\r\n        let m = x as number;\r\n        return hexDigits[(m - m % 16) / 16] + hexDigits[m % 16];\r\n    }\r\n    // return isNaN(x as number) ? \"00\" : hexDigits[(x - x % 16) / 16] + hexDigits[x % 16];\r\n}\r\n\r\n/**\r\n * converts an RGB string to hex\r\n * @param {string} rgb - rgb color\r\n * @returns {string} rbg as hex\r\n */\r\nexport function rgb2hex(rgb: string): string {\r\n    let rgb1 = rgb.match(/^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)$/);\r\n\r\n    return (\"#\" + _hex(rgb1[1]) + _hex(rgb1[2]) + _hex(rgb1[3])).toUpperCase();\r\n}\r\n\r\nnm.rgb2hex = rgb2hex;\r\n\r\n\r\n/**\r\n * Convert hex string to RGB or RGBA string\r\n * @param {string} hexString - hex color string\r\n * @param {number} [alphaVal=undefined] Alpha value\r\n * @returns {string} - rgb or rgba color\r\n */\r\nexport function hexAlphaToRgbOrRgba(hexString: string, alphaVal: number): string {\r\n    hexString = ((hexString.charAt(0) == \"#\") ? hexString.substring(1, 7) : hexString);\r\n    let r = parseInt(hexString.substring(0, 2), 16).toString() || '0';\r\n    let g = parseInt(hexString.substring(2, 4), 16).toString() || '0';\r\n    let b = parseInt(hexString.substring(4, 6), 16).toString() || '0';\r\n    if (alphaVal) {\r\n        return `rgba(${r},${g},${b},${alphaVal})`;\r\n    } else {\r\n        return `rgba(${r},${g},${b})`;\r\n    }\r\n}\r\n\r\nnm.hexAlphaToRgbOrRgba = hexAlphaToRgbOrRgba;\r\n\r\n\r\n/**\r\n * adds alpha value to rgb string 'rgb(r, b, g)', returns 'rgba(r, g, b, a)'\r\n * @param {string} rgb - rgb color\r\n * @param {number} alpha - alpha value 0 to 1\r\n * @returns {string} rgba color\r\n */\r\nexport function rgbToRgba(rgb: string, alpha: number): string {\r\n    let pieces = rgb.split(',');\r\n    pieces[0] = pieces[0].replace('rgb', 'rgba');\r\n    pieces[2] = pieces[2].replace(')', '');\r\n    pieces.push(' ' + alpha.toFixed(1) + ')');\r\n\r\n    return pieces.join(',');\r\n}\r\n\r\nnm.rgbToRgba = rgbToRgba;\r\n\r\n\r\n/**\r\n * @typedef {function} colorLookupByNumber\r\n * @param {number} num - the number to use to retrieve the color\r\n * @returns {string} rgb color\r\n */\r\n\r\n\r\n/**\r\n * Make a blue green red gradient\r\n * @param {number} minVal - minimum value\r\n * @param {number} maxVal - maximum value\r\n * @param {boolean} flipColors - if the colors should be flipped\r\n * @returns {colorLookupByNumber} color lookup function\r\n */\r\nexport function makeBlueGreenRedGradient(minVal: number, maxVal: number, flipColors:boolean=false): (v: number) => string {\r\n\r\n    if (typeof flipColors != \"boolean\") {\r\n        flipColors = false;\r\n    }\r\n\r\n    return function (theVal: number): string {\r\n        let r, g, b;\r\n        let ratio;\r\n\r\n        if (chk.undefinedOrNull(theVal)) {\r\n            return 'rgb(100,100,100)';\r\n        }\r\n\r\n        let percent = (theVal - minVal) / (maxVal - minVal);\r\n\r\n        if (flipColors == true) {\r\n            percent = 1 - percent;\r\n        }\r\n\r\n        if (percent >= 1) {\r\n            r = 255;\r\n            g = 0;\r\n            b = 0;\r\n        } else if (percent <= 0) {\r\n            r = 0;\r\n            g = 0;\r\n            b = 255;\r\n        } else if (percent < .25) {\r\n            // green up, blue constant\r\n            r = 0;\r\n            g = Math.floor(255 * percent / 0.25);\r\n            b = 255;\r\n        } else if (percent < 0.50) {\r\n            //blue down, green constant\r\n            ratio = (percent - 0.25) / 0.25;\r\n            r = 0;\r\n            g = 255;\r\n            b = 255 - Math.floor(255 * ratio);\r\n        } else if (percent < 0.75) {\r\n            // red up, green constant\r\n            ratio = (percent - 0.5) / 0.25;\r\n            r = Math.floor(255 * ratio);\r\n            g = 255;\r\n            b = 0;\r\n        } else {\r\n            // green down, red constant\r\n            ratio = (percent - 0.75) / 0.25;\r\n            r = 255;\r\n            g = 255 - Math.floor(255 * ratio);\r\n            b = 0;\r\n        }\r\n\r\n        r = r.toFixed();\r\n        g = g.toFixed();\r\n        b = b.toFixed();\r\n\r\n        return 'rgb(' + r + ',' + g + ',' + b + ')';\r\n    };\r\n}\r\n\r\nnm.makeBlueGreenRedGradient = makeBlueGreenRedGradient;\r\n\r\n\r\n/**\r\n * Create a function that will return colors based on a gradient\r\n * @param {number} median - median value\r\n * @param {number} stdDev - standard deviation\r\n * @param {boolean} flipColors - if the colors should be flipped\r\n * @returns {colorLookupByNumber} color lookup function\r\n */\r\nexport function makeBlueGreenRedGradientZScore(median: number, stdDev: number, flipColors: boolean = false):(v: number) => string {\r\n\r\n    let grd = makeBlueGreenRedGradient(-2.5, 2.5, flipColors);\r\n\r\n    return function (theVal: number): string {\r\n\r\n        let zScore;\r\n        if (theVal == null) {\r\n            zScore = null;\r\n        } else {\r\n            zScore = (theVal - median) / stdDev;\r\n        }\r\n\r\n        return grd(zScore);\r\n    };\r\n}\r\n\r\nnm.makeBlueGreenRedGradientZScore = makeBlueGreenRedGradientZScore;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/colors.ts","/**\r\n * Created by gavorhes on 12/18/2015.\r\n */\r\n\r\n\r\nimport ItsLayerCollection from '../../collections/ItsLayerCollection';\r\nimport LayerLegend from '../../collections/LayerLegend';\r\nimport quickMap from '../../olHelpers/quickMap';\r\n\r\nlet map = quickMap({addGeocode: true});\r\n\r\n\r\nwindow['map'] = map;\r\n\r\nlet itsLayerCollection = new ItsLayerCollection(map);\r\n\r\nlet layerArray = [\r\n    {\r\n        groupName: 'ITS Inventory Layers',\r\n        collapse: false,\r\n        addCheck: true,\r\n        items: itsLayerCollection.layers\r\n    }\r\n];\r\n\r\nlet legend = new LayerLegend(layerArray, 'legend-container', {});\r\n\r\nconsole.log('it works');\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/_tests/demos/itsMap.ts"],"sourceRoot":""}