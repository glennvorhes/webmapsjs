{"version":3,"sources":["webpack:///animate.js","webpack:///webpack/bootstrap 95f473b09da6d84b9b8b","webpack:///../../src/util/provide.ts","webpack:///external \"$\"","webpack:///external \"ol\"","webpack:///../../src/util/makeGuid.ts","webpack:///../../src/olHelpers/mapPopup.ts","webpack:///../../src/olHelpers/mapInteractionBase.ts","webpack:///../../src/olHelpers/mapMove.ts","webpack:///../../src/olHelpers/quickMap.ts","webpack:///../../src/layers/LayerBase.ts","webpack:///../../src/util/checkDefined.ts","webpack:///../../src/layers/LayerEsriMapServer.ts","webpack:///../../src/olHelpers/mapMoveCls.ts","webpack:///../../src/olHelpers/mapPopupCls.ts","webpack:///../../src/olHelpers/quickMapBase.ts","webpack:///../../src/olHelpers/zoomResolutionConvert.ts","webpack:///external \"jquery-ui\"","webpack:///../../src/olHelpers/esriToOlStyle.ts","webpack:///../../src/domUtil/media-control.ts","webpack:///../../src/domUtil/range-change.ts","webpack:///../../src/layers/LayerBaseVector.ts","webpack:///../../src/layers/LayerBaseVectorEsri.ts","webpack:///../../src/layers/LayerRealEarthTile.ts","webpack:///../../src/layers/LayerBaseXyzTile.ts","webpack:///../../src/mixin/RealEarthAnimate.ts","webpack:///../../src/mixin/RealEarthAnimateTile.ts","webpack:///../../src/_test/animate.ts"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","provide","namespace","window","parts","split","nameSpace","length","util","default","$","ol","makeGuid","replace","r","Math","random","toString","mapPopupCls_1","mapPopup","provide_1","nm","MapInteractionBase","subtype","this","_map","_initialized","_subtype","init","theMap","_checkInit","initialized","msg","alert","console","log","checkInit","mapMoveCls_1","mapMove","quickMap","options","quickMapBase_1","quickMapBase","mapMove_1","mapPopup_1","zoomResolutionConvert","makeGuid_1","LayerBase","url","_url","_params","params","_legendCollapse","legendCollapse","_legendCheckbox","legendCheckbox","id","_name","animate","_opacity","opacity","_visible","visible","_source","undefined","_olLayer","_loaded","_maxResolution","zoomToResolution","minZoom","_minResolution","maxZoom","_minZoom","_maxZoom","_zIndex","zIndex","loadCallback","_legendContent","_$legendDiv","_applyCollapseCalled","_addLegendContent","legendContent","_load","loaded","getLegendDiv","additionalContent","indexOf","append","applyCollapse","addLegendContent","$expander","find","click","$this","siblings","slideToggle","hasClass","removeClass","html","addClass","trigger","refresh","source","_id","set","newId","_animate","newVal","newParams","visibility","setVisible","olLayer","setOpacity","newName","getSource","newZ","setZIndex","getOlLayer","undefinedOrNull","input","definedAndNotNull","__extends","extendStatics","setPrototypeOf","__proto__","Array","b","__","constructor","create","LayerBase_1","esriToOl","LayerEsriMapServer","_super","_this","TileArcGISRest","showLayers","layers","join","layer","Tile","minResolution","maxResolution","addPopup","_esriFormat","format","EsriJSON","_popupRequest","addMapServicePopup","urlCopy","newHtml","makeMapServiceLegend","getPopupInfo","queryParams","__this","abort","_i","_a","popupHtml","a","attrVal","toLowerCase","attr","slice","addMapServicePopupContent","readFeature","always","mapInteractionBase_1","checkDefined","MapMoveCls","_arrLyrRequest","_arrLyrTimeout","_arrLayer","_lookupLayer","_mapMoveCallbacks","_mapMoveCallbacksLookup","_mapMoveCallbackDelays","_mapMoveCallbackContext","_mapMoveCallbackTimeout","_mapExtent","_zoomLevel","map","getView","on","e","_updateMapExtent","triggerLyrLoad","type","triggerMoveCallback","theView","getZoom","extentArray","calculateExtent","getSize","minX","minY","maxX","maxY","lyr","index","eventType","clearTimeout","callbackFunc","mapMoveBefore","mapMoveMakeGetParams","__this_1","innerFunction","theLayer","theIndex","_innerThis","mapMoveParams","mapMoveCallback","fail","jqXHR","statusText","clear","setTimeout","onDemandDelay","ind","functionId","ctx","theFunc","f","addVectorLayer","triggerOnAdd","push","addCallback","func","context","delay","FeatureLayerProperties","feature","layerIndex","selectionLayer","esriLayerName","popupContent","MapPopupCls","_arrPopupLayerIds","_arrPopupLayerNames","_arrPopupLayers","_arrPopupOlLayers","_arrPopupContentFunction","_$popupContainer","_$popupContent","_$popupCloser","_popupOverlay","_selectionLayers","_selectionLayerLookup","_mapClickFunctions","_popupChangedFunctions","_esriMapServiceLayers","_popupOpen","_popupCoordinate","_passThroughLayerFeatureArray","_currentPopupIndex","_popupContentLength","$map","target","getTarget","_ease","easing","inAndOut","Overlay","element","autoPan","autoPanAnimation","duration","getCenter","addOverlay","evt","closePopup","geometry","geometryType","sr","getProjection","getCode","mapExtent","imageDisplay","returnGeometry","tolerance","layerFeatureObjectArray","_featuresAtPixel","featObj","props","getProperties","popupContentResponse","addFeature","_triggerFeatSelect","nextPopup","setPosition","scrollTop","pixel","getEventPixel","hit","hasFeatureAtPixel","lyrCandidate","getTargetElement","style","cursor","$currentPopupItemNumber","$innerPopup","$layerNameSpan","clearSelection","lyrFeatObj","toFixed","layerName","esriName","featLayerObject","forEachFeatureAtPixel","lyrIndex","blur","addPopupChangedFunction","chgFunction","_addPopupLayer","selectionStyle","color","width","theStyle","olStyle","Style","stroke","Stroke","image","Circle","radius","fill","Fill","Vector","addLayer","addVectorPopup","popupContentFunction","removeVectorPopup","idx","splice","addMapClickFunction","divId","center","x","y","zoom","baseSwitcher","fullScreen","css","osmLayer","OSM","geom","Point","proj","Projection","code","transform","coordinates","getCoordinates","controls","control","defaults","attributionOptions","collapsible","view","View","Map","addControl","FullScreen","zoomLevel","_zoomResLookup","resolutionToZoom","resolution","jquery","ui","_colorArrayToRgba","colorArray","htmlEscape","str","String","makeFeatureServiceLegendAndSymbol","esriResponse","renderer","drawingInfo","symbolLegendOut","SingleSymbol","PointSymbol","LineSymbol","PolygonSymbol","UniqueValueSymbol","legend","legendHtml","mapServiceLegendItem","lyrObject","skipLayerNameAndExpander","legendItems","newLegendHtml","CommonSymbol","symbolObj","innerColor","outerColor","outline","outlineWidth","size","Icon","src","lineWidth","SymbolGenerator","SymbolClass","symbol","uniqueValueInfos","propertyName","defaultSymbol","defaultStyle","defaultLabelHtml","valueArray","labelArray","legendArray","propertyStyleLookup","uniqueVal","uniqueSym","checkProperties","checkProperty","_b","_c","h","timeToLocalDateString","tm","Date","p1","toLocaleTimeString","p2","toLocaleDateString","range_change_1","MediaControl","changeFunc","mediaConfig","min","max","val","step","playInterval","showAsDate","_container","_playInterval","_changeFunc","_showAsDate","_currentValue","_min","_max","_step","_playing","btnPlay","_$btnStop","btnAhead","btnBack","_$slider","_$valLabelMin","_$valLabelVal","_$valLabelMax","setMinMaxValueStep","rangeChange","currentValue","___this","prop","_interval","setInterval","clearInterval","stopPlaying","newValue","newMin","newMax","newStep","newFunc","triggerCallback","callback","parseFloat","percent","lastVal","$slider","changeTimeout","mouseenter","mouseIn","mouseleave","mouseDown","mousedown","mouseup","mousemove","dragged","timeout","keyup","keyCode","change","LayerBaseVector","trim","_style","_autoLoad","_onDemand","onDemand","_onDemandDelay","mapMoveObj","_mapMove","_mapMoveMakeGetParams","_mapMoveParams","renderOrder","_projectionMap","_projection4326","addFeatures","featureCollection","evtType","extent","extend","setStyle","mapProj","getFeatures","LayerBaseVector_1","LayerBaseVectorEsri","where","outFields","outSR","_outSR","_urlCopy","autoLoad","_useEsriStyle","useEsriStyle","newStyleAndLegend","feats","readFeatures","LayerBaseXyzTile_1","RealEarthAnimateTile_1","LayerRealEarthTile","_products","products","animator","timeLoadCallback","timeInit","setLayerTime","theTime","LayerBaseXyzTile","XYZ","offsetMinutes","getTimezoneOffset","RealEarthAnimate","_rawDateStrings","_localDates","localTimes","_animateEnabled","_currentTime","_currentIndex","_loadDates","_loadLatest","inString","yr","month","hr","mn","sec","rawDateStr","dteStr","newDte","setMinutes","getMinutes","getTime","newIndex","RealEarthAnimate_1","RealEarthAnimateTile","_sourceUrls","rawDte","dteProductUrl","setUrl","getZIndex","quickMap_1","LayerRealEarthTile_1","media_control_1","LayerBaseVectorEsri_1","LayerEsriMapServer_1","nexrhresStatic","endTime","setHours","getHours","startTime","rangeStep","round","v","coordinationLayer","oakRidgeLayers","oakRidgeLayer"],"mappings":"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","file":"animate.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 34);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 12/10/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * create a namespace on the gv object\r\n * @param {string} namespace to create\r\n * @returns {object} object representing the namespace\r\n */\r\nfunction provide(namespace) {\r\n    \"use strict\";\r\n    if (typeof window['gv'] == 'undefined') {\r\n        window['gv'] = {};\r\n    }\r\n    var parts = namespace.split('.');\r\n    var nameSpace = window['gv'];\r\n    for (var i = 0; i < parts.length; i++) {\r\n        var newObject = nameSpace[parts[i]];\r\n        if (typeof newObject == 'undefined') {\r\n            nameSpace[parts[i]] = {};\r\n        }\r\n        nameSpace = nameSpace[parts[i]];\r\n    }\r\n    return nameSpace;\r\n}\r\nprovide('util');\r\nwindow['gv'].util.provide = provide;\r\nexports.default = provide;\r\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\nmodule.exports = $;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\nmodule.exports = ol;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar provide_1 = __webpack_require__(0);\r\nvar nm = provide_1.default('util');\r\n/**\r\n * guids are used to uniquely identify groups and features\r\n * @returns {string} a new guid\r\n */\r\nfunction makeGuid() {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'\r\n        .replace(/[xy]/g, function (c) {\r\n        var r = Math.random() * 16 | 0, v = c == 'x' ? r : r & 0x3 | 0x8;\r\n        return v.toString(16);\r\n    });\r\n}\r\nnm.makeGuid = makeGuid;\r\nexports.default = makeGuid;\r\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar mapPopupCls_1 = __webpack_require__(12);\r\n/**\r\n * The single popup object catch is that it is common to multimap pages\r\n * @type {MapPopupCls}\r\n */\r\nexports.mapPopup = new mapPopupCls_1.default();\r\nexports.default = exports.mapPopup;\r\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Created by gavorhes on 12/8/2015.\r\n */\r\nvar provide_1 = __webpack_require__(0);\r\nvar nm = provide_1.default('olHelpers');\r\n/**\r\n * base interaction\r\n */\r\nvar MapInteractionBase = (function () {\r\n    /**\r\n     * map interaction base\r\n     * @param subtype - the interaction subtype\r\n     */\r\n    function MapInteractionBase(subtype) {\r\n        this._map = null;\r\n        this._initialized = false;\r\n        this._subtype = subtype;\r\n    }\r\n    /**\r\n     * base initializer, returns true for already initialized\r\n     * @param theMap - the ol Map\r\n     * @returns true for already initialized\r\n     */\r\n    MapInteractionBase.prototype.init = function (theMap) {\r\n        if (!this._initialized) {\r\n            this._map = theMap;\r\n            this._initialized = true;\r\n        }\r\n    };\r\n    Object.defineProperty(MapInteractionBase.prototype, \"map\", {\r\n        /**\r\n         * get reference to the ol map object\r\n         * @returns {ol.Map} the map object\r\n         */\r\n        get: function () {\r\n            return this._map;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MapInteractionBase.prototype, \"initialized\", {\r\n        /**\r\n         * get if is initialized\r\n         * @returns {boolean} is initialized\r\n         */\r\n        get: function () {\r\n            return this._initialized;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Check the initialization status and throw exception if not valid yet\r\n     * @protected\r\n     */\r\n    MapInteractionBase.prototype._checkInit = function () {\r\n        if (!this.initialized) {\r\n            var msg = this._subtype + \" object not initialized\";\r\n            alert(msg);\r\n            console.log(msg);\r\n            throw msg;\r\n        }\r\n    };\r\n    /**\r\n     * Check the initialization status and throw exception if not valid yet\r\n     */\r\n    MapInteractionBase.prototype.checkInit = function () {\r\n        this._checkInit();\r\n    };\r\n    return MapInteractionBase;\r\n}());\r\nexports.MapInteractionBase = MapInteractionBase;\r\nnm.MapInteractionBase = MapInteractionBase;\r\nexports.default = MapInteractionBase;\r\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar mapMoveCls_1 = __webpack_require__(11);\r\n/**\r\n * The single map move object catch is that it is common to multimap pages\r\n * @type {MapMoveCls}\r\n */\r\nexports.mapMove = new mapMoveCls_1.default();\r\nexports.default = exports.mapMove;\r\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 12/15/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar quickMapBase_1 = __webpack_require__(13);\r\nvar provide_1 = __webpack_require__(0);\r\nvar mapMove_1 = __webpack_require__(6);\r\nvar mapPopup_1 = __webpack_require__(4);\r\nvar nm = provide_1.default('olHelpers');\r\n/**\r\n * Sets up a map with some default parameters and initializes\r\n * mapMove and mapPopup\r\n *\r\n * @param {object} [options={}] config options\r\n * @param {string} [options.divId=map] map div id\r\n * @param {object} [options.center={}] center config object\r\n * @param {number} [options.center.x=-10018378] center x, web mercator x or lon\r\n * @param {number} [options.center.y=5574910] center y, web mercator y or lat\r\n * @param {number} [options.zoom=7] zoom level\r\n * @param {number} [options.minZoom=undefined] min zoom\r\n * @param {number} [options.maxZoom=undefined] max zoom\r\n * @param {boolean} [options.baseSwitcher=true] if add base map switcher\r\n * @param {boolean} [options.fullScreen=false] if add base map switcher\r\n * @returns {ol.Map} the ol map\r\n */\r\nfunction quickMap(options) {\r\n    var m = quickMapBase_1.quickMapBase(options);\r\n    mapMove_1.default.init(m);\r\n    mapPopup_1.default.init(m);\r\n    return m;\r\n}\r\nexports.quickMap = quickMap;\r\nnm.quickMap = quickMap;\r\nexports.default = quickMap;\r\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar zoomResolutionConvert = __webpack_require__(14);\r\nvar provide_1 = __webpack_require__(0);\r\nvar makeGuid_1 = __webpack_require__(3);\r\nvar $ = __webpack_require__(1);\r\nvar nm = provide_1.default('layers');\r\n/**\r\n * The base layer class\r\n * @abstract\r\n */\r\nvar LayerBase = (function () {\r\n    /**\r\n     * The base layer for all others\r\n     * @param {string} url - url for source\r\n     * @param {object} options - config\r\n     * @param {string} [options.id=makeGuid()] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] - the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] - the z index for the layer\r\n     * @param {function} [options.loadCallback] - function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] - if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] - if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent=undefined] - additional content to add to the legend\r\n     */\r\n    function LayerBase(url, options) {\r\n        if (options === void 0) { options = {}; }\r\n        options = options || {};\r\n        if (typeof url !== 'string') {\r\n            throw 'Invalid URL';\r\n        }\r\n        this._url = url;\r\n        this._params = typeof options.params == 'object' ? options.params : {};\r\n        this._legendCollapse = typeof options.legendCollapse == 'boolean' ? options.legendCollapse : false;\r\n        this._legendCheckbox = typeof options.legendCheckbox == 'boolean' ? options.legendCheckbox : true;\r\n        this.id = options.id || makeGuid_1.default();\r\n        this._name = options.name || 'Unnamed Layer';\r\n        this.animate = false;\r\n        this._opacity = typeof options.opacity == 'number' ? options.opacity : 1;\r\n        if (this._opacity > 1) {\r\n            this._opacity = 1;\r\n        }\r\n        else if (this._opacity < 0) {\r\n            this._opacity = 0;\r\n        }\r\n        this._visible = typeof options.visible === 'boolean' ? options.visible : true;\r\n        this._source = undefined;\r\n        /**\r\n         *\r\n         * @protected\r\n         */\r\n        this._olLayer = undefined;\r\n        this._loaded = false;\r\n        this._maxResolution = zoomResolutionConvert.zoomToResolution(options.minZoom);\r\n        if (typeof this._maxResolution !== 'undefined') {\r\n            this._maxResolution += 0.00001;\r\n        }\r\n        this._minResolution = zoomResolutionConvert.zoomToResolution(options.maxZoom);\r\n        this._minZoom = typeof options.minZoom == 'number' ? options.minZoom : undefined;\r\n        this._maxZoom = typeof options.maxZoom == 'number' ? options.maxZoom : undefined;\r\n        this._zIndex = typeof options.zIndex == 'number' ? options.zIndex : 0;\r\n        this.loadCallback = typeof options.loadCallback == 'function' ? options.loadCallback : function () {\r\n        };\r\n        this._legendContent = '';\r\n        if (this._legendCheckbox) {\r\n            this._legendContent += \"<input type=\\\"checkbox\\\" \" + (this.visible ? 'checked' : '') + \" \" +\r\n                (\"class=\\\"legend-check\\\" id=\\\"\" + this.id + \"-legend-layer-check\\\"><span></span>\");\r\n            this._legendContent += \"<label for=\\\"\" + this.id + \"-legend-layer-check\\\" class=\\\"legend-layer-name\\\">\" + this.name + \"</label>\";\r\n        }\r\n        else {\r\n            this._legendContent += \"<label class=\\\"legend-layer-name\\\">\" + this.name + \"</label>\";\r\n        }\r\n        this._$legendDiv = null;\r\n        this._applyCollapseCalled = false;\r\n        this._addLegendContent(typeof options.legendContent === 'string' ? options.legendContent : undefined);\r\n    }\r\n    /**\r\n     * base load function, sets _loaded = true if it is not already\r\n     * @protected\r\n     * @returns {boolean} if already loaded\r\n     */\r\n    LayerBase.prototype._load = function () {\r\n        if (this.loaded == true) {\r\n            return true;\r\n        }\r\n        else {\r\n            this._loaded = true;\r\n            return false;\r\n        }\r\n    };\r\n    /**\r\n     * Get the legend html, be sure to only add to the DOM once\r\n     * @returns {string} html for layer wrapped in a div\r\n     */\r\n    LayerBase.prototype.getLegendDiv = function () {\r\n        return \"<div class=\\\"legend-layer-div\\\" id=\\\"\" + this.id + \"-legend-layer-div\\\">\" + this._legendContent + \"</div>\";\r\n    };\r\n    /**\r\n     *\r\n     * @param additionalContent - additional content to add to legend\r\n     * @private\r\n     */\r\n    LayerBase.prototype._addLegendContent = function (additionalContent) {\r\n        if (additionalContent === void 0) { additionalContent = ''; }\r\n        var addCollapse = additionalContent.indexOf('<ul>') > -1;\r\n        if (addCollapse) {\r\n            additionalContent = '<span class=\"legend-items-expander\" title=\"Expand/Collapse\">&#9660;</span>' + additionalContent;\r\n        }\r\n        this._legendContent += additionalContent;\r\n        this._$legendDiv = $(\"#\" + this.id + \"-legend-layer-div\");\r\n        if (this._$legendDiv.length > 0) {\r\n            this._$legendDiv.append(additionalContent);\r\n            this.applyCollapse();\r\n        }\r\n    };\r\n    /**\r\n     * add additional content to the legend\r\n     * @param {string} [additionalContent=] - additonal content to add\r\n     */\r\n    LayerBase.prototype.addLegendContent = function (additionalContent) {\r\n        this._addLegendContent(additionalContent);\r\n    };\r\n    LayerBase.prototype.applyCollapse = function () {\r\n        if (this._applyCollapseCalled) {\r\n            console.log('collapse already applied');\r\n            return undefined;\r\n        }\r\n        this._$legendDiv = $(\"#\" + this.id + \"-legend-layer-div\");\r\n        if (this._$legendDiv.length > 0) {\r\n            var $expander = this._$legendDiv.find('.legend-items-expander');\r\n            if ($expander.length > 0) {\r\n                this._applyCollapseCalled = true;\r\n                $expander.click(function () {\r\n                    var $this = $(this);\r\n                    $this.siblings('ul').slideToggle();\r\n                    if ($this.hasClass('legend-layer-group-collapsed')) {\r\n                        $this.removeClass('legend-layer-group-collapsed');\r\n                        $this.html('&#9660;');\r\n                    }\r\n                    else {\r\n                        $this.addClass('legend-layer-group-collapsed');\r\n                        $this.html('&#9654;');\r\n                    }\r\n                });\r\n                if (this._legendCollapse) {\r\n                    $expander.trigger('click');\r\n                }\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * trick to refresh the layer\r\n     */\r\n    LayerBase.prototype.refresh = function () {\r\n        if (this.source) {\r\n            this.source.refresh();\r\n        }\r\n    };\r\n    Object.defineProperty(LayerBase.prototype, \"id\", {\r\n        get: function () {\r\n            return this._id;\r\n        },\r\n        set: function (newId) {\r\n            this._id = newId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"animate\", {\r\n        get: function () {\r\n            return this._animate;\r\n        },\r\n        set: function (animate) {\r\n            this._animate = animate;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"legendContent\", {\r\n        /**\r\n         * get the legend content\r\n         * @type {string}\r\n         */\r\n        get: function () {\r\n            return this._legendContent;\r\n        },\r\n        /**\r\n         * set the legend content directly\r\n         * @param {string} newVal - new content\r\n         * @protected\r\n         */\r\n        set: function (newVal) {\r\n            this._legendContent = newVal;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"params\", {\r\n        /**\r\n         * get the map get params\r\n         * @type {object}\r\n         */\r\n        get: function () {\r\n            return this._params;\r\n        },\r\n        /**\r\n         * set the map get params\r\n         * @param {object} newParams - new get params\r\n         * @protected\r\n         */\r\n        set: function (newParams) {\r\n            this._params = newParams;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"minResolution\", {\r\n        /**\r\n         * get the minimum resolution\r\n         * @type {number|*}\r\n         */\r\n        get: function () {\r\n            return this._minResolution;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"maxResolution\", {\r\n        /**\r\n         * get the maximum resolution\r\n         * @type {number|*}\r\n         */\r\n        get: function () {\r\n            return this._maxResolution;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"minZoom\", {\r\n        /**\r\n         * get min zoom\r\n         * @type {number|*}\r\n         */\r\n        get: function () {\r\n            return this._minZoom;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"maxZoom\", {\r\n        /**\r\n         * get max zoom\r\n         * @type {number|*}\r\n         */\r\n        get: function () {\r\n            return this._maxZoom;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"url\", {\r\n        /**\r\n         * get the url\r\n         * @type {string}\r\n         */\r\n        get: function () {\r\n            return this._url;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"visible\", {\r\n        /**\r\n         * Get the layer visibility\r\n         * @type {boolean}\r\n         */\r\n        get: function () {\r\n            return this._visible;\r\n        },\r\n        /**\r\n         * set the visibility\r\n         * @param visibility\r\n         */\r\n        set: function (visibility) {\r\n            this.setVisible(visibility);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LayerBase.prototype.setVisible = function (visibility) {\r\n        this._visible = visibility;\r\n        if (this.olLayer) {\r\n            this.olLayer.setVisible(this._visible);\r\n            if (visibility && !this._loaded) {\r\n                this._load();\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(LayerBase.prototype, \"opacity\", {\r\n        /**\r\n         * Get the layer opacity\r\n         * @type {number}\r\n         */\r\n        get: function () {\r\n            return this._opacity;\r\n        },\r\n        /**\r\n         * Set the layer opacity\r\n         * @param {number} opacity - layer opacity\r\n         */\r\n        set: function (opacity) {\r\n            this._opacity = opacity;\r\n            if (this.olLayer) {\r\n                this.olLayer.setOpacity(this._opacity);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"name\", {\r\n        /**\r\n         * Get the layer name\r\n         * @type {string}\r\n         */\r\n        get: function () {\r\n            return this._name;\r\n        },\r\n        /**\r\n         * set the layer name\r\n         * @param {string} newName - the new name\r\n         */\r\n        set: function (newName) {\r\n            this._name = newName;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"loaded\", {\r\n        /**\r\n         * Check if the layer is loaded\r\n         * @type {boolean}\r\n         */\r\n        get: function () {\r\n            return this._loaded;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBase.prototype, \"source\", {\r\n        /**\r\n         * get the layer source\r\n         * @type {*}\r\n         */\r\n        get: function () {\r\n            return this.getSource();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LayerBase.prototype.getSource = function () {\r\n        return this._source;\r\n    };\r\n    Object.defineProperty(LayerBase.prototype, \"zIndex\", {\r\n        /**\r\n         * get the z index\r\n         */\r\n        get: function () {\r\n            return this._zIndex;\r\n        },\r\n        /**\r\n         * set the z index\r\n         */\r\n        set: function (newZ) {\r\n            this._zIndex = newZ;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LayerBase.prototype.setZIndex = function (newZ) {\r\n    };\r\n    Object.defineProperty(LayerBase.prototype, \"olLayer\", {\r\n        /**\r\n         * the the ol layer\r\n         */\r\n        get: function () {\r\n            return this.getOlLayer();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LayerBase.prototype.getOlLayer = function () {\r\n        return this._olLayer;\r\n    };\r\n    return LayerBase;\r\n}());\r\nexports.LayerBase = LayerBase;\r\nnm.LayerBase = LayerBase;\r\nexports.default = LayerBase;\r\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar provide_1 = __webpack_require__(0);\r\nvar nm = provide_1.default('util.checkDefined');\r\n/**\r\n * check if the input is undefined or null\r\n * @param input - input pointer\r\n * @returns true undefined or null\r\n */\r\nfunction undefinedOrNull(input) {\r\n    \"use strict\";\r\n    return (typeof input === 'undefined' || input === null);\r\n}\r\nexports.undefinedOrNull = undefinedOrNull;\r\nnm.undefinedOrNull = undefinedOrNull;\r\n/**\r\n * check if the input is defined and not null\r\n * @param input - input pointer\r\n * @returns true defined and not null\r\n */\r\nfunction definedAndNotNull(input) {\r\n    \"use strict\";\r\n    return !(undefinedOrNull(input));\r\n}\r\nexports.definedAndNotNull = definedAndNotNull;\r\nnm.definedAndNotNull = definedAndNotNull;\r\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Created by gavorhes on 12/7/2015.\r\n */\r\nvar LayerBase_1 = __webpack_require__(8);\r\nvar esriToOl = __webpack_require__(16);\r\nvar mapPopup_1 = __webpack_require__(4);\r\nvar provide_1 = __webpack_require__(0);\r\nvar ol = __webpack_require__(2);\r\nvar $ = __webpack_require__(1);\r\nvar nm = provide_1.default('layers');\r\n/**\r\n * esri mapserver layer\r\n * @augments LayerBase\r\n */\r\nvar LayerEsriMapServer = (function (_super) {\r\n    __extends(LayerEsriMapServer, _super);\r\n    /**\r\n     * The base layer for all others\r\n     * @param {string} url - resource url\r\n     * @param {object} [options] - config\r\n     * @param {string} [options.id] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] the z index for the layer\r\n     * @param {function} [options.loadCallback] function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent] additional content to add to the legend\r\n     * @param {boolean} [options.addPopup=false] if a popup should be added\r\n     * @param {undefined|Array<number>} [options.showLayers=undefined] if a popup should be added\r\n     */\r\n    function LayerEsriMapServer(url, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _this = _super.call(this, url, options) || this;\r\n        _this._source = new ol.source.TileArcGISRest({\r\n            url: _this.url == '' ? undefined : _this.url,\r\n            params: typeof options.showLayers == 'undefined' ? undefined : { layers: 'show:' + options.showLayers.join(',') }\r\n        });\r\n        _this._olLayer = new ol.layer.Tile({\r\n            source: _this._source,\r\n            visible: _this.visible,\r\n            opacity: _this.opacity,\r\n            minResolution: _this._minResolution,\r\n            maxResolution: _this._maxResolution\r\n        });\r\n        _this._olLayer.setZIndex(_this._zIndex);\r\n        options.addPopup = typeof options.addPopup == 'boolean' ? options.addPopup : false;\r\n        _this._esriFormat = new ol.format.EsriJSON();\r\n        _this._popupRequest = null;\r\n        _this.addLegendContent();\r\n        if (options.addPopup) {\r\n            mapPopup_1.default.addMapServicePopup(_this);\r\n        }\r\n        return _this;\r\n    }\r\n    /**\r\n     * add additional content to the legend\r\n     * @param {string} [additionalContent=''] additional content for legend\r\n     */\r\n    LayerEsriMapServer.prototype.addLegendContent = function (additionalContent) {\r\n        var _this = this;\r\n        var urlCopy = this.url;\r\n        if (urlCopy[urlCopy.length - 1] !== '/') {\r\n            urlCopy += '/';\r\n        }\r\n        urlCopy += 'legend?f=pjson&callback=?';\r\n        $.get(urlCopy, {}, function (d) {\r\n            var newHtml = esriToOl.makeMapServiceLegend(d);\r\n            _super.prototype.addLegendContent.call(_this, newHtml);\r\n        }, 'json');\r\n    };\r\n    LayerEsriMapServer.prototype.getPopupInfo = function (queryParams) {\r\n        if (!this.visible) {\r\n            return;\r\n        }\r\n        var urlCopy = this.url;\r\n        if (urlCopy[urlCopy.length - 1] != '/') {\r\n            urlCopy += '/';\r\n        }\r\n        urlCopy += 'identify?callback=?';\r\n        var __this = this;\r\n        if (this._popupRequest != null) {\r\n            this._popupRequest.abort();\r\n        }\r\n        this._popupRequest = $.get(urlCopy, queryParams, function (d) {\r\n            for (var _i = 0, _a = d['results']; _i < _a.length; _i++) {\r\n                var r = _a[_i];\r\n                var popupHtml = '<table class=\"esri-popup-table\">';\r\n                for (var a in r['attributes']) {\r\n                    if (r['attributes'].hasOwnProperty(a)) {\r\n                        var attrVal = r['attributes'][a];\r\n                        if (attrVal == null || attrVal.toString().toLowerCase() == 'null') {\r\n                            continue;\r\n                        }\r\n                        var attr = a;\r\n                        if (attr.length > 14) {\r\n                            attr = attr.slice(0, 11) + '...';\r\n                        }\r\n                        popupHtml += \"<tr><td>\" + attr + \"</td><td>\" + attrVal + \"</td></tr>\";\r\n                    }\r\n                }\r\n                popupHtml += '</table>';\r\n                mapPopup_1.default.addMapServicePopupContent(__this._esriFormat.readFeature(r), __this, popupHtml, r['layerName']);\r\n            }\r\n        }, 'json');\r\n        this._popupRequest.always(function () {\r\n            __this._popupRequest = null;\r\n        });\r\n    };\r\n    Object.defineProperty(LayerEsriMapServer.prototype, \"source\", {\r\n        /**\r\n         *\r\n         * @returns {ol.source.TileArcGISRest} the vector source\r\n         */\r\n        get: function () {\r\n            return _super.prototype.getSource.call(this);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerEsriMapServer.prototype, \"olLayer\", {\r\n        /**\r\n         *\r\n         * @returns the ol layer\r\n         */\r\n        get: function () {\r\n            return _super.prototype.getOlLayer.call(this);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return LayerEsriMapServer;\r\n}(LayerBase_1.LayerBase));\r\nexports.LayerEsriMapServer = LayerEsriMapServer;\r\nnm.LayerEsriMapServer = LayerEsriMapServer;\r\nexports.default = LayerEsriMapServer;\r\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar mapInteractionBase_1 = __webpack_require__(5);\r\nvar checkDefined = __webpack_require__(9);\r\nvar provide_1 = __webpack_require__(0);\r\nvar makeGuid_1 = __webpack_require__(3);\r\nvar $ = __webpack_require__(1);\r\nvar nm = provide_1.default('olHelpers');\r\n/**\r\n * assists with map move interactions, trigger callback functions\r\n * @augments MapInteractionBase\r\n */\r\nvar MapMoveCls = (function (_super) {\r\n    __extends(MapMoveCls, _super);\r\n    /**\r\n     * constructor called implicitly\r\n     */\r\n    function MapMoveCls() {\r\n        var _this = _super.call(this, 'map move') || this;\r\n        _this._arrLyrRequest = [];\r\n        _this._arrLyrTimeout = [];\r\n        _this._arrLayer = [];\r\n        _this._lookupLayer = {};\r\n        _this._mapMoveCallbacks = [];\r\n        _this._mapMoveCallbacksLookup = {};\r\n        _this._mapMoveCallbackDelays = [];\r\n        _this._mapMoveCallbackContext = [];\r\n        _this._mapMoveCallbackTimeout = [];\r\n        _this._mapExtent = undefined;\r\n        _this._zoomLevel = undefined;\r\n        return _this;\r\n    }\r\n    /**\r\n     * initialize the map move object\r\n     * @param theMap - the ol map\r\n     */\r\n    MapMoveCls.prototype.init = function (theMap) {\r\n        var _this = this;\r\n        _super.prototype.init.call(this, theMap);\r\n        this.map.getView().on(['change:center', 'change:resolution'], function (e) {\r\n            _this._updateMapExtent();\r\n            // trigger the layer updates\r\n            for (var i = 0; i < _this._arrLayer.length; i++) {\r\n                _this.triggerLyrLoad(_this._arrLayer[i], i, e.type);\r\n            }\r\n            // trigger the map callbacks\r\n            for (var i = 0; i < _this._mapMoveCallbacks.length; i++) {\r\n                _this.triggerMoveCallback(i, e.type);\r\n            }\r\n        });\r\n    };\r\n    MapMoveCls.prototype._updateMapExtent = function () {\r\n        var theView = this.map.getView();\r\n        this._zoomLevel = theView.getZoom();\r\n        var extentArray = theView.calculateExtent(this.map.getSize());\r\n        this._mapExtent = {\r\n            minX: extentArray[0],\r\n            minY: extentArray[1],\r\n            maxX: extentArray[2],\r\n            maxY: extentArray[3]\r\n        };\r\n    };\r\n    Object.defineProperty(MapMoveCls.prototype, \"mapExtent\", {\r\n        /**\r\n         * return the map extent\r\n         */\r\n        get: function () {\r\n            if (!this._mapExtent) {\r\n                this._updateMapExtent();\r\n            }\r\n            return this._mapExtent;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Trigger the layer load\r\n     * @param lyr the layer being acted on\r\n     * @param index index of the layer\r\n     * @param eventType the event triggering the load, as 'change:center' or 'change:resolution'\r\n     */\r\n    MapMoveCls.prototype.triggerLyrLoad = function (lyr, index, eventType) {\r\n        if (checkDefined.undefinedOrNull(lyr) && checkDefined.undefinedOrNull(index)) {\r\n            throw 'need to define lyr or index';\r\n        }\r\n        else if (checkDefined.definedAndNotNull(lyr) && checkDefined.undefinedOrNull(index)) {\r\n            index = this._arrLayer.indexOf(lyr);\r\n        }\r\n        else if (checkDefined.undefinedOrNull(lyr) && checkDefined.definedAndNotNull(index)) {\r\n            lyr = this._arrLayer[index];\r\n        }\r\n        // clear the timeout\r\n        if (this._arrLyrTimeout[index] != null) {\r\n            clearTimeout(this._arrLyrTimeout[index]);\r\n            this._arrLyrTimeout[index] = null;\r\n        }\r\n        // abort if necessary and clear the request\r\n        if (this._arrLyrRequest[index] != null && this._arrLyrRequest[index] != 4) {\r\n            this._arrLyrRequest[index].abort();\r\n            this._arrLyrRequest[index] = null;\r\n        }\r\n        // dummy callback used if before load returns false\r\n        var callbackFunc = function () { };\r\n        if (lyr.mapMoveBefore(this._zoomLevel, eventType)) {\r\n            lyr.mapMoveMakeGetParams(this._mapExtent, this._zoomLevel);\r\n            var __this_1 = this;\r\n            callbackFunc = function () {\r\n                function innerFunction(theLayer, theIndex) {\r\n                    var _innerThis = this;\r\n                    this._arrLyrRequest[theIndex] = $.get(theLayer.url, theLayer.mapMoveParams, function (d) {\r\n                        /**\r\n                         * @type {LayerBaseVector}\r\n                         */\r\n                        theLayer.mapMoveCallback(d);\r\n                        theLayer.loadCallback();\r\n                    }, 'json').fail(function (jqXHR) {\r\n                        if (jqXHR.statusText != 'abort') {\r\n                            console.log('failed');\r\n                            console.log(theLayer.url);\r\n                            console.log(theLayer.mapMoveParams);\r\n                        }\r\n                    }).always(function () {\r\n                        _innerThis._arrLyrTimeout[theIndex] = null;\r\n                        _innerThis._arrLyrRequest[theIndex] = null;\r\n                    });\r\n                }\r\n                innerFunction.call(__this_1, lyr, index);\r\n            };\r\n        }\r\n        else {\r\n            lyr.clear();\r\n        }\r\n        this._arrLyrTimeout[index] = setTimeout(callbackFunc, lyr.onDemandDelay);\r\n    };\r\n    /**\r\n     * trigger the map move call back at the given index\r\n     * @param ind - the index of the layer\r\n     * @param eventType=undefined the event triggering the load as 'change:center' or 'change:resolution'\r\n     * @param functionId=undefined the function id used to reference the added callback function\r\n     */\r\n    MapMoveCls.prototype.triggerMoveCallback = function (ind, eventType, functionId) {\r\n        if (typeof ind == 'undefined' && typeof functionId == 'undefined') {\r\n            throw 'either the function index or the id must be defined';\r\n        }\r\n        if (typeof ind !== 'number') {\r\n            ind = this._mapMoveCallbacks.indexOf(this._mapMoveCallbacksLookup[functionId]);\r\n        }\r\n        if (ind < 0) {\r\n            console.log('function not found');\r\n            return;\r\n        }\r\n        // clear the timeout\r\n        if (this._mapMoveCallbackTimeout[ind] != null) {\r\n            clearTimeout(this._mapMoveCallbackTimeout[ind]);\r\n            this._mapMoveCallbackTimeout[ind] = null;\r\n        }\r\n        var ctx = this._mapMoveCallbackContext[ind];\r\n        var theFunc = this._mapMoveCallbacks[ind];\r\n        var __this = this;\r\n        var f = function () {\r\n            if (ctx !== null) {\r\n                theFunc.call(ctx, __this._mapExtent, __this._zoomLevel, eventType);\r\n            }\r\n            else {\r\n                theFunc(__this._mapExtent, __this._zoomLevel, eventType);\r\n            }\r\n        };\r\n        this._mapMoveCallbackTimeout[ind] = setTimeout(f, this._mapMoveCallbackDelays[ind]);\r\n    };\r\n    /**\r\n     * Add a layer to the interaction\r\n     * @param  lyr - layer to add\r\n     * @param triggerOnAdd - if the layer should be loaded on add\r\n     */\r\n    MapMoveCls.prototype.addVectorLayer = function (lyr, triggerOnAdd) {\r\n        if (triggerOnAdd === void 0) { triggerOnAdd = true; }\r\n        if (this._arrLayer.indexOf(lyr) > -1) {\r\n            console.log('already added ' + lyr.name + ' to map move');\r\n            return;\r\n        }\r\n        this._checkInit();\r\n        this._arrLyrRequest.push(null);\r\n        this._arrLyrTimeout.push(null);\r\n        this._arrLayer.push(lyr);\r\n        this._lookupLayer[lyr.id] = lyr;\r\n        triggerOnAdd = typeof triggerOnAdd == 'boolean' ? triggerOnAdd : true;\r\n        if (triggerOnAdd) {\r\n            if (this._mapExtent === undefined) {\r\n                this._updateMapExtent();\r\n            }\r\n            this.triggerLyrLoad(lyr, this._arrLayer.length - 1);\r\n        }\r\n    };\r\n    /**\r\n     * add a callback to the map move event\r\n     * @param func - callback function\r\n     * @param context - the context to use for this function\r\n     * @param delay=50 the delay before call load\r\n     * @param triggerOnAdd if the layer should be loaded on add to mapMove\r\n     * @param functionId optional id to reference the function later for outside triggering\r\n     */\r\n    MapMoveCls.prototype.addCallback = function (func, context, delay, triggerOnAdd, functionId) {\r\n        if (this._mapMoveCallbacks.indexOf(func) > -1) {\r\n            console.log('this function already added to map move');\r\n            return;\r\n        }\r\n        this._checkInit();\r\n        if (!functionId) {\r\n            functionId = makeGuid_1.default();\r\n        }\r\n        this._mapMoveCallbacks.push(func);\r\n        this._mapMoveCallbacksLookup[functionId] = functionId;\r\n        this._mapMoveCallbackDelays.push(typeof delay == 'number' ? delay : 50);\r\n        this._mapMoveCallbackContext.push(checkDefined.definedAndNotNull(context) ? context : null);\r\n        this._mapMoveCallbackTimeout.push(null);\r\n        triggerOnAdd = typeof triggerOnAdd == 'boolean' ? triggerOnAdd : true;\r\n        if (triggerOnAdd) {\r\n            if (this._mapExtent === undefined) {\r\n                this._updateMapExtent();\r\n            }\r\n            this.triggerMoveCallback(this._mapMoveCallbacks.length - 1);\r\n        }\r\n    };\r\n    return MapMoveCls;\r\n}(mapInteractionBase_1.default));\r\nexports.MapMoveCls = MapMoveCls;\r\nnm.MapMoveCls = MapMoveCls;\r\nexports.default = MapMoveCls;\r\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar mapInteractionBase_1 = __webpack_require__(5);\r\nvar provide_1 = __webpack_require__(0);\r\nvar ol = __webpack_require__(2);\r\nvar $ = __webpack_require__(1);\r\nvar nm = provide_1.default('olHelpers');\r\nvar FeatureLayerProperties = (function () {\r\n    /**\r\n     *\r\n     * @param feature the feature\r\n     * @param layer - the layer in the popup\r\n     * @param layerIndex - index of the layer\r\n     * @param selectionLayer - the ol selection layer\r\n     * @param [esriLayerName=undefined] - esri layer name\r\n     */\r\n    function FeatureLayerProperties(feature, layer, layerIndex, selectionLayer, esriLayerName) {\r\n        this.feature = feature;\r\n        this.layer = layer;\r\n        this.layerIndex = layerIndex;\r\n        this.selectionLayer = selectionLayer;\r\n        this.popupContent = '';\r\n        this.esriLayerName = typeof esriLayerName == 'string' ? esriLayerName : undefined;\r\n    }\r\n    Object.defineProperty(FeatureLayerProperties.prototype, \"layerName\", {\r\n        get: function () {\r\n            if (typeof this.esriLayerName == 'string') {\r\n                return this.esriLayerName;\r\n            }\r\n            else {\r\n                return this.layer.name;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return FeatureLayerProperties;\r\n}());\r\nexports.FeatureLayerProperties = FeatureLayerProperties;\r\n/**\r\n * map popup class\r\n * @augments MapInteractionBase\r\n */\r\nvar MapPopupCls = (function (_super) {\r\n    __extends(MapPopupCls, _super);\r\n    /**\r\n     * Definition for openlayers style function\r\n     * @callback olStyleFunction\r\n     * &param feature the openlayers vector feature\r\n     * $param\r\n     */\r\n    /**\r\n     * map popup constructor\r\n     */\r\n    function MapPopupCls() {\r\n        var _this = _super.call(this, 'map popup') || this;\r\n        _this._arrPopupLayerIds = [];\r\n        _this._arrPopupLayerNames = [];\r\n        _this._arrPopupLayers = [];\r\n        _this._arrPopupOlLayers = [];\r\n        _this._arrPopupContentFunction = [];\r\n        _this._$popupContainer = undefined;\r\n        _this._$popupContent = undefined;\r\n        _this._$popupCloser = undefined;\r\n        _this._popupOverlay = undefined;\r\n        _this._selectionLayers = [];\r\n        _this._selectionLayerLookup = {};\r\n        _this._mapClickFunctions = [];\r\n        //let a = function($jqueryContent){console.log($jqueryContent)};\r\n        //this._popupChangedLookup = {'a': a};\r\n        _this._popupChangedFunctions = [];\r\n        _this._esriMapServiceLayers = [];\r\n        _this._popupOpen = false;\r\n        _this._popupCoordinate = null;\r\n        _this._passThroughLayerFeatureArray = [];\r\n        _this._currentPopupIndex = -1;\r\n        _this._popupContentLength = 0;\r\n        return _this;\r\n    }\r\n    /**\r\n     * map popup initialization\r\n     * @param {ol.Map} theMap - the ol map\r\n     */\r\n    MapPopupCls.prototype.init = function (theMap) {\r\n        var _this = this;\r\n        _super.prototype.init.call(this, theMap);\r\n        var $map;\r\n        var target = this.map.getTarget();\r\n        if (typeof target == 'string') {\r\n            $map = $('#' + target);\r\n        }\r\n        else {\r\n            $map = $(target);\r\n        }\r\n        $map.append('<div class=\"ol-popup\">' +\r\n            '<span class=\"ol-popup-closer\">X</span>' +\r\n            '<div class=\"popup-content\"></div>' +\r\n            '</div>');\r\n        this._$popupContainer = $map.find('.ol-popup');\r\n        this._$popupContent = $map.find('.popup-content');\r\n        this._$popupCloser = $map.find('.ol-popup-closer');\r\n        var _ease = function (n) {\r\n            return ol.easing.inAndOut(n);\r\n        };\r\n        this._popupOverlay = new ol.Overlay({\r\n            element: this._$popupContainer[0],\r\n            autoPan: true,\r\n            autoPanAnimation: {\r\n                duration: 250,\r\n                source: theMap.getView().getCenter(),\r\n                easing: _ease\r\n            }\r\n        });\r\n        this._map.addOverlay(this._popupOverlay);\r\n        this._$popupCloser.click(function (evt) {\r\n            _this.closePopup();\r\n        });\r\n        // display popup on click\r\n        this._map.on('singleclick', function (evt) {\r\n            _this.closePopup();\r\n            _this._popupCoordinate = evt['coordinate'];\r\n            // esri map service layers\r\n            if (_this._esriMapServiceLayers.length > 0) {\r\n                var queryParams = {\r\n                    geometry: evt['coordinate'].join(','),\r\n                    geometryType: 'esriGeometryPoint',\r\n                    layers: 'all',\r\n                    sr: _this._map.getView().getProjection().getCode().split(':')[1],\r\n                    mapExtent: _this._map.getView().calculateExtent(_this._map.getSize()).join(','),\r\n                    imageDisplay: _this._map.getSize().join(',') + ',96',\r\n                    returnGeometry: true,\r\n                    tolerance: 15,\r\n                    f: 'pjson'\r\n                };\r\n                for (var _i = 0, _a = _this._esriMapServiceLayers; _i < _a.length; _i++) {\r\n                    var l = _a[_i];\r\n                    l.getPopupInfo(queryParams);\r\n                }\r\n            }\r\n            var layerFeatureObjectArray = _this._featuresAtPixel(evt['pixel']);\r\n            _this._passThroughLayerFeatureArray = [];\r\n            _this._currentPopupIndex = -1;\r\n            for (var i = 0; i < layerFeatureObjectArray.length; i++) {\r\n                var featObj = layerFeatureObjectArray[i];\r\n                var props = featObj.feature.getProperties();\r\n                var popupContentResponse = _this._arrPopupContentFunction[featObj.layerIndex](props, _this._$popupContent);\r\n                //skip if return was false\r\n                if (popupContentResponse === false) {\r\n                    //continue;\r\n                }\r\n                else if (typeof popupContentResponse == 'string') {\r\n                    featObj.popupContent = popupContentResponse;\r\n                    _this._passThroughLayerFeatureArray.push(featObj);\r\n                }\r\n                else {\r\n                    featObj.selectionLayer.getSource().addFeature(featObj.feature);\r\n                }\r\n            }\r\n            _this._popupContentLength = _this._passThroughLayerFeatureArray.length;\r\n            _this._currentPopupIndex = -1;\r\n            var popupHtml = '<div class=\"ol-popup-nav\">';\r\n            popupHtml += '<span class=\"previous-popup ol-popup-nav-arrow\">&#9664;</span>';\r\n            popupHtml += '<span class=\"next-popup ol-popup-nav-arrow\">&#9654;</span>';\r\n            popupHtml += \"<span class=\\\"current-popup-item-number\\\" style=\\\"font-weight: bold;\\\"></span>\";\r\n            popupHtml += \"<span>&nbsp;of&nbsp;</span>\";\r\n            popupHtml += \"<span class=\\\"popup-content-length\\\" style=\\\"font-weight: bold;\\\">\" + _this._popupContentLength + \"</span>\";\r\n            popupHtml += \"<span>&nbsp;&nbsp;-&nbsp;&nbsp;</span>\";\r\n            popupHtml += \"<span class=\\\"current-popup-layer-name\\\"></span>\";\r\n            popupHtml += '</div>';\r\n            popupHtml += '<div class=\"ol-popup-inner\">';\r\n            popupHtml += '</div>';\r\n            _this._$popupContent.html(popupHtml);\r\n            _this._$popupContent.find('.previous-popup').click(function () {\r\n                if (_this._popupContentLength == 1) {\r\n                    return;\r\n                }\r\n                if (_this._currentPopupIndex == 0) {\r\n                    _this._currentPopupIndex = _this._popupContentLength - 1;\r\n                }\r\n                else {\r\n                    _this._currentPopupIndex--;\r\n                }\r\n                _this._triggerFeatSelect();\r\n            });\r\n            var nextPopup = _this._$popupContent.find('.next-popup');\r\n            nextPopup.click(function () {\r\n                if (_this._popupContentLength == 1 && _this._currentPopupIndex > -1) {\r\n                    return;\r\n                }\r\n                if (_this._currentPopupIndex == _this._popupContentLength - 1) {\r\n                    _this._currentPopupIndex = 0;\r\n                }\r\n                else {\r\n                    _this._currentPopupIndex++;\r\n                }\r\n                _this._triggerFeatSelect();\r\n            });\r\n            if (_this._popupContentLength > 0) {\r\n                nextPopup.trigger('click');\r\n                _this._popupOverlay.setPosition(_this._popupCoordinate);\r\n                _this._$popupContent.scrollTop(0);\r\n                _this._popupOpen = true;\r\n            }\r\n        });\r\n        //change mouse cursor when over marker\r\n        this._map.on('pointermove', function (evt) {\r\n            if (evt['dragging']) {\r\n                return;\r\n            }\r\n            var pixel = _this.map.getEventPixel(evt['originalEvent']);\r\n            var hit = _this.map.hasFeatureAtPixel(pixel, function (lyrCandidate) {\r\n                for (var _i = 0, _a = _this._arrPopupOlLayers; _i < _a.length; _i++) {\r\n                    var olLayer = _a[_i];\r\n                    if (lyrCandidate == olLayer) {\r\n                        return true;\r\n                    }\r\n                }\r\n                return false;\r\n            });\r\n            var mapElement = _this.map.getTargetElement();\r\n            mapElement.style.cursor = hit ? 'pointer' : '';\r\n        });\r\n        return true;\r\n    };\r\n    /**\r\n     * helper to select features\r\n     * @private\r\n     */\r\n    MapPopupCls.prototype._triggerFeatSelect = function () {\r\n        var $currentPopupItemNumber = this._$popupContent.find('.current-popup-item-number');\r\n        var $innerPopup = this._$popupContent.find('.ol-popup-inner');\r\n        var $layerNameSpan = this._$popupContent.find('.current-popup-layer-name');\r\n        this.clearSelection();\r\n        var lyrFeatObj = this._passThroughLayerFeatureArray[this._currentPopupIndex];\r\n        $currentPopupItemNumber.html((this._currentPopupIndex + 1).toFixed());\r\n        $layerNameSpan.html(lyrFeatObj.layerName);\r\n        $innerPopup.html(lyrFeatObj.popupContent);\r\n        lyrFeatObj.selectionLayer.getSource().addFeature(lyrFeatObj.feature);\r\n        for (var _i = 0, _a = this._popupChangedFunctions; _i < _a.length; _i++) {\r\n            var f = _a[_i];\r\n            f(this._$popupContent);\r\n        }\r\n    };\r\n    /**\r\n     *\r\n     * @param feature - the ol feature\r\n     * @param {LayerEsriMapServer} lyr - the map server layer\r\n     * @param {string} popupContent - popup content\r\n     * @param {string} esriName - esri layer name\r\n     */\r\n    MapPopupCls.prototype.addMapServicePopupContent = function (feature, lyr, popupContent, esriName) {\r\n        var featLayerObject = new FeatureLayerProperties(feature, lyr, this._popupContentLength, this._selectionLayerLookup[lyr.id], esriName);\r\n        featLayerObject.popupContent = popupContent;\r\n        this._passThroughLayerFeatureArray.push(featLayerObject);\r\n        this._popupContentLength++;\r\n        $('.popup-content-length').html(this._popupContentLength.toFixed());\r\n        if (!this._popupOpen) {\r\n            this._$popupContent.find('.next-popup').trigger('click');\r\n            this._popupOverlay.setPosition(this._popupCoordinate);\r\n            this._$popupContent.scrollTop(0);\r\n            this._popupOpen = true;\r\n        }\r\n    };\r\n    /**\r\n     *\r\n     * @param  pixel - the ol pixel\r\n     * @returns  feature layer properties\r\n     * @private\r\n     */\r\n    MapPopupCls.prototype._featuresAtPixel = function (pixel) {\r\n        var _this = this;\r\n        var layerFeatureObjectArray = [];\r\n        this.map.forEachFeatureAtPixel(pixel, function (feature, layer) {\r\n            var lyrIndex = _this._arrPopupOlLayers.indexOf(layer);\r\n            if (lyrIndex > -1) {\r\n                layerFeatureObjectArray.push(new FeatureLayerProperties(feature, _this._arrPopupLayers[lyrIndex], lyrIndex, _this._selectionLayers[lyrIndex]));\r\n            }\r\n        });\r\n        return layerFeatureObjectArray;\r\n    };\r\n    MapPopupCls.prototype.closePopup = function () {\r\n        this._checkInit();\r\n        this._popupOpen = false;\r\n        this._popupOverlay.setPosition(undefined);\r\n        this._$popupCloser[0].blur();\r\n        this.clearSelection();\r\n        this._$popupContent.html('');\r\n        return false;\r\n    };\r\n    ;\r\n    /**\r\n     *\r\n     * @param chgFunction - popup change function\r\n     */\r\n    MapPopupCls.prototype.addPopupChangedFunction = function (chgFunction) {\r\n        this._popupChangedFunctions.push(chgFunction);\r\n    };\r\n    /**\r\n     *\r\n     * @param {LayerBase|*} lyr - the layer being acted on\r\n     * @param {object} [selectionStyle={}] the selection style configuration\r\n     * @param {string} [selectionStyle.color=rgba(255,170,0,0.5)] the selection color\r\n     * @param {number} [selectionStyle.width=10] the selection width for linear features\r\n     * @param {object|function} [selectionStyle.olStyle=undefined] an openlayers style object or function\r\n     * @returns  the new selection layer\r\n     * @private\r\n     */\r\n    MapPopupCls.prototype._addPopupLayer = function (lyr, selectionStyle) {\r\n        this._checkInit();\r\n        selectionStyle = selectionStyle || {};\r\n        selectionStyle.color = selectionStyle.color || 'rgba(255,170,0,0.5)';\r\n        selectionStyle.width = selectionStyle.width || 10;\r\n        var theStyle;\r\n        if (selectionStyle.olStyle) {\r\n            theStyle = selectionStyle.olStyle;\r\n        }\r\n        else {\r\n            theStyle = new ol.style.Style({\r\n                stroke: new ol.style.Stroke({\r\n                    color: selectionStyle.color,\r\n                    width: selectionStyle.width\r\n                }),\r\n                image: new ol.style.Circle({\r\n                    radius: 7,\r\n                    fill: new ol.style.Fill({ color: selectionStyle.color }),\r\n                    stroke: new ol.style.Stroke({ color: selectionStyle.color, width: 1 })\r\n                }),\r\n                fill: new ol.style.Fill({\r\n                    color: selectionStyle.color\r\n                })\r\n            });\r\n        }\r\n        var selectionLayer = new ol.layer.Vector({\r\n            source: new ol.source.Vector(),\r\n            style: theStyle\r\n        });\r\n        selectionLayer.setZIndex(100);\r\n        this._selectionLayers.push(selectionLayer);\r\n        this._selectionLayerLookup[lyr.id] = selectionLayer;\r\n        this.map.addLayer(selectionLayer);\r\n        return selectionLayer;\r\n    };\r\n    /**\r\n     * Add popup to the map\r\n     * @param {LayerBase|*} lyr The layer that the popup with act on\r\n     * @param {popupCallback} popupContentFunction - popup content function that makes popup info\r\n     * @param {object} [selectionStyle={}] the selection style configuration\r\n     * @param {string} [selectionStyle.color=rgba(255,170,0,0.5)] the selection color\r\n     * @param {number} [selectionStyle.width=10] the selection width for linear features\r\n     * @param {object|function} [selectionStyle.olStyle=undefined] an openlayers style object or function\r\n     * @returns {object} a reference to the ol selection layer\r\n     */\r\n    MapPopupCls.prototype.addVectorPopup = function (lyr, popupContentFunction, selectionStyle) {\r\n        var selectionLayer = this._addPopupLayer(lyr, selectionStyle);\r\n        this._arrPopupLayerIds.push(lyr.id);\r\n        this._arrPopupLayerNames.push(lyr.name);\r\n        this._arrPopupLayers.push(lyr);\r\n        this._arrPopupOlLayers.push(lyr.olLayer);\r\n        this._arrPopupContentFunction.push(popupContentFunction);\r\n        return selectionLayer;\r\n    };\r\n    ;\r\n    /**\r\n     *\r\n     * @param {LayerBase} lyr - layer\r\n     */\r\n    MapPopupCls.prototype.removeVectorPopup = function (lyr) {\r\n        var idx = this._arrPopupLayerIds.indexOf(lyr.id);\r\n        if (idx > -1) {\r\n            this._arrPopupLayerIds.splice(idx, 1);\r\n            this._arrPopupLayerNames.splice(idx, 1);\r\n            this._arrPopupLayers.splice(idx, 1);\r\n            this._arrPopupOlLayers.splice(idx, 1);\r\n            this._arrPopupContentFunction.splice(idx, 1);\r\n            this._selectionLayers.splice(idx, 1);\r\n            delete this._selectionLayerLookup[lyr.id];\r\n        }\r\n    };\r\n    /**\r\n     *\r\n     * @param {LayerEsriMapServer} lyr - map server layer\r\n     * @param {object} [selectionStyle={}] the selection style configuration\r\n     * @param {string} [selectionStyle.color=rgba(255,170,0,0.5)] the selection color\r\n     * @param {number} [selectionStyle.width=10] the selection width for linear features\r\n     * @param {object|function} [selectionStyle.olStyle=undefined] an openlayers style object or function\r\n     * @returns {object} a reference to the ol selection layer\r\n     */\r\n    MapPopupCls.prototype.addMapServicePopup = function (lyr, selectionStyle) {\r\n        var selectionLayer = this._addPopupLayer(lyr, selectionStyle);\r\n        this._esriMapServiceLayers.push(lyr);\r\n        return selectionLayer;\r\n    };\r\n    MapPopupCls.prototype.clearSelection = function () {\r\n        this._checkInit();\r\n        for (var i = 0; i < this._selectionLayers.length; i++) {\r\n            this._selectionLayers[i].getSource().clear();\r\n        }\r\n        for (var _i = 0, _a = this._mapClickFunctions; _i < _a.length; _i++) {\r\n            var f = _a[_i];\r\n            f();\r\n        }\r\n    };\r\n    ;\r\n    /**\r\n     * Add a function to be called when the map is clicked but before any popups are implemented\r\n     * @param {function} func - the map click function\r\n     */\r\n    MapPopupCls.prototype.addMapClickFunction = function (func) {\r\n        this._mapClickFunctions.push(func);\r\n    };\r\n    return MapPopupCls;\r\n}(mapInteractionBase_1.default));\r\nexports.MapPopupCls = MapPopupCls;\r\nnm.MapPopupCls = MapPopupCls;\r\nexports.default = MapPopupCls;\r\n\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 12/15/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar provide_1 = __webpack_require__(0);\r\nvar ol = __webpack_require__(2);\r\nvar $ = __webpack_require__(1);\r\nvar nm = provide_1.default('olHelpers');\r\n/**\r\n * Sets up a map with some default parameters and initializes\r\n * mapMove and mapPopup\r\n *\r\n * @param [options={}] config options\r\n * @param [options.divId=map] map div id\r\n * @param [options.center={}] center config object\r\n * @param [options.center.x=-10018378] center x, web mercator x or lon\r\n * @param [options.center.y=5574910] center y, web mercator y or lat\r\n * @param [options.zoom=7] zoom level\r\n * @param [options.minZoom=undefined] min zoom\r\n * @param [options.maxZoom=undefined] max zoom\r\n * @param [options.baseSwitcher=true] if add base map switcher\r\n * @param [options.fullScreen=false] if add base map switcher\r\n * @returns the ol map\r\n */\r\nfunction quickMapBase(options) {\r\n    options = options || {};\r\n    options.divId = options.divId || 'map';\r\n    options.center = options.center || { x: -10018378, y: 5574910 };\r\n    options.zoom = typeof options.zoom == 'number' ? options.zoom : 7;\r\n    options.baseSwitcher = typeof options.baseSwitcher == 'boolean' ? options.baseSwitcher : true;\r\n    options.fullScreen = typeof options.fullScreen == 'boolean' ? options.fullScreen : false;\r\n    var $mapDiv = $('#' + options.divId);\r\n    $mapDiv.css('position', 'relative');\r\n    var osmLayer = new ol.layer.Tile({ source: new ol.source.OSM() });\r\n    // let satLayer = new ol.layer.Tile({visible: false, source: new ol.source.MapQuest({layer: 'sat'})});\r\n    var osmCss = \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURQAAADQ1NDk5OURFREtLS1FHSFlZWGJRVGJiYWdmZWxsbHRmaXBpanN0c3V0dHp5eX5+fIVzd4F3eeV0jud5juZ8k4aHhomHhoyGh5eGj5OVlJiVlZiYl5qZmJydnKOTlaKZmqKdnaOioaqqqKuzsbOvrrSysLa3tbW4uLm6ub27ub+/vbGXwbCZwbCgxLKlxrOqyLStybO3yrSxyrWzzbW2y7a1zbK4y7W6zbW8y760yrTAzbTFzrPKzrLOzrTJzrTOzr7CwbXC0LXK0LTO0L3I0bPQz7TQz7PS0bXQ0LnR0brW1bzT0r7U077V1Lzc2dqNqteUsdyXscaquuOHneaGmueHnOeJnuiBleiKn+eNoOiOoOWUpOiRo+iSpeiUpeqYpumaqOmdrPSynemgruSqtOmisOmlsuuqtequuOW1vOuxu+uxvOq1ve+xvPK0pvW3o/W5pfO5qvS7qfCwvMOuwc2/wNenxNyyzNe/0Nq31Nq51dy72Oy3wOu4wOu+xey4wO+6xO2+xfTAr/TCsvfFtPHLvvTJuMPDwMfHxcXKyc3DxMvFyMvLyM3PzcDV08DV1MTX1cbY1s7X1sjZ1sra2Mnd3M7b2c7c2tfH1tnB1t7F2d7M29fX1tLY1tDd2tHe3NTf3NnS19rZ1tva2Nnf3t3d28rh3tXg3Nnh3tzj393k39ni4N7k4N7n5uXDyOfLz+zAxu3CyOzEyezKzeDJ3eLM3uvP0u3P0ePf2+7R0u7Q1u/U0+7U1ezc0+7a2e/d2+3f3vbFzvLOwfHN0PPQw/TUx/LWyvLYzPDQ1fPe0ubc4vve4uHh3+nh3+/h2u/h3vHj2vHl3uHm4eTn4uDp5ebo4+Xo5ODq6ebq6OTv6+nl4+/j4O7l4e7n5ujp4+np5Ozq5e7s5urt6O7t6Orw6u7x6u3x7vPj5PDl4fDo4vDq5fDt5vDu6PDv7PTv6fDx6vHx7fH17fXw6fXy7fb07/bz8fT18vn38vr39fr48/r59Pr6+P3++//+/gAAALNTSk0AAAEAdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBT9wclAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGHRFWHRTb2Z0d2FyZQBwYWludC5uZXQgNC4wLjlsM35OAAAFNElEQVRIS1VVCZxVUxi/9l0UIUT2bMnY43bVI2c0Y01kSWIaS0j2JEtkN41piomZrPPKQ2aQ7JKImOZlnm2493TJzDufuU1Zi+v/fee+mZ//793vnPOd7zvfes5zDBEZkBBjAcIjb+Iiotqgdhat8AMK0vl7/R9N7GiWtshqIr+EZ5gYKibyUsXY1l/mfFpssvUlWQ0FkU3gy4+RB/+kwYcO8pRSnldcOU/r2lAHARSwk2ORgEmOdC1EsuRiYSqMPwwroMIraZk5V2fYJQjCKfZrRmh3gSAZi2i4b7wSylWu8EqZwS59JkFUaW96JbNSc+CEUmt4rorwuZmWdDaoc+uZETuQlTCU5xYzR7muUnVUVo+BcRhre/VwUpasgJwhH7JkYIYA0sNxhmCwUK+lw6vCKBZehw01dEiyw4Q4aE0Z4ahDhKaFQsGnJ2BgqKoTBsNjFy0SlW6whRAZTdm8DBJmkBZhDi1j4xJQBk6ywrWUTymaCxac8lROcdauRGzQSNtA7EHUYhXyEwhhgjFUqRuO+rauhF1awFpzCsmwUbjIFBR0u1bKtyGpulW/H/cVVzkyGaIWTIR9pFAV6GK2gPMXMX8gPk9zzxXgI1kimcAltEYr+cjio1imlKpEa9rOipLm+p+CZ6Bw//qd1/f/O+GwMxbSLpyoZEcwkyh2jIks+3hmdd2jWUw4scxNysnHxU7nSspTRcJjCZGL3IsjsYJMMg5mwgx7gaIOLBFCogAgBBoNa9w+DE6I+Bs7FTgwwrJbHjWDgpYo2KwtBTcYEDuloC9geQw+k2RGnPGpTaOlq7AS+YICUz4DZVaX2TiNDhuYfTtY4geLi0IoCm3XccwM9hx4kU28StQEljDs3ZEpFGA+8dKzLmV9ymIwF5FOGn2GdJM8KLHDJbXyiYVMG9MRTLiXGGg2QKaxM3khPSRrwM9zEIardxU2w/EiA0gOeYKHzDR0V7/QGV3lKIA9ktrDArxO3gdA+k6SKoBiVwcm7NjZb9+Hnztg282TuHVZ9LOISFNt9MgyCetZVczSxnyDbl17Penq6mqpg1IhRaEO2aVLUO4/r17H8tTv6f13h71dduvZI3Y+uMdWksNSauLovJw5hsqiPIUvt0ku7/iBeUR3sksmomYWtRbAjbiLfv2lX9/V7LVG4uYnUZXhQ7f2OPCZEx9wrYWTcePEQqPEML8pl4mMdr/jlXlvHiRiJ2+MSTFY4TTSYStuvz2R/JXh+PPeGXm055J+3/YDWuNu3R3DArPutyg0ZgykMVDU9Ndm22+wYalr2rse48CnsTIFcMn73vfhNrktx1EUcZnPv6ah3Yy5cDTRdBEoGoBeah71dqFyjZDJLkWk3N3v4uuktssjWpzciMPxQeHj8nMKzcGuB0tAyzFhdCKOYWv4HwOQVwIxLG99a6uvH3sJCyO3h+k4EZ+G7+xj5f4XXksoaGrdMRzSc8ARA8+cdOuk2x6fffNNt5x+Ro1omPlrT/CQDlcNlpx4NBIWXhkx7Y3Zp3ofNR7Uv89Om/beW0TLIynHv3vs1VsOFpSWSXvfuPUf9BrRFyxgXdHoKJnQFegPOovvzz59ntrzye240ig8UQ3lDI2VqwagrKIQcLXNFL3wglN2OHdBQ6/vI3kENDVBwRb3k1XtczFbjWn4EzMYi7CF3129+JTYuRSdrGuS92g5dpqn6qXoJQs5xmL8p+Wt4hLbt0mx2OLNZR2bbPy8zJNQGFM/f/CfXZekRYFjGCWjIJpM+WiCzGBPWHhoyaAsjRT/B2Gy5yzYJkwUAAAAAElFTkSuQmCC')\";\r\n    var aerialCss = \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURQALBgIMDQgOBwQOEQcTBwUSCwoVDAwdBw8ZDgUREwYUGAYZFQYZGgkTFQoVGQsZFAwZHBMeDhIbFBEbHAwWIA4bIREcIQ4hCQwjFw4lHBgkDB8sDxUiExIiGhAoGxohFRshGRorHQcrKQsiIQwmKgooJA0pKQ81Jw8yLRMiIxImKxUrJREuKhslJB0rIhooKRUuMBMyLhkwJhozKh48LxUzMRM9MBwzMiUvFCMtGiMwEiwzFCgzHDI+GSIsISkvJSQxIiM2LiY5Jic+Lyk0JSo0Ky49JSs9KSU1NSM7NCs2NS8+NDM1JzU9Ljg7IDJCHS1DLSNAMitCMSxIOjREITZLIDZJKDlFIjpFKztKJT1LKzJBMzpHMD1JMjpKPD1RKjlQNC1DQj5QQEA8MEJGJkBKJUJNK0lLLEJMMkVMPEpONENSLUdZL0pTLkpaLkRUMkRSPEVZMktUM0pVOklZMklZNEpcNU1ZMk1ZNUxfMk5dNkxcOVFUM1RUOFJbNVFZOVNYPVFdOVJdPFVaOVVaPVVdOlVdPVpaNlpdO0phN01hOlBiN1NhPFNoP1piPWFbPmRjPENOQEtPSURTQkJVS0xVQk1VSkxbQkxcS0heUVFXRFRcQlJfTFxeQlpeS05lQk1kSFRjQVRjSlZpQ1tkQlxlSlxpRF1rSVVnUVtlU1llXF9tU1xoXlxwSl9ramRfQmJlQ2FhSWFlSWFlTmVlSWRmTGFoQWFpRWFsRmVpRWVtRmNsSmtlRGpqRmpsS2BmWGRsUmFrW2ptUmZyR2RxTGpxTWVyU2RyW2d5V2tzUmt0WW15VG15WXFuTHNtVnFxTXF4T3h0TnJzUnJ1XHJ4VXN6Wnp0VHx1W315VXp8XGR0YGx0YHVzZXJ0aHR9ZXV+aHl9YHOCXXqBXXeCYHyCY3iEaHyIYn+JaXqKcYB5WIN6Y4SCXoCDZIGEaYCIZoOLa4iCaImJbIOOdYuMco6OeIuVcpOKbZKPc5aQb5eXe5ufg6KjhAAAAAAAAAAAAAAAAOGCeQgAAAEAdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBT9wclAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGHRFWHRTb2Z0d2FyZQBwYWludC5uZXQgNC4wLjlsM35OAAAH80lEQVRISy1WbXQUVxm+6wqnk3Zmpxl2FG2EGg92C8GDlWptVTwa+uF3xcKmDfFzCUzDsJNsunXipglJXJbrtJWmwZNSnHD3jojRgUIm2UumIZ0JZ7JByrALbMWW0IBW8aRa4+cf76TeX3Nm3uc+z/s+7/vugl4r/aMTrT4e1pPTqnnmJNn5AyUzRnrRle/qE33dsvrBtAQVoxtpZNK3zSzYjUjviWO2Ag+R77dl7W36n/1Ep9KBPG/S+Py0PkjU/gPKQGqwTHryiWYFAXSvMairsio7SjyNsnCzh0qKImV9/7mhfHQZx2yN1O+7rXUm33MUPaboOkAJHaoIdXfJj2xWeyD8jMFEXkvIu5qzpU988gWB5zl+GS+sFe55trEVPdWZB2miq8bBVkNFO2R0qnrfkiXhcJhtDNXE6tbW97/s9O9/7ZfVhx86/CwrROpfvvxboMqeLsuqPr1j44qEwDNMOBximUiYoU8sw7BC/a7T72uEnyJDlGxZ9KcglZRyuqqrv/tSZErgOI4NgRBTIw9EmHAoFGZZnp6aGaJ2GTxfxYs8kKVUQh7WB5hQeC3LsUxoxVKW14l3BX2WcoUYPiZyLLe8teZ+iuT4GGhvV5KpKWkpyzxEr2MZgQ1xdRjfRBoH+2k6lIHjKTHPPBo8CSJISqqq4wGGOcWylIGlgvgNX1Gd8vF5f+IUIwb30ng+Gg2QfBRIMvy0jG8SVkYo4N0zvUXVRztbJ/L6xL7lUZEXBEHkuZqlS6gEAUgKJurnhFtfpACOYd8b/hVbJPqwi44a6KA0sPVjIi/SIyxb3u8KlAJ0S8jRVgrlW+nVHPdrhiXCxu42d86ByksDc80P3MkJFBFQ8Ho1lQegpWJRWFGsDsRwwv7pIyvuQW0ZkrX6NDVFbqcvaQI8vbyqzt5AARrsbKx5yhQEGs+wPO56bOK+0rcwMrOKkpUbZWYxV04UeZZv/cBKFhRL6Qdv9y4LfEDA7/thg7tTmv1a5/GnO0wl0dQg80wglZaHUmxRvjwAHOfyN0mxrpqLUpcjsK3NHYMo4R1o6eho2ZyIb2FoeOC3ILK8kZ2HQMOuWywGXUkJBCeTbYFS0+ym1h2/6UgmvnrvKYZZtIEXGf75C2cIAp5LHNd71x7uPoTjakrWH9e3KFpaatjUvJUysFw0KrLMYMW2lTg4PeUQx6kJEALvxXEmCdVyPLHtCSjBhc01XCjIgafxou+PE6KC1dhxSCwoBCc+N4P3btM84pmdSSjJnjO/nvY4LQfVyz5/I+v6IwjUOMjy+MVCxIbKupTJaEktp7cTKU42Pvjh2m/8cSpC6aPsaX/MHSuUQLVVsIa4RUTs/r/BVAexNdjdnsNG7j/rV93xheLMzKnFrPeTEQchCyCcKb25aAIn7lrAertrZwyNXM8N6zfWrFo3d2SmOEcF83x/r+OOFgrAHYWF7cELjhV7UQo/6WAIUVl9JFl8a//HZ66VpbY3I9QKZqPru77lA+iOWAIr0hKxHCmmr0othSyeIl5y3qt4xT8gSNrKEZozs8Els67rgsLOZ+ygzwMfbtNhobfgzpEyGnz7htPtzUi6PuOoj7K0WF/MXiUFxwGajRD1hjYXHXI9p406qOyinp5/tiWcDHY0jIu4n64Qfq7kliB2gemag9QbOia0PbbDMbd43SHuvxFxrAocxins7MX5Kqbe1QixKBxoV4//PfAgGCu+Rlm4SvZizyDH+0reDHp92iO0BuX3bCfItl0PEwvYLqpwXG2MHlGsQ4S8pMJZv1JGmHiEoHQDdOjwmVlEP/nE9ADKjI8xLI0OOGITfy0SbeG/C2jKUDGSlDhM9I3IpK9iup6XnbRNC7yqueNsJCCIiXzdQhnaGN+46umnEdy5U5UbUJ48LFM9GkJo8BdDOiAZ7ZIQbKhYLMqvhU2wmNxjEAsS2AI7y4nWF64duePbk7YV3zvAVLEMD9AxJRNa3KDUibV7DjnkuprMEYjScFNcaR2ceP2u9R/5k1052Ryme5phAFRswlHjAudiP4dOy7CaxLgdJh9vUlU1702/+LPa1U9fvPi9qlA4XEUBJc3dFlpsR457IDl1iPqLp7o81NQgyV19iYU38uTiv975Pd3SiwQcsGjx+v4/6fl5T7EOOMTCtpbKxfemsQq/3olQZcminADAAI0cuGLHaHOFxbuGvRk/Z9u7CULqoVR6NE0yx1avj30oRhc/jWUoIALGxkz0dg1Dl9iaI7LqOOXKsXJFwjiuEAi70Jra2nW1PL08zLBhZsMABpW5csI7TPfew9ipFKcn5k1i+1KyCWKjC3W/8dF1d666+RaabBVTFTHacjoojBNDh0NDxk+IPTlwfqJkWpbnpFHXIbLbmpxEQ3ff/Z0g/mauXsoln9wDRjy/NHsQFw3P6vWuTJ43/+FZrk2cvAFRipCKdfD9y2+pjRj78s0KdCUDKJvdV91ChngV38T20TM+gghjpJaPlpFr2xbEz5g4A/NGt5rNwdwmYGeeeMXBSLHHUIc+6RsojRH9VTUm3/mLf/64b470XvoxoTKhlMBQ2jMEzo2PjxdGMppmn1RM24bWFJqaQv4BcuJa2Sam7Zokq1ldCsz06NCBHrhwqVQYpfFj42NZexz1EW9SR/kT58nEeQKJb2fPXjjp0u/YUkwHEgLeOnf2nOuf1TRTM02CLKLTPy60/x1CCztqn7Ev+BdsC3m+30decQvW/wBNTwU+CfUQAQAAAABJRU5ErkJggg==')\";\r\n    if (options.baseSwitcher) {\r\n        //  let switcherContent = '<div class=\"base-map-switcher\" title=\"Toggle Base Layer\" style=\"';\r\n        //  switcherContent += 'position: absolute; top: 70px; left: 4px; border: solid black 1px; ';\r\n        //  switcherContent += `height: 50px; width: 50px; z-index: 10; border-radius: 4px; background: ${aerialCss};`;\r\n        //  switcherContent += '\"></div>';\r\n        //  $mapDiv.append(switcherContent);\r\n        //\r\n        // $mapDiv.find('.base-map-switcher').click(function() {\r\n        //      \"use strict\";\r\n        //      osmLayer.setVisible(!osmLayer.getVisible());\r\n        //      satLayer.setVisible(!satLayer.getVisible());\r\n        //\r\n        //      if (osmLayer.getVisible()){\r\n        //          $(this).css('background', aerialCss);\r\n        //      } else {\r\n        //          $(this).css('background', osmCss);\r\n        //      }\r\n        //  });\r\n    }\r\n    if (options.zoom < 0 || options.zoom > 28) {\r\n        throw 'zoom out of range';\r\n    }\r\n    if (options.center.x >= -180 && options.center.x <= 180 && options.center.y >= -90 && options.center.y <= 90) {\r\n        var p = new ol.geom.Point([options.center.x, options.center.y]);\r\n        new ol.proj.Projection({ code: \"EPSG:4326\" });\r\n        p.transform(new ol.proj.Projection({ code: \"EPSG:4326\" }), new ol.proj.Projection({ code: \"EPSG:3857\" }));\r\n        var coordinates = p.getCoordinates();\r\n        options.center.x = coordinates[0];\r\n        options.center.y = coordinates[1];\r\n    }\r\n    var controls = ol.control.defaults({\r\n        attributionOptions: { collapsible: false }\r\n    });\r\n    var view = new ol.View({\r\n        center: [options.center.x, options.center.y],\r\n        zoom: options.zoom,\r\n        minZoom: options.minZoom,\r\n        maxZoom: options.maxZoom\r\n    });\r\n    var map = new ol.Map({\r\n        layers: [osmLayer],\r\n        target: options.divId,\r\n        controls: controls,\r\n        view: view\r\n    });\r\n    if (options.fullScreen) {\r\n        map.addControl(new ol.control.FullScreen({}));\r\n    }\r\n    return map;\r\n}\r\nexports.quickMapBase = quickMapBase;\r\nnm.quickMapBase = quickMapBase;\r\nexports.default = quickMapBase;\r\n\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 12/14/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar provide_1 = __webpack_require__(0);\r\nvar nm = provide_1.default('olHelpers.zoomResolutionConvert');\r\nvar _zoomResLookup = [\r\n    156543.03392804097,\r\n    78271.51696402048,\r\n    39135.75848201024,\r\n    19567.87924100512,\r\n    9783.93962050256,\r\n    4891.96981025128,\r\n    2445.98490512564,\r\n    1222.99245256282,\r\n    611.49622628141,\r\n    305.748113140705,\r\n    152.8740565703525,\r\n    76.43702828517625,\r\n    38.21851414258813,\r\n    19.109257071294063,\r\n    9.554628535647032,\r\n    4.777314267823516,\r\n    2.388657133911758,\r\n    1.194328566955879,\r\n    0.5971642834779395,\r\n    0.29858214173896974,\r\n    0.14929107086948487,\r\n    0.07464553543474244,\r\n    0.03732276771737122,\r\n    0.01866138385868561,\r\n    0.009330691929342804,\r\n    0.004665345964671402,\r\n    0.002332672982335701,\r\n    0.0011663364911678506,\r\n    0.0005831682455839253 //28\r\n];\r\n/**\r\n * Get the resolution given the zoom level\r\n * @param {number} zoomLevel - the zoom level\r\n * @returns {number|*} the map resolution\r\n */\r\nfunction zoomToResolution(zoomLevel) {\r\n    \"use strict\";\r\n    if (typeof zoomLevel == 'number') {\r\n        if (zoomLevel % 1 === 0 && zoomLevel >= 0 && zoomLevel <= 28) {\r\n            return _zoomResLookup[zoomLevel];\r\n        }\r\n        else {\r\n            console.log(\"invalid zoom level provided: \" + zoomLevel);\r\n            return undefined;\r\n        }\r\n    }\r\n    else {\r\n        return undefined;\r\n    }\r\n}\r\nexports.zoomToResolution = zoomToResolution;\r\nnm.zoomToResolution = zoomToResolution;\r\n/**\r\n * Get resolution from the zoom level\r\n * @param {number} resolution - the resolution\r\n * @returns {number|*} the zoom level\r\n */\r\nfunction resolutionToZoom(resolution) {\r\n    for (var i = 0; i < _zoomResLookup.length; i++) {\r\n        if (resolution >= _zoomResLookup[i]) {\r\n            return i;\r\n        }\r\n    }\r\n    return 0;\r\n}\r\nexports.resolutionToZoom = resolutionToZoom;\r\nnm.resolutionToZoom = resolutionToZoom;\r\n\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports) {\n\nmodule.exports = jquery-ui;\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Created by gavorhes on 1/4/2016.\r\n */\r\nvar provide_1 = __webpack_require__(0);\r\nvar ol = __webpack_require__(2);\r\nvar nm = provide_1.default('olHelpers.esriToOlStyle');\r\n/**\r\n * This callback is displayed as part of the Requester class.\r\n * @callback styleFunc\r\n * @param {ol.Feature} feat - openlayers feature\r\n * @param {number} resolution - map resolution\r\n */\r\n/**\r\n *\r\n * @param {Array<number>} colorArray - input color array\r\n * @param {number} opacity - the opacity 0 to 1\r\n * @returns {string} rgba string\r\n * @private\r\n */\r\nfunction _colorArrayToRgba(colorArray, opacity) {\r\n    \"use strict\";\r\n    return \"rgba(\" + colorArray[0] + \",\" + colorArray[1] + \",\" + colorArray[2] + \",\" + opacity + \")\";\r\n}\r\n/**\r\n * escape html charcters\r\n * @param {string} str - input string\r\n * @returns {string} escaped string\r\n */\r\nfunction htmlEscape(str) {\r\n    return String(str)\r\n        .replace(/&/g, '&amp;')\r\n        .replace(/\"/g, '&quot;')\r\n        .replace(/'/g, '&#39;')\r\n        .replace(/</g, '&lt;')\r\n        .replace(/>/g, '&gt;');\r\n}\r\nnm.htmlEscape = htmlEscape;\r\nvar CommonSymbol = (function () {\r\n    /**\r\n     *\r\n     * @param symbolObj\r\n     * @param {number} opacity\r\n     */\r\n    function CommonSymbol(symbolObj, opacity) {\r\n        this.symbolObj = symbolObj;\r\n        this.opacity = opacity;\r\n        this.olStyle = undefined;\r\n        this.legendHtml = '';\r\n    }\r\n    return CommonSymbol;\r\n}());\r\nvar PointSymbol = (function (_super) {\r\n    __extends(PointSymbol, _super);\r\n    function PointSymbol(symbolObj, opacity) {\r\n        var _this = _super.call(this, symbolObj, opacity) || this;\r\n        switch (_this.symbolObj.type) {\r\n            case 'esriSMS':\r\n                var innerColor = _colorArrayToRgba(_this.symbolObj.color, _this.opacity);\r\n                var outerColor = _colorArrayToRgba(_this.symbolObj.outline.color, _this.opacity);\r\n                var outlineWidth = _this.symbolObj.outline.width;\r\n                var radius = _this.symbolObj.size;\r\n                _this.olStyle = new ol.style.Style({\r\n                    image: new ol.style.Circle({\r\n                        radius: radius,\r\n                        fill: new ol.style.Fill({\r\n                            color: innerColor\r\n                        }),\r\n                        stroke: new ol.style.Stroke({ color: outerColor, width: outlineWidth })\r\n                    })\r\n                });\r\n                _this.legendHtml = \"<span class=\\\"legend-layer-icon\\\" style=\\\"color: \" + innerColor + \"\\\">&#9679;</span>\";\r\n                break;\r\n            case 'esriPMS':\r\n                _this.olStyle = new ol.style.Style({\r\n                    image: new ol.style.Icon({ src: \"data:image/png;base64,\" + _this.symbolObj['imageData'] })\r\n                });\r\n                _this.legendHtml = \"<img class=\\\"legend-layer-icon\\\" height=\\\"17\\\" src=\\\"data:image/png;base64,\" + _this.symbolObj['imageData'] + \"\\\">\";\r\n                break;\r\n            default:\r\n                console.log(_this.symbolObj);\r\n                alert('Point symbol does not handle symbol type: ' + _this.symbolObj['type']);\r\n        }\r\n        return _this;\r\n    }\r\n    return PointSymbol;\r\n}(CommonSymbol));\r\nvar LineSymbol = (function (_super) {\r\n    __extends(LineSymbol, _super);\r\n    function LineSymbol(symbolObj, opacity) {\r\n        var _this = _super.call(this, symbolObj, opacity) || this;\r\n        switch (_this.symbolObj.type) {\r\n            case 'esriSLS':\r\n                var innerColor = _colorArrayToRgba(_this.symbolObj.color, _this.opacity);\r\n                var lineWidth = _this.symbolObj.width;\r\n                _this.olStyle = new ol.style.Style({\r\n                    stroke: new ol.style.Stroke({\r\n                        color: innerColor,\r\n                        //lineDash: [4],\r\n                        width: lineWidth\r\n                    })\r\n                });\r\n                _this.legendHtml = \"<span class=\\\"legend-layer-icon\\\" \";\r\n                _this.legendHtml += \"style=\\\"\";\r\n                _this.legendHtml += \"background-color: \" + innerColor + \";\";\r\n                _this.legendHtml += \"width: 40px;\";\r\n                _this.legendHtml += \"height: 4px;\";\r\n                _this.legendHtml += \"position: relative;\";\r\n                _this.legendHtml += \"display: inline-block;\";\r\n                _this.legendHtml += \"top: -1px;\";\r\n                _this.legendHtml += \"\\\"></span>\";\r\n                break;\r\n            default:\r\n                console.log(_this.symbolObj);\r\n                alert('Line symbol does not handle symbol type: ' + _this.symbolObj['type']);\r\n        }\r\n        return _this;\r\n    }\r\n    return LineSymbol;\r\n}(CommonSymbol));\r\nvar PolygonSymbol = (function (_super) {\r\n    __extends(PolygonSymbol, _super);\r\n    function PolygonSymbol(symbolObj, opacity) {\r\n        var _this = _super.call(this, symbolObj, opacity) || this;\r\n        switch (_this.symbolObj['type']) {\r\n            case 'esriSFS':\r\n                var innerColor = _colorArrayToRgba(_this.symbolObj.color, _this.opacity);\r\n                var outerColor = _colorArrayToRgba(_this.symbolObj.outline.color, _this.opacity);\r\n                var outlineWidth = _this.symbolObj.outline.width;\r\n                _this.olStyle = new ol.style.Style({\r\n                    stroke: new ol.style.Stroke({\r\n                        color: outerColor,\r\n                        //lineDash: [4],\r\n                        width: outlineWidth\r\n                    }),\r\n                    fill: new ol.style.Fill({\r\n                        color: innerColor\r\n                    })\r\n                });\r\n                _this.legendHtml = \"<span class=\\\"legend-layer-icon\\\" \";\r\n                _this.legendHtml += \"style=\\\"\";\r\n                _this.legendHtml += \"background-color: \" + innerColor + \";\";\r\n                _this.legendHtml += \"border: solid \" + outerColor + \" 1px;\";\r\n                _this.legendHtml += \"width: 40px;\";\r\n                _this.legendHtml += \"height: 9px;\";\r\n                _this.legendHtml += \"position: relative;\";\r\n                _this.legendHtml += \"display: inline-block;\";\r\n                _this.legendHtml += \"top: 2px;\";\r\n                _this.legendHtml += \"\\\"></span>\";\r\n                break;\r\n            default:\r\n                console.log(_this.symbolObj);\r\n                alert('Polygon symbol does handle symbol type: ' + _this.symbolObj['type']);\r\n        }\r\n        return _this;\r\n    }\r\n    return PolygonSymbol;\r\n}(CommonSymbol));\r\nvar SymbolGenerator = (function () {\r\n    function SymbolGenerator(esriResponse) {\r\n        this.opacity = (100 - (esriResponse['drawingInfo']['transparency'] || 0)) / 100;\r\n        this.renderer = esriResponse.drawingInfo.renderer;\r\n        this.olStyle = undefined;\r\n        this.legendHtml = '';\r\n    }\r\n    return SymbolGenerator;\r\n}());\r\nvar SingleSymbol = (function (_super) {\r\n    __extends(SingleSymbol, _super);\r\n    /**\r\n     *\r\n     * @param {object} esriResponse - layer info\r\n     * @param SymbolClass - the symbol class to use\r\n     */\r\n    function SingleSymbol(esriResponse, SymbolClass) {\r\n        var _this = _super.call(this, esriResponse) || this;\r\n        _this.symbol = _this.renderer.symbol;\r\n        var symbolObj = new SymbolClass(_this.symbol, _this.opacity);\r\n        _this.olStyle = symbolObj.olStyle;\r\n        _this.legendHtml = symbolObj.legendHtml;\r\n        return _this;\r\n    }\r\n    return SingleSymbol;\r\n}(SymbolGenerator));\r\nvar UniqueValueSymbol = (function (_super) {\r\n    __extends(UniqueValueSymbol, _super);\r\n    /**\r\n     *\r\n     * @param {object} esriResponse - layer info\r\n     * @param SymbolClass - the Symbol class definition\r\n     */\r\n    function UniqueValueSymbol(esriResponse, SymbolClass) {\r\n        var _this = _super.call(this, esriResponse) || this;\r\n        _this.uniqueValueInfos = _this.renderer['uniqueValueInfos'];\r\n        _this.propertyName = _this.renderer['field1'];\r\n        _this.defaultSymbol = _this.renderer['defaultSymbol'];\r\n        if (_this.defaultSymbol) {\r\n            var symbolObj = new SymbolClass(_this.defaultSymbol, _this.opacity);\r\n            _this.defaultStyle = symbolObj.olStyle;\r\n            _this.defaultLabelHtml = \"<span class=\\\"legend-layer-subitem\\\">\" + htmlEscape(_this.renderer['defaultLabel']) + \"</span>\" + symbolObj.legendHtml;\r\n        }\r\n        else {\r\n            _this.defaultStyle = undefined;\r\n            _this.defaultLabelHtml = 'other';\r\n        }\r\n        _this.valueArray = [];\r\n        _this.labelArray = [];\r\n        _this.legendArray = [];\r\n        _this.propertyStyleLookup = {};\r\n        for (var _i = 0, _a = _this.uniqueValueInfos; _i < _a.length; _i++) {\r\n            var uniqueVal = _a[_i];\r\n            _this.labelArray.push(uniqueVal['label']);\r\n            _this.valueArray.push(uniqueVal['value']);\r\n            var uniqueSym = new SymbolClass(uniqueVal.symbol, _this.opacity);\r\n            _this.legendArray.push(\"<span class=\\\"legend-layer-subitem\\\">\" + htmlEscape(uniqueVal['label']) + \"</span>\" + uniqueSym.legendHtml);\r\n            _this.propertyStyleLookup[uniqueVal['value']] = uniqueSym.olStyle;\r\n        }\r\n        _this.olStyle = function (feature) {\r\n            var checkProperties = feature.getProperties();\r\n            var checkProperty = checkProperties[_this.propertyName];\r\n            var returnValue;\r\n            if (_this.propertyStyleLookup[checkProperty] !== undefined) {\r\n                returnValue = [_this.propertyStyleLookup[checkProperty]];\r\n            }\r\n            else {\r\n                returnValue = [_this.defaultStyle];\r\n            }\r\n            return returnValue;\r\n        };\r\n        if (_this.defaultLabelHtml !== null) {\r\n            _this.legendArray.push(_this.defaultLabelHtml);\r\n        }\r\n        _this.legendHtml = '<ul>';\r\n        for (var _b = 0, _c = _this.legendArray; _b < _c.length; _b++) {\r\n            var h = _c[_b];\r\n            _this.legendHtml += \"<li>\" + h + \"</li>\";\r\n        }\r\n        _this.legendHtml += '</ul>';\r\n        return _this;\r\n    }\r\n    return UniqueValueSymbol;\r\n}(SymbolGenerator));\r\n/**\r\n * style and legend object\r\n * @typedef {object} styleAndLegend\r\n * @property {styleFunc} style - style function\r\n * @property {string} legend - legend content\r\n */\r\n/**\r\n *\r\n * @param {object} esriResponse - layer info\r\n * @returns {styleAndLegend} style and legend object\r\n */\r\nfunction makeFeatureServiceLegendAndSymbol(esriResponse) {\r\n    \"use strict\";\r\n    var renderer = esriResponse.drawingInfo.renderer;\r\n    var symbolLegendOut = null;\r\n    switch (renderer.type) {\r\n        case 'simple':\r\n            switch (esriResponse.geometryType) {\r\n                case 'esriGeometryPoint':\r\n                    symbolLegendOut = new SingleSymbol(esriResponse, PointSymbol);\r\n                    break;\r\n                case 'esriGeometryPolyline':\r\n                    symbolLegendOut = new SingleSymbol(esriResponse, LineSymbol);\r\n                    break;\r\n                case 'esriGeometryPolygon':\r\n                    symbolLegendOut = new SingleSymbol(esriResponse, PolygonSymbol);\r\n                    break;\r\n                default:\r\n                    console.log(esriResponse);\r\n                    alert(esriResponse.geometryType + ' not handled');\r\n            }\r\n            break;\r\n        case 'uniqueValue':\r\n            switch (esriResponse.geometryType) {\r\n                case 'esriGeometryPoint':\r\n                    symbolLegendOut = new UniqueValueSymbol(esriResponse, PointSymbol);\r\n                    break;\r\n                case 'esriGeometryPolyline':\r\n                    symbolLegendOut = new UniqueValueSymbol(esriResponse, LineSymbol);\r\n                    break;\r\n                case 'esriGeometryPolygon':\r\n                    symbolLegendOut = new UniqueValueSymbol(esriResponse, PolygonSymbol);\r\n                    break;\r\n                default:\r\n                    console.log(esriResponse);\r\n                    alert(esriResponse['geometryType'] + ' not handled');\r\n            }\r\n            break;\r\n        default:\r\n            alert('not handled renderer type: ' + renderer['type']);\r\n    }\r\n    if (symbolLegendOut == null) {\r\n        return { style: undefined, legend: '' };\r\n    }\r\n    else {\r\n        return { style: symbolLegendOut.olStyle, legend: symbolLegendOut.legendHtml };\r\n    }\r\n}\r\nexports.makeFeatureServiceLegendAndSymbol = makeFeatureServiceLegendAndSymbol;\r\nnm.makeFeatureServiceLegendAndSymbol = makeFeatureServiceLegendAndSymbol;\r\n/**\r\n *\r\n * @param {object} lyrObject - the layer as defined in the response\r\n * @param {boolean} [skipLayerNameAndExpander=false] use only icons\r\n * @returns {string} legend html\r\n */\r\nfunction mapServiceLegendItem(lyrObject, skipLayerNameAndExpander) {\r\n    if (skipLayerNameAndExpander === void 0) { skipLayerNameAndExpander = false; }\r\n    skipLayerNameAndExpander = typeof skipLayerNameAndExpander == 'boolean' ? skipLayerNameAndExpander : false;\r\n    var layerName = lyrObject['layerName'];\r\n    var legendItems = lyrObject['legend'];\r\n    var legendHtml = '';\r\n    if (!skipLayerNameAndExpander) {\r\n        legendHtml += \"<span class=\\\"legend-layer-subitem\\\">\" + layerName + \"</span>\";\r\n    }\r\n    if (legendItems.length == 1) {\r\n        legendHtml = \"<img class=\\\"legend-layer-icon\\\" height=\\\"17\\\" src=\\\"data:image/png;base64,\" + legendItems[0]['imageData'] + \"\\\">\";\r\n    }\r\n    else {\r\n        if (!skipLayerNameAndExpander) {\r\n            legendHtml += '<span class=\"legend-items-expander\" title=\"Expand/Collapse\">&#9660;</span>';\r\n        }\r\n        legendHtml += '<ul>';\r\n        for (var i = 0; i < legendItems.length; i++) {\r\n            legendHtml += \"<li>\";\r\n            legendHtml += \"<span class=\\\"legend-layer-subitem\\\">\" + htmlEscape(legendItems[i]['label']) + \"</span>\";\r\n            legendHtml += \"<img class=\\\"legend-layer-icon\\\" height=\\\"17\\\" src=\\\"data:image/png;base64,\" + legendItems[i]['imageData'] + \"\\\">\";\r\n            legendHtml += \"</li>\";\r\n        }\r\n        legendHtml += '</ul>';\r\n    }\r\n    if (!skipLayerNameAndExpander) {\r\n        legendHtml = \"<span class=\\\"legend-layer-subitem\\\">\" + layerName + \"</span>\" + legendHtml;\r\n    }\r\n    return legendHtml;\r\n}\r\n/**\r\n * make map service legent\r\n * @param {object} esriResponse - layer info\r\n * @returns {string} legend content\r\n */\r\nfunction makeMapServiceLegend(esriResponse) {\r\n    \"use strict\";\r\n    var newLegendHtml = '';\r\n    var layers = esriResponse['layers'];\r\n    if (layers.length == 1) {\r\n        newLegendHtml += mapServiceLegendItem(layers[0], true);\r\n    }\r\n    else {\r\n        newLegendHtml += '<ul>';\r\n        for (var i = 0; i < layers.length; i++) {\r\n            newLegendHtml += '<li>' + mapServiceLegendItem(layers[i]) + '</li>';\r\n        }\r\n        newLegendHtml += '</ul>';\r\n    }\r\n    return newLegendHtml;\r\n}\r\nexports.makeMapServiceLegend = makeMapServiceLegend;\r\nnm.makeMapServiceLegend = makeMapServiceLegend;\r\n\n\n/***/ }),\n/* 17 */,\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 11/2/2015.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar provide_1 = __webpack_require__(0);\r\nvar range_change_1 = __webpack_require__(19);\r\nvar $ = __webpack_require__(1);\r\nvar nm = provide_1.default('domUtil');\r\n/**\r\n * @callback mediaCallback\r\n * @param {number} tm\r\n */\r\nfunction timeToLocalDateString(tm) {\r\n    \"use strict\";\r\n    var d = new Date(tm);\r\n    var p1 = d.toLocaleTimeString().split(' ');\r\n    var p2 = p1[0].split(':');\r\n    p2 = p2.slice(0, 2);\r\n    return d.toLocaleDateString() + '<br>' + p2.join(':') + ' ' + p1[1];\r\n}\r\nvar MediaControl = (function () {\r\n    /**\r\n     *\r\n     * @param element\r\n     * @param changeFunc\r\n     * @param mediaConfig\r\n     */\r\n    function MediaControl(element, changeFunc, mediaConfig) {\r\n        if (changeFunc === void 0) { changeFunc = function () { return; }; }\r\n        if (mediaConfig === void 0) { mediaConfig = {}; }\r\n        var _this = this;\r\n        mediaConfig.min = typeof mediaConfig.min == 'number' ? mediaConfig.min : 0;\r\n        mediaConfig.max = typeof mediaConfig.max == 'number' ? mediaConfig.max : 100;\r\n        mediaConfig.val = typeof mediaConfig.val == 'number' ? mediaConfig.val : 0;\r\n        mediaConfig.step = typeof mediaConfig.step == 'number' ? mediaConfig.step : 5;\r\n        mediaConfig.playInterval = typeof mediaConfig.playInterval == 'number' ? mediaConfig.playInterval : 500;\r\n        mediaConfig.showAsDate = typeof mediaConfig.showAsDate == 'boolean' ? mediaConfig.showAsDate : false;\r\n        if (typeof element == 'string') {\r\n            this._container = $('#' + element);\r\n        }\r\n        else if (typeof element['style'] !== 'undefined') {\r\n            this._container = $(element);\r\n        }\r\n        else {\r\n            this._container = element;\r\n        }\r\n        this._container.addClass('media-control-container');\r\n        this._playInterval = mediaConfig.playInterval;\r\n        this._changeFunc = changeFunc;\r\n        this._showAsDate = mediaConfig.showAsDate;\r\n        this._currentValue = undefined;\r\n        this._min = undefined;\r\n        this._max = undefined;\r\n        this._step = undefined;\r\n        this._playing = false;\r\n        var htmlStr = '<span class=\"media-player-button media-back\"></span>' +\r\n            '<span class=\"media-player-button media-play\"></span>' +\r\n            '<span class=\"media-player-button media-pause media-disabled\"></span>' +\r\n            '<span class=\"media-player-button media-stop media-disabled\" ></span>' +\r\n            '<span class=\"media-player-button media-ahead\"></span>' +\r\n            \"<input type=\\\"range\\\">\" +\r\n            \"<div class=\\\"media-control-value-label-container\\\">\" +\r\n            \"<span class=\\\"media-control-value-label-min\\\"></span>\" +\r\n            \"<span class=\\\"media-control-value-label-val\\\"></span>\" +\r\n            \"<span class=\\\"media-control-value-label-max\\\"></span>\" +\r\n            \"</div>\";\r\n        this._container.append(htmlStr);\r\n        // let btnPause = this._container.find('.media-pause');\r\n        var btnPlay = this._container.find('.media-play');\r\n        this._$btnStop = this._container.find('.media-stop');\r\n        var btnAhead = this._container.find('.media-ahead');\r\n        var btnBack = this._container.find('.media-back');\r\n        this._$slider = this._container.find('input[type=range]');\r\n        this._$valLabelMin = this._container.find('.media-control-value-label-min');\r\n        this._$valLabelVal = this._container.find('.media-control-value-label-val');\r\n        this._$valLabelMax = this._container.find('.media-control-value-label-max');\r\n        this.setMinMaxValueStep(mediaConfig.min, mediaConfig.max, mediaConfig.val, mediaConfig.step);\r\n        range_change_1.rangeChange(this._$slider, function (newVal) { _this.currentValue = newVal; }, 100);\r\n        var ___this = this;\r\n        btnPlay.click(function () {\r\n            var $this = $(this);\r\n            $this.addClass('media-disabled');\r\n            ___this._$btnStop.removeClass('media-disabled');\r\n            btnAhead.addClass('media-locked');\r\n            btnBack.addClass('media-locked');\r\n            ___this._$slider.prop('disabled', true);\r\n            ___this._playing = true;\r\n            ___this._interval = setInterval(function () {\r\n                ___this.currentValue += ___this._step;\r\n            }, ___this._playInterval);\r\n        });\r\n        this._$btnStop.click(function () {\r\n            clearInterval(___this._interval);\r\n            var $this = $(this);\r\n            $this.addClass('media-disabled');\r\n            btnPlay.removeClass('media-disabled');\r\n            btnAhead.removeClass('media-locked');\r\n            btnBack.removeClass('media-locked');\r\n            ___this._$slider.prop('disabled', false);\r\n            ___this._playing = false;\r\n        });\r\n        btnAhead.click(function () {\r\n            ___this.currentValue = ___this.currentValue + ___this._step;\r\n        });\r\n        btnBack.click(function () {\r\n            ___this.currentValue = ___this.currentValue - ___this._step;\r\n        });\r\n    }\r\n    MediaControl.prototype.stopPlaying = function () {\r\n        if (this._playing) {\r\n            this._$btnStop.trigger('click');\r\n        }\r\n    };\r\n    Object.defineProperty(MediaControl.prototype, \"playing\", {\r\n        get: function () {\r\n            return this._playing;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MediaControl.prototype, \"min\", {\r\n        get: function () {\r\n            return this._min;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MediaControl.prototype, \"max\", {\r\n        get: function () {\r\n            return this._max;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MediaControl.prototype, \"step\", {\r\n        get: function () {\r\n            return this._step;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MediaControl.prototype, \"currentValue\", {\r\n        get: function () {\r\n            return this._currentValue;\r\n        },\r\n        set: function (newValue) {\r\n            if (newValue > this._max) {\r\n                newValue = this._min;\r\n            }\r\n            else if (newValue < this._min) {\r\n                newValue = this._max;\r\n            }\r\n            this._currentValue = newValue;\r\n            this._$slider.val(this._currentValue.toFixed(2));\r\n            if (this._showAsDate) {\r\n                this._$valLabelVal.html(timeToLocalDateString(this.currentValue));\r\n            }\r\n            else {\r\n                this._$valLabelVal.html(this.currentValue.toString());\r\n            }\r\n            this._changeFunc(newValue);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * set min and max value with step\r\n     * @param {number} newMin the new min\r\n     * @param {number} newMax the new mas\r\n     * @param {number} [newValue=newMin] the value to set\r\n     * @param {number} [newStep=(newMax-newMin)/20] step value\r\n     */\r\n    MediaControl.prototype.setMinMaxValueStep = function (newMin, newMax, newValue, newStep) {\r\n        this._min = newMin;\r\n        this._max = newMax;\r\n        newValue = typeof newValue == 'number' ? newValue : newMin;\r\n        newStep = typeof newStep == 'number' ? newStep : (newMax - newMin) / 20;\r\n        this._currentValue = newValue;\r\n        this._step = newStep;\r\n        this._$slider.prop('min', this.min.toString());\r\n        this._$slider.prop('max', this.max.toString());\r\n        this._$slider.prop('step', this.step.toString());\r\n        this._$slider.val(this.currentValue.toString());\r\n        if (this._showAsDate) {\r\n            this._$valLabelMin.html(timeToLocalDateString(this._min));\r\n            this._$valLabelVal.html(timeToLocalDateString(this.currentValue));\r\n            this._$valLabelMax.html(timeToLocalDateString(this._max));\r\n        }\r\n        else {\r\n            this._$valLabelMin.html(this._min.toString());\r\n            this._$valLabelVal.html(this.currentValue.toString());\r\n            this._$valLabelMax.html(this._max.toString());\r\n        }\r\n    };\r\n    Object.defineProperty(MediaControl.prototype, \"changeFunction\", {\r\n        /**\r\n         *\r\n         * @param {mediaCallback} newFunc the callback on change\r\n         */\r\n        set: function (newFunc) {\r\n            this._changeFunc = newFunc;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return MediaControl;\r\n}());\r\nexports.MediaControl = MediaControl;\r\nnm.MediaControl = MediaControl;\r\n\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar provide_1 = __webpack_require__(0);\r\nvar nm = provide_1.default('domUtil');\r\nvar mouseIn = false;\r\nvar mouseDown = false;\r\nvar timeout = null;\r\nvar dragged = false;\r\nvar lastVal;\r\n/**\r\n * Created by gavorhes on 11/2/2015.\r\n */\r\nfunction triggerCallback(callback, evt) {\r\n    \"use strict\";\r\n    var val = parseFloat(this.value);\r\n    var min = parseFloat(this.min);\r\n    var max = parseFloat(this.max);\r\n    var step = parseFloat(this.step);\r\n    if (max - val < step) {\r\n        val = max;\r\n    }\r\n    var percent = (val - min) / (max - min);\r\n    if (typeof lastVal == 'number' && val == lastVal) {\r\n        return;\r\n    }\r\n    lastVal = val;\r\n    callback(val, percent, evt);\r\n}\r\n/**\r\n * Add a variety of listeners for range inputs applied to a common callback\r\n * @param  $slider - jquery reference to the slider\r\n * @param {rangeChangeCallback} callback - the callback\r\n * @param {number} [changeTimeout=75] before the callback is called\r\n * @this {jQuery}\r\n * @returns {jQuery} the jQuery object\r\n */\r\nfunction rangeChange($slider, callback, changeTimeout) {\r\n    changeTimeout = typeof changeTimeout == 'number' ? changeTimeout : 75;\r\n    $slider.mouseenter(function () {\r\n        mouseIn = true;\r\n    });\r\n    $slider.mouseleave(function () {\r\n        mouseIn = false;\r\n        mouseDown = false;\r\n    });\r\n    $slider.mousedown(function () {\r\n        mouseDown = true;\r\n    });\r\n    $slider.mouseup(function () {\r\n        mouseDown = false;\r\n    });\r\n    $slider.mousemove(\r\n    /**\r\n     *\r\n     * @param {object} evt - event properties\r\n     * @this {HTMLElement}\r\n     */\r\n    function (evt) {\r\n        if (!(mouseIn && mouseDown)) {\r\n            return;\r\n        }\r\n        dragged = true;\r\n        if (lastVal == this['value']) {\r\n            return;\r\n        }\r\n        lastVal = this['value'];\r\n        if (timeout != null) {\r\n            clearTimeout(timeout);\r\n        }\r\n        var _this = this;\r\n        timeout = setTimeout(function () {\r\n            triggerCallback.call(_this, callback, evt);\r\n            timeout = null;\r\n        }, changeTimeout);\r\n    });\r\n    $slider.keyup(\r\n    /**\r\n     *\r\n     * @param {object} evt - event properties\r\n     */\r\n    function (evt) {\r\n        if (evt.keyCode == 37 || evt.keyCode == 39) {\r\n            triggerCallback.call(this, callback, evt);\r\n        }\r\n    });\r\n    $slider.change(function (evt) {\r\n        if (dragged) {\r\n            dragged = false;\r\n            return;\r\n        }\r\n        triggerCallback.call(this, callback, evt);\r\n    });\r\n    return this;\r\n}\r\nexports.rangeChange = rangeChange;\r\nnm.rangeChange = rangeChange;\r\n\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar LayerBase_1 = __webpack_require__(8);\r\nvar mapMove_1 = __webpack_require__(6);\r\nvar provide_1 = __webpack_require__(0);\r\nvar ol = __webpack_require__(2);\r\nvar $ = __webpack_require__(1);\r\nvar nm = provide_1.default('layers');\r\n/**\r\n * The Vector layer base\r\n * @augments LayerBase\r\n * @abstract\r\n */\r\nvar LayerBaseVector = (function (_super) {\r\n    __extends(LayerBaseVector, _super);\r\n    /**\r\n     * The base vector layer\r\n     * @param {string} url - pass an empty string to prevent default load and add from a json source\r\n     * @param {object} options - config\r\n     * @param {string} [options.id] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] the z index for the layer\r\n     * @param {function} [options.loadCallback] function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent] additional content to add to the legend\r\n     *\r\n     * @param {boolean} [options.autoLoad=false] if the layer should auto load if not visible\r\n     * @param {object} [options.style=undefined] the layer style, use openlayers default style if not defined\r\n     * @param {boolean} [options.onDemand=false] if the layer should be loaded by extent on map move\r\n     * @param {number} [options.onDemandDelay=300] delay before the map move callback should be called\r\n     * @param {mapMoveMakeGetParams} [options.mapMoveMakeGetParams=function(lyr, extent, zoomLevel){}] function to create additional map move params\r\n     * @param {MapMoveCls} [options.mapMoveObj=mapMove] alternate map move object for use with multi map pages\r\n     *\r\n     */\r\n    function LayerBaseVector(url, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _this = _super.call(this, url, options) || this;\r\n        options = options;\r\n        //prevent regular load if no url has been provided\r\n        if (_this.url.trim() == '') {\r\n            _this._loaded = true;\r\n        }\r\n        _this._style = typeof options.style == 'undefined' ? undefined : options.style;\r\n        if (_this.visible) {\r\n            _this._autoLoad = true;\r\n        }\r\n        else {\r\n            _this._autoLoad = (typeof options['autoLoad'] == 'boolean' ? options['autoLoad'] : false);\r\n        }\r\n        _this._onDemand = typeof options.onDemand == 'boolean' ? options.onDemand : false;\r\n        _this._onDemandDelay = typeof options.onDemandDelay == 'number' ? options.onDemandDelay : 300;\r\n        if (options.mapMoveObj) {\r\n            _this._mapMove = options.mapMoveObj;\r\n        }\r\n        else {\r\n            _this._mapMove = _this._onDemand ? mapMove_1.default : undefined;\r\n        }\r\n        _this._mapMoveMakeGetParams = typeof options.mapMoveMakeGetParams == 'function' ? options.mapMoveMakeGetParams :\r\n            function () { return {}; };\r\n        if (_this._onDemand) {\r\n            _this._loaded = true;\r\n            _this._mapMoveParams = {};\r\n            _this._mapMove.checkInit();\r\n            _this._mapMove.addVectorLayer(_this);\r\n        }\r\n        _this._source = new ol.source.Vector();\r\n        _this._olLayer = new ol.layer.Vector({\r\n            source: _this._source,\r\n            visible: _this.visible,\r\n            style: _this.style,\r\n            minResolution: _this._minResolution,\r\n            maxResolution: _this._maxResolution,\r\n            renderOrder: options.renderOrder\r\n        });\r\n        _this.olLayer.setZIndex(_this._zIndex);\r\n        _this._projectionMap = null;\r\n        _this._projection4326 = new ol.proj.Projection({ code: \"EPSG:4326\" });\r\n        return _this;\r\n    }\r\n    /**\r\n     * dummy to be overridden\r\n     * @param {object} featureCollection - geojson or esrijson object\r\n     */\r\n    LayerBaseVector.prototype.addFeatures = function (featureCollection) {\r\n        console.log('Layer vector base addFeatures is a placeholder and does nothing');\r\n    };\r\n    /**\r\n     * Before call to map move callback, can prevent call by returning false\r\n     * @param {number} zoom - zoom level\r\n     * @param {string} [evtType=undefined] undefined for initial load, otherwise one of 'change:center', 'change:resolution'\r\n     * @returns {boolean} if the call should proceed\r\n     */\r\n    LayerBaseVector.prototype.mapMoveBefore = function (zoom, evtType) {\r\n        if (this.minZoom !== undefined) {\r\n            if (zoom < this.minZoom) {\r\n                return false;\r\n            }\r\n        }\r\n        if (this.maxZoom !== undefined) {\r\n            if (zoom > this.maxZoom) {\r\n                return false;\r\n            }\r\n        }\r\n        return this.visible;\r\n    };\r\n    /**\r\n     * callback to generate the parameters passed in the get request\r\n     * @param {object} extent - extent object\r\n     * @param {number} extent.minX - minX\r\n     * @param {number} extent.minY - minY\r\n     * @param {number} extent.maxX - maxX\r\n     * @param {number} extent.maxY - maxY\r\n     * @param {number} zoomLevel - zoom level\r\n     */\r\n    LayerBaseVector.prototype.mapMoveMakeGetParams = function (extent, zoomLevel) {\r\n        this._mapMoveParams = {};\r\n        $.extend(this._mapMoveParams, this.params);\r\n        $.extend(this._mapMoveParams, this._mapMoveMakeGetParams(this, extent, zoomLevel));\r\n    };\r\n    /**\r\n     * callback function on map move\r\n     * @param {object} d - the json response\r\n     */\r\n    LayerBaseVector.prototype.mapMoveCallback = function (d) {\r\n        if (this.source) {\r\n            this._source.clear();\r\n        }\r\n    };\r\n    /**\r\n     * clear features in the layer\r\n     */\r\n    LayerBaseVector.prototype.clear = function () {\r\n        if (this._source) {\r\n            this._source.clear();\r\n        }\r\n    };\r\n    Object.defineProperty(LayerBaseVector.prototype, \"onDemandDelay\", {\r\n        /**\r\n         * get on demand delay in miliseconds\r\n         */\r\n        get: function () {\r\n            return this._onDemandDelay;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"autoLoad\", {\r\n        /**\r\n         * get if the layer is autoloaded\r\n         */\r\n        get: function () {\r\n            return this._autoLoad;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"style\", {\r\n        /**\r\n         * get the style definition\r\n         */\r\n        get: function () {\r\n            return this._style;\r\n        },\r\n        /**\r\n         * set the style\r\n         * @param style - the style or function\r\n         */\r\n        set: function (style) {\r\n            this._style = style;\r\n            this.olLayer.setStyle(this._style);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"mapCrs\", {\r\n        /**\r\n         * get the map CRS if it is defined by the map move object\r\n         */\r\n        get: function () {\r\n            return this.mapProj == null ? null : this.mapProj.getCode();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"mapProj\", {\r\n        get: function () {\r\n            if (this._projectionMap != null) {\r\n                return this._projectionMap;\r\n            }\r\n            if (this._mapMove) {\r\n                this._projectionMap = this._mapMove.map.getView().getProjection();\r\n                return this._projectionMap;\r\n            }\r\n            else {\r\n                return null;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"mapMove\", {\r\n        /**\r\n         * get the map move object\r\n         * @type {MapMoveCls|*}\r\n         */\r\n        get: function () {\r\n            return this._mapMove;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"mapMoveParams\", {\r\n        /**\r\n         * map move params\r\n         * @type {object}\r\n         */\r\n        get: function () {\r\n            return this._mapMoveParams;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"visible\", {\r\n        get: function () {\r\n            return this._visible;\r\n        },\r\n        /**\r\n         * Set the layer visibility\r\n         * @type {boolean}\r\n         * @override\r\n         */\r\n        set: function (visibility) {\r\n            _super.prototype.setVisible.call(this, visibility);\r\n            if (this._onDemand) {\r\n                this.mapMove.triggerLyrLoad(this);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"source\", {\r\n        /**\r\n         * get the layer vector source\r\n         * @override\r\n         */\r\n        get: function () {\r\n            return this.getSource();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"features\", {\r\n        /**\r\n         * array of ol features\r\n         */\r\n        get: function () {\r\n            return this.source.getFeatures();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseVector.prototype, \"olLayer\", {\r\n        /**\r\n         *\r\n         */\r\n        get: function () {\r\n            return _super.prototype.getOlLayer.call(this);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LayerBaseVector.prototype.setZIndex = function (newZ) {\r\n        this.olLayer.setZIndex(newZ);\r\n    };\r\n    return LayerBaseVector;\r\n}(LayerBase_1.LayerBase));\r\nexports.LayerBaseVector = LayerBaseVector;\r\nnm.LayerBaseVector = LayerBaseVector;\r\nexports.default = LayerBaseVector;\r\n\n\n/***/ }),\n/* 21 */,\n/* 22 */,\n/* 23 */,\n/* 24 */,\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 11/2/2015.\r\n */\r\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar LayerBaseVector_1 = __webpack_require__(20);\r\nvar esriToOl = __webpack_require__(16);\r\nvar provide_1 = __webpack_require__(0);\r\nvar ol = __webpack_require__(2);\r\nvar $ = __webpack_require__(1);\r\nvar nm = provide_1.default('layers');\r\n/**\r\n * Base layer for esri vector layers\r\n * @augments LayerBaseVector\r\n */\r\nvar LayerBaseVectorEsri = (function (_super) {\r\n    __extends(LayerBaseVectorEsri, _super);\r\n    /**\r\n     * The base vector layer\r\n     * @param {string} url - url for source\r\n     * @param {object} options - config\r\n     * @param {string} [options.id] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] the z index for the layer\r\n     * @param {function} [options.loadCallback] function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent] additional content to add to the legend\r\n     *\r\n     * @param {boolean} [options.autoLoad=false] if the layer should auto load if not visible\r\n     * @param {object} [options.style=undefined] the layer style, use openlayers default style if not defined\r\n     * @param {boolean} [options.onDemand=false] if the layer should be loaded by extent on map move\r\n     * @param {number} [options.onDemandDelay=300] delay before the map move callback should be called\r\n     * @param {MapMoveCls} [options.mapMoveObj=mapMove] alternate map move object for use with multi map pages\r\n     *\r\n     * @param {string} [options.where=1=1] the layer filter clause\r\n     * @param {string} [options.outFields=*] comma separated list of output fields, defaults to all\r\n     * @param {string} [options.format=pjson] the format the retrieve the data\r\n     * @param {number} [options.outSR=3857] the output spatial reference, defaults to web mercator\r\n     * @param {boolean} [options.useEsriStyle=false] if the map service style should be used\r\n     * @param {boolean} [options.collapseLegend=false] if the legend should be initially collapsed\r\n     * @param {number} [options.mapMoveMakeGetParams=function(extent, zoomLevel){}] function to create additional map move params\r\n     */\r\n    function LayerBaseVectorEsri(url, options) {\r\n        var _this = this;\r\n        if (typeof options.params != 'object') {\r\n            options.params = {};\r\n        }\r\n        options.params['where'] = options.where || '1=1';\r\n        options.params['outFields'] = options.outFields || '*';\r\n        options.params['f'] = options.format || 'pjson';\r\n        options.params['outSR'] = options.outSR || 3857;\r\n        _this = _super.call(this, url, options) || this;\r\n        _this._outSR = _this.params['outSR'];\r\n        _this._esriFormat = new ol.format.EsriJSON();\r\n        if (_this._url[_this._url.length - 1] !== '/') {\r\n            _this._url += '/';\r\n        }\r\n        _this._urlCopy = _this.url;\r\n        _this._url += 'query?callback=?';\r\n        if (_this.autoLoad || _this.visible) {\r\n            _this._load();\r\n        }\r\n        _this._useEsriStyle = typeof options.useEsriStyle == 'boolean' ? options.useEsriStyle : false;\r\n        if (_this._useEsriStyle) {\r\n            _this.addLegendContent();\r\n        }\r\n        return _this;\r\n    }\r\n    /**\r\n     * add additional content to the legend\r\n     * @param {string} [additionalContent=''] additional content to add to legend\r\n     */\r\n    LayerBaseVectorEsri.prototype.addLegendContent = function (additionalContent) {\r\n        var _this = this;\r\n        if (!this._useEsriStyle) {\r\n            _super.prototype.addLegendContent.call(this, additionalContent);\r\n        }\r\n        else {\r\n            $.get(this._urlCopy + '?f=pjson&callback=?', {}, function (d) {\r\n                if (d['subLayers'].length > 0) {\r\n                    alert('should only use single feature layers, not groups');\r\n                    return;\r\n                }\r\n                var newStyleAndLegend = esriToOl.makeFeatureServiceLegendAndSymbol(d);\r\n                _this.style = newStyleAndLegend.style;\r\n                _super.prototype.addLegendContent.call(_this, newStyleAndLegend.legend);\r\n            }, 'json');\r\n        }\r\n    };\r\n    /**\r\n     * add feature collection\r\n     * @param {object} featureCollection - features as esrijson\r\n     */\r\n    LayerBaseVectorEsri.prototype.addFeatures = function (featureCollection) {\r\n        var feats = this._esriFormat.readFeatures(featureCollection);\r\n        this.source.addFeatures(feats);\r\n    };\r\n    /**\r\n     * trigger load features\r\n     * @protected\r\n     * @returns {boolean} if already loaded\r\n     */\r\n    LayerBaseVectorEsri.prototype._load = function () {\r\n        var _this = this;\r\n        if (_super.prototype._load.call(this)) {\r\n            return true;\r\n        }\r\n        $.get(this._url, this.params, function (d) {\r\n            _this.addFeatures(d);\r\n            _this.loadCallback(_this);\r\n        }, 'json').fail(function () {\r\n            _this._loaded = false;\r\n        });\r\n        return false;\r\n    };\r\n    /**\r\n     * callback to generate the parameters passed in the get request\r\n     * @param {object} extent - extent object\r\n     * @param {number} extent.minX - minX\r\n     * @param {number} extent.minY - minY\r\n     * @param {number} extent.maxX - maxX\r\n     * @param {number} extent.maxY - maxY\r\n     * @param {number} zoomLevel - zoom level\r\n     */\r\n    LayerBaseVectorEsri.prototype.mapMoveMakeGetParams = function (extent, zoomLevel) {\r\n        _super.prototype.mapMoveMakeGetParams.call(this, extent, zoomLevel);\r\n        this.mapMoveParams['geometry'] = extent.minX + \",\" + extent.minY + \",\" + extent.maxX + \",\" + extent.maxY;\r\n        this.mapMoveParams['geometryType'] = 'esriGeometryEnvelope';\r\n        this.mapMoveParams['spatialRel'] = 'esriSpatialRelIntersects';\r\n        this.mapMoveParams['spatialRel'] = 'esriSpatialRelIntersects';\r\n        this.mapMoveParams['inSR'] = 3857;\r\n        if (this._outSR == 3857) {\r\n            this.mapMoveParams['geometryPrecision'] = 1;\r\n        }\r\n    };\r\n    /**\r\n     * Before call to map move callback, can prevent call by returning false\r\n     * @param {number} zoom - zoom level\r\n     * @param {string} [evtType=undefined] undefined for initial load, otherwise one of 'change:center', 'change:resolution'\r\n     * @returns {boolean} if the call should proceed\r\n     */\r\n    LayerBaseVectorEsri.prototype.mapMoveBefore = function (zoom, evtType) {\r\n        return _super.prototype.mapMoveBefore.call(this, zoom, evtType);\r\n        //if (super.mapMoveBefore(zoom, evtType)){\r\n        //    //place holder for additional processing\r\n        //    return true;\r\n        //} else {\r\n        //    return false;\r\n        //}\r\n    };\r\n    /**\r\n     * callback function on map move\r\n     * @param {object} d - the json response\r\n     */\r\n    LayerBaseVectorEsri.prototype.mapMoveCallback = function (d) {\r\n        _super.prototype.mapMoveCallback.call(this, d);\r\n        this.source.addFeatures(this._esriFormat.readFeatures(d));\r\n    };\r\n    return LayerBaseVectorEsri;\r\n}(LayerBaseVector_1.LayerBaseVector));\r\nexports.LayerBaseVectorEsri = LayerBaseVectorEsri;\r\nnm.LayerBaseVectorEsri = LayerBaseVectorEsri;\r\nexports.default = LayerBaseVectorEsri;\r\n\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by gavorhes on 11/4/2015.\r\n */\r\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar LayerBaseXyzTile_1 = __webpack_require__(29);\r\nvar RealEarthAnimateTile_1 = __webpack_require__(32);\r\nvar provide_1 = __webpack_require__(0);\r\nvar nm = provide_1.default('layers');\r\n/**\r\n * Real earth tile\r\n * @augments LayerBaseXyzTile\r\n */\r\nvar LayerRealEarthTile = (function (_super) {\r\n    __extends(LayerRealEarthTile, _super);\r\n    /**\r\n     * The base layer for all others\r\n     * @param {object} options - config\r\n     * @param {string} [options.id] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] the z index for the layer\r\n     * @param {function} [options.loadCallback] function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent] additional content to add to the legend\r\n     *\r\n     * @param {string} options.products - the products to request\r\n     * @param {boolean} [options.hasTimes=false] If the layer is time dependent, fixed set of dates\r\n     * @param {boolean} [options.animate=false] if the layer should be animated\r\n     */\r\n    function LayerRealEarthTile(options) {\r\n        var _this = this;\r\n        options.animate = typeof options.animate == 'boolean' ? options.animate : false;\r\n        if (options.animate) {\r\n            _this = _super.call(this, '', options) || this;\r\n            _this._products = options.products;\r\n            _this.animator = new RealEarthAnimateTile_1.default(_this, options.timeLoadCallback);\r\n            _this.animator.timeInit();\r\n        }\r\n        else {\r\n            _this = _super.call(this, \"http://realearth.ssec.wisc.edu/api/image?products=\" + options.products + \"&x={x}&y={y}&z={z}\", options) || this;\r\n            _this._products = options.products;\r\n        }\r\n        return _this;\r\n    }\r\n    LayerRealEarthTile.prototype.setLayerTime = function (theTime) {\r\n        if (this.animator) {\r\n            return this.animator.setLayerTime(theTime);\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    };\r\n    LayerRealEarthTile.prototype._load = function () {\r\n        if (this.animator) {\r\n            return false;\r\n        }\r\n        return _super.prototype._load.call(this);\r\n    };\r\n    return LayerRealEarthTile;\r\n}(LayerBaseXyzTile_1.LayerBaseXyzTile));\r\nexports.LayerRealEarthTile = LayerRealEarthTile;\r\nnm.LayerRealEarthTile = LayerRealEarthTile;\r\nexports.default = LayerRealEarthTile;\r\n\n\n/***/ }),\n/* 27 */,\n/* 28 */,\n/* 29 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Created by gavorhes on 12/4/2015.\r\n */\r\nvar LayerBase_1 = __webpack_require__(8);\r\nvar provide_1 = __webpack_require__(0);\r\nvar ol = __webpack_require__(2);\r\nvar nm = provide_1.default('layers');\r\n/**\r\n * XYZ tile\r\n * @augments LayerBase\r\n */\r\nvar LayerBaseXyzTile = (function (_super) {\r\n    __extends(LayerBaseXyzTile, _super);\r\n    /**\r\n     * The XYZ tile layer\r\n     * @param {string} url - url for source\r\n     * @param {object} options - config\r\n     * @param {string} [options.id] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] the z index for the layer\r\n     * @param {function} [options.loadCallback] function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent] additional content to add to the legend\r\n     * @param {boolean} [options.useEsriStyle=false] if the map service style should be used\r\n     */\r\n    function LayerBaseXyzTile(url, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _this = _super.call(this, url, options) || this;\r\n        _this._source = new ol.source.XYZ({ url: _this.url == '' ? undefined : _this.url });\r\n        _this._olLayer = new ol.layer.Tile({\r\n            source: _this._source,\r\n            visible: _this.visible,\r\n            opacity: _this.opacity,\r\n            minResolution: _this._minResolution,\r\n            maxResolution: _this._maxResolution\r\n        });\r\n        _this._olLayer.setZIndex(_this._zIndex);\r\n        return _this;\r\n    }\r\n    Object.defineProperty(LayerBaseXyzTile.prototype, \"source\", {\r\n        /**\r\n         *\r\n         * @returns {ol.source.XYZ} the vector source\r\n         */\r\n        get: function () {\r\n            return this._source;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerBaseXyzTile.prototype, \"olLayer\", {\r\n        /**\r\n         *\r\n         * @returns {ol.layer.Tile|ol.layer.Base|undefined} the ol layer\r\n         */\r\n        get: function () {\r\n            return this._olLayer;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return LayerBaseXyzTile;\r\n}(LayerBase_1.LayerBase));\r\nexports.LayerBaseXyzTile = LayerBaseXyzTile;\r\nnm.LayerBaseXyzTile = LayerBaseXyzTile;\r\nexports.default = LayerBaseXyzTile;\r\n\n\n/***/ }),\n/* 30 */,\n/* 31 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Created by gavorhes on 12/4/2015.\r\n */\r\nvar provide_1 = __webpack_require__(0);\r\nvar mapPopup_1 = __webpack_require__(4);\r\nvar $ = __webpack_require__(1);\r\nvar nm = provide_1.default('mixin');\r\n/**\r\n * The GMT offset time in minutes\r\n * @type {number}\r\n */\r\nvar offsetMinutes = (new Date()).getTimezoneOffset();\r\n/**\r\n * Mixin to get the product times\r\n * Be sure to call getTimeInit after the mixin has been applied\r\n */\r\nvar RealEarthAnimate = (function () {\r\n    function RealEarthAnimate(lyr, loadCallback) {\r\n        this.lyr = lyr;\r\n        this._products = lyr._products;\r\n        if (loadCallback) {\r\n            this.loadCallback = loadCallback;\r\n        }\r\n        else {\r\n            this.loadCallback = function () { return; };\r\n        }\r\n    }\r\n    /**\r\n     * Call this after the mixin has been applied\r\n     */\r\n    RealEarthAnimate.prototype.timeInit = function () {\r\n        var _this = this;\r\n        this._rawDateStrings = [];\r\n        this._localDates = [];\r\n        this.localTimes = [];\r\n        this._animateEnabled = true;\r\n        // this._loaded = true;\r\n        this._currentTime = undefined;\r\n        this._currentIndex = undefined;\r\n        $.get('http://realearth.ssec.wisc.edu/api/products', { products: this._products }, function (d) {\r\n            if (d.length == 0) {\r\n                console.log(_this._products + \" layer not available or does not have times\");\r\n                return;\r\n            }\r\n            d = d[0];\r\n            for (var i = 0; i < d['times'].length; i++) {\r\n                _this._loadDates.call(_this, d['times'][i]);\r\n            }\r\n            _this.loadCallback.call(_this.lyr, _this.lyr);\r\n            _this._loadLatest.call(_this);\r\n        }, 'json');\r\n    };\r\n    /**\r\n     * Given the raw time string, add to the arrays to keep track of dates and cache\r\n     * @param {string} inString - input string to parse\r\n     * @returns {string} the converted string\r\n     * @protected\r\n     */\r\n    RealEarthAnimate.prototype._loadDates = function (inString) {\r\n        var yr = inString.slice(0, 4);\r\n        var month = inString.slice(4, 6);\r\n        var d = inString.slice(6, 8);\r\n        var hr = inString.slice(9, 11);\r\n        var mn = inString.slice(11, 13);\r\n        var sec = inString.slice(13, 15);\r\n        var rawDateStr = inString.replace('.', '_');\r\n        this._rawDateStrings.push(rawDateStr);\r\n        var dteStr = month + \"/\" + d + \"/\" + yr + \" \" + hr + \":\" + mn + \":\" + sec;\r\n        var newDte = new Date(dteStr);\r\n        newDte.setMinutes(newDte.getMinutes() - offsetMinutes);\r\n        this._localDates.push(newDte);\r\n        this.localTimes.push(newDte.getTime());\r\n        return rawDateStr;\r\n    };\r\n    /**\r\n     *\r\n     * @protected\r\n     * @returns {boolean} if should continue\r\n     */\r\n    RealEarthAnimate.prototype._loadLatest = function () {\r\n        mapPopup_1.default.closePopup();\r\n        if (this.localTimes.length > 0) {\r\n            this._currentIndex = this.localTimes.length - 1;\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    };\r\n    /**\r\n     *\r\n     * @param {number} theTime - the time\r\n     * @returns {boolean} true if new index, false if the same or below lowest value\r\n     */\r\n    RealEarthAnimate.prototype.setLayerTime = function (theTime) {\r\n        this._currentTime = theTime;\r\n        var newIndex;\r\n        if (theTime < this.localTimes[0]) {\r\n            return false;\r\n        }\r\n        else if (theTime > this.localTimes[this.localTimes.length - 1]) {\r\n            newIndex = this.localTimes.length - 1;\r\n        }\r\n        for (var i = 0; i < this.localTimes.length; i++) {\r\n            if (this.localTimes[i] >= theTime) {\r\n                newIndex = i;\r\n                break;\r\n            }\r\n        }\r\n        if (newIndex == this._currentIndex) {\r\n            return false;\r\n        }\r\n        else {\r\n            this._currentIndex = newIndex;\r\n            mapPopup_1.default.closePopup();\r\n            return true;\r\n        }\r\n    };\r\n    return RealEarthAnimate;\r\n}());\r\nexports.RealEarthAnimate = RealEarthAnimate;\r\nnm.RealEarthAnimate = RealEarthAnimate;\r\nexports.default = RealEarthAnimate;\r\n\n\n/***/ }),\n/* 32 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Created by gavorhes on 12/4/2015.\r\n */\r\nvar RealEarthAnimate_1 = __webpack_require__(31);\r\nvar provide_1 = __webpack_require__(0);\r\nvar nm = provide_1.default('mixin');\r\n/**\r\n * Animate real earth tile\r\n * @augments RealEarthAnimate\r\n */\r\nvar RealEarthAnimateTile = (function (_super) {\r\n    __extends(RealEarthAnimateTile, _super);\r\n    function RealEarthAnimateTile(layer, loadCallback) {\r\n        var _this = _super.call(this, layer, loadCallback) || this;\r\n        _this._source = layer.source;\r\n        _this._olLayer = layer.olLayer;\r\n        return _this;\r\n    }\r\n    RealEarthAnimateTile.prototype.timeInit = function () {\r\n        _super.prototype.timeInit.call(this);\r\n        this._sourceUrls = [];\r\n    };\r\n    RealEarthAnimateTile.prototype._loadDates = function (inString) {\r\n        var rawDte = _super.prototype._loadDates.call(this, inString);\r\n        var dteProductUrl = \"http://realearth.ssec.wisc.edu/api/image?products=\" + this._products + \"_\" + rawDte + \"&x={x}&y={y}&z={z}\";\r\n        this._sourceUrls.push(dteProductUrl);\r\n        return '';\r\n    };\r\n    /**\r\n     * @protected\r\n     */\r\n    RealEarthAnimateTile.prototype._loadLatest = function () {\r\n        if (_super.prototype._loadLatest.call(this)) {\r\n            this._source.setUrl(this._sourceUrls[this._sourceUrls.length - 1]);\r\n        }\r\n        return true;\r\n    };\r\n    RealEarthAnimateTile.prototype.setLayerTime = function (theTime) {\r\n        if (_super.prototype.setLayerTime.call(this, theTime)) {\r\n            if (this._olLayer.getZIndex() < 0) {\r\n                this._olLayer.setZIndex(0);\r\n            }\r\n            this._source.setUrl(this._sourceUrls[this._currentIndex]);\r\n        }\r\n        else {\r\n            this._olLayer.setZIndex(-1);\r\n        }\r\n        return true;\r\n    };\r\n    return RealEarthAnimateTile;\r\n}(RealEarthAnimate_1.default));\r\nnm.RealEarthAnimateTile = RealEarthAnimateTile;\r\nexports.default = RealEarthAnimateTile;\r\n\n\n/***/ }),\n/* 33 */,\n/* 34 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar quickMap_1 = __webpack_require__(7);\r\nvar LayerRealEarthTile_1 = __webpack_require__(26);\r\nvar media_control_1 = __webpack_require__(18);\r\nvar $ = __webpack_require__(1);\r\nvar LayerBaseVectorEsri_1 = __webpack_require__(25);\r\nvar LayerEsriMapServer_1 = __webpack_require__(10);\r\n__webpack_require__(15);\r\nvar nexrhresStatic = new LayerRealEarthTile_1.default({\r\n    products: 'nexrhres',\r\n    id: 'nexrhres-static',\r\n    opacity: 0.6,\r\n    animate: true,\r\n    name: 'Hybrid Reflectivity',\r\n    // maxZoom: 10,\r\n    timeLoadCallback: function (f) {\r\n        console.log(f);\r\n    }\r\n});\r\nvar d = new Date();\r\nvar endTime = d.getTime();\r\nd.setHours(d.getHours() - 4);\r\nvar startTime = d.getTime();\r\nvar rangeStep = Math.round((endTime - startTime) / 8);\r\nvar media = new media_control_1.MediaControl($('#control'), function (v) {\r\n    nexrhresStatic.setLayerTime(v);\r\n}, {\r\n    min: startTime,\r\n    max: endTime,\r\n    val: endTime,\r\n    step: rangeStep,\r\n    playInterval: 750,\r\n    showAsDate: true\r\n});\r\nvar map = quickMap_1.quickMap();\r\nmap.addLayer(nexrhresStatic.olLayer);\r\nvar coordinationLayer = new LayerBaseVectorEsri_1.LayerBaseVectorEsri('http://transportal.cee.wisc.edu/applications/arcgis2/rest/services/GLRTOC/GlrtocCoordination/MapServer/0', {\r\n    visible: true,\r\n    autoLoad: true,\r\n    name: 'Coordination',\r\n    useEsriStyle: true\r\n});\r\nmap.addLayer(coordinationLayer.olLayer);\r\nvar oakRidgeLayers = [\r\n    ['Cameras', 'cameras33'],\r\n    ['HAR', 'HAR33'],\r\n    ['DMS', 'MessageSigns33'],\r\n    //['State Summary', 'statesummary'],\r\n    ['Traffic Control', 'TrafficControl33'],\r\n    ['Traffic Detection', 'TrafficDetectionMulti'],\r\n    ['Weather', 'Weather33']\r\n];\r\nfor (var i = 0; i < oakRidgeLayers.length; i++) {\r\n    var oakRidgeLayer = new LayerEsriMapServer_1.LayerEsriMapServer(\"http://itsdpro.ornl.gov/arcgis/rest/services/ITSPublic/\" + oakRidgeLayers[i][1] + \"/MapServer\", {\r\n        id: oakRidgeLayers[i][1],\r\n        name: oakRidgeLayers[i][0],\r\n        visible: true,\r\n        minZoom: 7,\r\n        zIndex: 20,\r\n        addPopup: true,\r\n        legendCollapse: true\r\n    });\r\n    map.addLayer(oakRidgeLayer.olLayer);\r\n}\r\n\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// animate.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 34);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 95f473b09da6d84b9b8b","/**\r\n * Created by gavorhes on 12/10/2015.\r\n */\r\n\r\n\r\n/**\r\n * create a namespace on the gv object\r\n * @param {string} namespace to create\r\n * @returns {object} object representing the namespace\r\n */\r\nfunction provide(namespace){\r\n    \"use strict\";\r\n    if (typeof window['gv'] == 'undefined'){\r\n        window['gv'] = {};\r\n    }\r\n\r\n    let parts = namespace.split('.');\r\n    let nameSpace = window['gv'];\r\n\r\n    for (let i=0; i< parts.length; i++){\r\n        let newObject = nameSpace[parts[i]];\r\n\r\n        if (typeof newObject == 'undefined'){\r\n            nameSpace[parts[i]] = {};\r\n        }\r\n\r\n        nameSpace = nameSpace[parts[i]];\r\n    }\r\n\r\n    return nameSpace;\r\n}\r\n\r\nprovide('util');\r\nwindow['gv'].util.provide = provide;\r\n\r\nexport default provide;\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/util/provide.ts","module.exports = $;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"$\"\n// module id = 1\n// module chunks = 0 1 2 3 4 5 6","module.exports = ol;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ol\"\n// module id = 2\n// module chunks = 0 1 2 3","/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\n\r\nimport provide from './provide';\r\nlet nm = provide('util');\r\n\r\n\r\n/**\r\n * guids are used to uniquely identify groups and features\r\n * @returns {string} a new guid\r\n */\r\nfunction makeGuid() {\r\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'\r\n            .replace(/[xy]/g, function (c) {\r\n                let r = Math.random() * 16 | 0, v = c == 'x' ? r : r & 0x3 | 0x8;\r\n\r\n                return v.toString(16);\r\n            });\r\n\r\n}\r\nnm.makeGuid = makeGuid;\r\nexport default makeGuid;\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/util/makeGuid.ts","/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\n\r\nimport MapPopupCls from './mapPopupCls';\r\n\r\n/**\r\n * The single popup object catch is that it is common to multimap pages\r\n * @type {MapPopupCls}\r\n */\r\nexport const mapPopup = new MapPopupCls() as MapPopupCls;\r\nexport default mapPopup;\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/olHelpers/mapPopup.ts","/**\r\n * Created by gavorhes on 12/8/2015.\r\n */\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nconst nm = provide('olHelpers');\r\n\r\n\r\n\r\n/**\r\n * base interaction\r\n */\r\nexport class MapInteractionBase {\r\n    _map: ol.Map;\r\n    _initialized: boolean;\r\n    _subtype: string;\r\n\r\n    /**\r\n     * map interaction base\r\n     * @param subtype - the interaction subtype\r\n     */\r\n    constructor(subtype: string) {\r\n        this._map = null;\r\n        this._initialized = false;\r\n        this._subtype = subtype;\r\n    }\r\n\r\n    /**\r\n     * base initializer, returns true for already initialized\r\n     * @param theMap - the ol Map\r\n     * @returns true for already initialized\r\n     */\r\n    init(theMap: ol.Map){\r\n        if (!this._initialized){\r\n            this._map = theMap;\r\n            this._initialized = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * get reference to the ol map object\r\n     * @returns {ol.Map} the map object\r\n     */\r\n    get map() {\r\n        return this._map;\r\n    }\r\n\r\n    /**\r\n     * get if is initialized\r\n     * @returns {boolean} is initialized\r\n     */\r\n    get initialized() {\r\n        return this._initialized;\r\n    }\r\n\r\n    /**\r\n     * Check the initialization status and throw exception if not valid yet\r\n     * @protected\r\n     */\r\n    _checkInit() {\r\n        if (!this.initialized) {\r\n            let msg = `${this._subtype} object not initialized`;\r\n            alert(msg);\r\n            console.log(msg);\r\n            throw msg;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Check the initialization status and throw exception if not valid yet\r\n     */\r\n    checkInit(){\r\n        this._checkInit();\r\n    }\r\n}\r\n\r\nnm.MapInteractionBase = MapInteractionBase;\r\nexport default MapInteractionBase;\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/olHelpers/mapInteractionBase.ts","/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\n\r\nimport MapMoveCls from './mapMoveCls';\r\n\r\n/**\r\n * The single map move object catch is that it is common to multimap pages\r\n * @type {MapMoveCls}\r\n */\r\n\r\nexport const mapMove = new MapMoveCls();\r\nexport default mapMove;\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/olHelpers/mapMove.ts","/**\r\n * Created by gavorhes on 12/15/2015.\r\n */\r\n\r\nimport {quickMapOptions, quickMapBase} from './quickMapBase';\r\nimport provide from '../util/provide';\r\nimport mapMove from './mapMove';\r\nimport mapPopup from './mapPopup';\r\nimport ol = require('custom-ol');\r\nlet nm = provide('olHelpers');\r\n\r\n/**\r\n * Sets up a map with some default parameters and initializes\r\n * mapMove and mapPopup\r\n *\r\n * @param {object} [options={}] config options\r\n * @param {string} [options.divId=map] map div id\r\n * @param {object} [options.center={}] center config object\r\n * @param {number} [options.center.x=-10018378] center x, web mercator x or lon\r\n * @param {number} [options.center.y=5574910] center y, web mercator y or lat\r\n * @param {number} [options.zoom=7] zoom level\r\n * @param {number} [options.minZoom=undefined] min zoom\r\n * @param {number} [options.maxZoom=undefined] max zoom\r\n * @param {boolean} [options.baseSwitcher=true] if add base map switcher\r\n * @param {boolean} [options.fullScreen=false] if add base map switcher\r\n * @returns {ol.Map} the ol map\r\n */\r\nexport function quickMap(options? : quickMapOptions): ol.Map {\r\n    let m = quickMapBase(options);\r\n    mapMove.init(m);\r\n    mapPopup.init(m);\r\n\r\n    return m;\r\n}\r\n\r\n\r\nnm.quickMap = quickMap;\r\nexport default quickMap;\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/olHelpers/quickMap.ts","import * as zoomResolutionConvert from '../olHelpers/zoomResolutionConvert';\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nimport makeGuid from '../util/makeGuid';\r\nimport $ = require('jquery');\r\n\r\nconst nm = provide('layers');\r\n\r\n\r\nexport interface LayerBaseOptions{\r\n    id?: string;\r\n    name?: string;\r\n    opacity?: number;\r\n    visible?: boolean;\r\n    minZoom?: number;\r\n    maxZoom?: number;\r\n    params?: any;\r\n    zIndex?: number;\r\n    loadCallback?: Function;\r\n    legendCollapse?: boolean;\r\n    legendCheckbox?: boolean;\r\n    legendContent?: string;\r\n}\r\n\r\n\r\n/**\r\n * The base layer class\r\n * @abstract\r\n */\r\nexport abstract class LayerBase {\r\n\r\n    protected _legendCheckbox: boolean;\r\n    protected _url: string;\r\n    protected _opacity: number;\r\n    protected _minZoom: number;\r\n    protected _maxZoom: number;\r\n    protected _visible: boolean;\r\n    protected _loaded: boolean;\r\n    protected _zIndex: number;\r\n    protected _legendContent: string;\r\n    protected _params: any;\r\n    protected _id: string;\r\n    protected _name: string;\r\n    protected _source: ol.source.Source;\r\n    protected _animate: boolean;\r\n    protected _legendCollapse: boolean;\r\n    protected _maxResolution: number;\r\n    protected _minResolution: number;\r\n    protected  _$legendDiv: JQuery;\r\n    loadCallback: Function;\r\n    protected _olLayer: ol.layer.Layer;\r\n    protected _applyCollapseCalled: boolean;\r\n\r\n\r\n\r\n    /**\r\n     * The base layer for all others\r\n     * @param {string} url - url for source\r\n     * @param {object} options - config\r\n     * @param {string} [options.id=makeGuid()] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] - the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] - the z index for the layer\r\n     * @param {function} [options.loadCallback] - function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] - if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] - if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent=undefined] - additional content to add to the legend\r\n     */\r\n    constructor(url: string, options: LayerBaseOptions = {}) {\r\n        options = options || {} as LayerBaseOptions;\r\n\r\n        if (typeof url !== 'string') {\r\n            throw 'Invalid URL';\r\n        }\r\n        this._url = url;\r\n\r\n\r\n        this._params = typeof options.params == 'object' ? options.params : {};\r\n        this._legendCollapse = typeof options.legendCollapse == 'boolean' ? options.legendCollapse : false;\r\n        this._legendCheckbox = typeof options.legendCheckbox == 'boolean' ? options.legendCheckbox : true;\r\n\r\n        this.id = options.id || makeGuid();\r\n        this._name = options.name || 'Unnamed Layer';\r\n        this.animate = false;\r\n        this._opacity = typeof options.opacity == 'number' ? options.opacity : 1;\r\n\r\n        if (this._opacity > 1) {\r\n            this._opacity = 1;\r\n        } else if (this._opacity < 0) {\r\n            this._opacity = 0;\r\n        }\r\n\r\n        this._visible = typeof options.visible === 'boolean' ? options.visible : true;\r\n\r\n        this._source = undefined;\r\n\r\n        /**\r\n         *\r\n         * @protected\r\n         */\r\n        this._olLayer = undefined;\r\n        this._loaded = false;\r\n\r\n        this._maxResolution = zoomResolutionConvert.zoomToResolution(options.minZoom);\r\n        if (typeof this._maxResolution !== 'undefined') {\r\n            this._maxResolution += 0.00001;\r\n        }\r\n        this._minResolution = zoomResolutionConvert.zoomToResolution(options.maxZoom);\r\n\r\n        this._minZoom = typeof options.minZoom == 'number' ? options.minZoom : undefined;\r\n        this._maxZoom = typeof options.maxZoom == 'number' ? options.maxZoom : undefined;\r\n        this._zIndex = typeof options.zIndex == 'number' ? options.zIndex : 0;\r\n\r\n        this.loadCallback = typeof options.loadCallback == 'function' ? options.loadCallback : function () {\r\n        };\r\n\r\n\r\n        this._legendContent = '';\r\n\r\n        if (this._legendCheckbox) {\r\n            this._legendContent += `<input type=\"checkbox\" ${this.visible ? 'checked' : ''} ` +\r\n                `class=\"legend-check\" id=\"${this.id}-legend-layer-check\"><span></span>`;\r\n            this._legendContent += `<label for=\"${this.id}-legend-layer-check\" class=\"legend-layer-name\">${this.name}</label>`;\r\n        } else {\r\n            this._legendContent += `<label class=\"legend-layer-name\">${this.name}</label>`;\r\n        }\r\n\r\n        this._$legendDiv = null;\r\n        this._applyCollapseCalled = false;\r\n        this._addLegendContent(typeof options.legendContent === 'string' ? options.legendContent : undefined);\r\n    }\r\n\r\n    /**\r\n     * base load function, sets _loaded = true if it is not already\r\n     * @protected\r\n     * @returns {boolean} if already loaded\r\n     */\r\n    _load() {\r\n        if (this.loaded == true) {\r\n            return true;\r\n        } else {\r\n            this._loaded = true;\r\n\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the legend html, be sure to only add to the DOM once\r\n     * @returns {string} html for layer wrapped in a div\r\n     */\r\n    getLegendDiv() {\r\n        return `<div class=\"legend-layer-div\" id=\"${this.id}-legend-layer-div\">${this._legendContent}</div>`;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param additionalContent - additional content to add to legend\r\n     * @private\r\n     */\r\n    _addLegendContent(additionalContent='') {\r\n\r\n        let addCollapse = additionalContent.indexOf('<ul>') > -1;\r\n\r\n        if (addCollapse) {\r\n            additionalContent = '<span class=\"legend-items-expander\" title=\"Expand/Collapse\">&#9660;</span>' + additionalContent;\r\n        }\r\n\r\n        this._legendContent += additionalContent;\r\n\r\n        this._$legendDiv = $(`#${this.id}-legend-layer-div`);\r\n\r\n        if (this._$legendDiv.length > 0) {\r\n            this._$legendDiv.append(additionalContent);\r\n            this.applyCollapse();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * add additional content to the legend\r\n     * @param {string} [additionalContent=] - additonal content to add\r\n     */\r\n    addLegendContent(additionalContent) {\r\n        this._addLegendContent(additionalContent);\r\n    }\r\n\r\n    applyCollapse() {\r\n        if (this._applyCollapseCalled) {\r\n            console.log('collapse already applied');\r\n\r\n            return undefined;\r\n        }\r\n\r\n        this._$legendDiv = $(`#${this.id}-legend-layer-div`);\r\n\r\n        if (this._$legendDiv.length > 0) {\r\n\r\n            let $expander = this._$legendDiv.find('.legend-items-expander');\r\n\r\n            if ($expander.length > 0) {\r\n                this._applyCollapseCalled = true;\r\n\r\n                $expander.click(function () {\r\n                    let $this = $(this);\r\n\r\n                    $this.siblings('ul').slideToggle();\r\n\r\n                    if ($this.hasClass('legend-layer-group-collapsed')) {\r\n                        $this.removeClass('legend-layer-group-collapsed');\r\n                        $this.html('&#9660;');\r\n                    } else {\r\n                        $this.addClass('legend-layer-group-collapsed');\r\n                        $this.html('&#9654;');\r\n                    }\r\n                });\r\n\r\n                if (this._legendCollapse) {\r\n                    $expander.trigger('click');\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * trick to refresh the layer\r\n     */\r\n    refresh() {\r\n        if (this.source) {\r\n            this.source.refresh();\r\n        }\r\n    }\r\n\r\n    get id(): string{\r\n        return this._id;\r\n    }\r\n\r\n    set id(newId: string){\r\n        this._id = newId;\r\n    }\r\n\r\n    get animate(): boolean{\r\n        return this._animate;\r\n    }\r\n\r\n    set animate(animate: boolean){\r\n        this._animate = animate;\r\n    }\r\n\r\n    /**\r\n     * get the legend content\r\n     * @type {string}\r\n     */\r\n    get legendContent() {\r\n        return this._legendContent;\r\n    }\r\n\r\n    /**\r\n     * set the legend content directly\r\n     * @param {string} newVal - new content\r\n     * @protected\r\n     */\r\n    set legendContent(newVal) {\r\n        this._legendContent = newVal;\r\n    }\r\n\r\n    /**\r\n     * get the map get params\r\n     * @type {object}\r\n     */\r\n    get params() {\r\n        return this._params;\r\n    }\r\n\r\n    /**\r\n     * set the map get params\r\n     * @param {object} newParams - new get params\r\n     * @protected\r\n     */\r\n    set params(newParams) {\r\n        this._params = newParams;\r\n    }\r\n\r\n    /**\r\n     * get the minimum resolution\r\n     * @type {number|*}\r\n     */\r\n    get minResolution() {\r\n        return this._minResolution;\r\n    }\r\n\r\n    /**\r\n     * get the maximum resolution\r\n     * @type {number|*}\r\n     */\r\n    get maxResolution() {\r\n        return this._maxResolution;\r\n    }\r\n\r\n    /**\r\n     * get min zoom\r\n     * @type {number|*}\r\n     */\r\n    get minZoom() {\r\n        return this._minZoom;\r\n    }\r\n\r\n    /**\r\n     * get max zoom\r\n     * @type {number|*}\r\n     */\r\n    get maxZoom() {\r\n        return this._maxZoom;\r\n    }\r\n\r\n    /**\r\n     * get the url\r\n     * @type {string}\r\n     */\r\n    get url() {\r\n        return this._url;\r\n    }\r\n\r\n    /**\r\n     * Get the layer visibility\r\n     * @type {boolean}\r\n     */\r\n    get visible(): boolean {\r\n        return this._visible;\r\n    }\r\n\r\n    /**\r\n     * set the visibility\r\n     * @param visibility\r\n     */\r\n    set visible(visibility: boolean) {\r\n        this.setVisible(visibility);\r\n    }\r\n\r\n    protected setVisible(visibility: boolean) {\r\n        this._visible = visibility;\r\n        if (this.olLayer) {\r\n            this.olLayer.setVisible(this._visible);\r\n            if (visibility && !this._loaded) {\r\n                this._load();\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * Get the layer opacity\r\n     * @type {number}\r\n     */\r\n    get opacity() {\r\n        return this._opacity;\r\n    }\r\n\r\n    /**\r\n     * Set the layer opacity\r\n     * @param {number} opacity - layer opacity\r\n     */\r\n    set opacity(opacity) {\r\n        this._opacity = opacity;\r\n        if (this.olLayer) {\r\n            this.olLayer.setOpacity(this._opacity);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the layer name\r\n     * @type {string}\r\n     */\r\n    get name() {\r\n        return this._name;\r\n    }\r\n\r\n    /**\r\n     * set the layer name\r\n     * @param {string} newName - the new name\r\n     */\r\n    set name(newName) {\r\n        this._name = newName;\r\n    }\r\n\r\n    /**\r\n     * Check if the layer is loaded\r\n     * @type {boolean}\r\n     */\r\n    get loaded() {\r\n        return this._loaded;\r\n    }\r\n\r\n    /**\r\n     * get the layer source\r\n     * @type {*}\r\n     */\r\n    get source(): ol.source.Source {\r\n        return this.getSource();\r\n    }\r\n\r\n\r\n    protected getSource(): ol.source.Source{\r\n        return this._source;\r\n    }\r\n\r\n    /**\r\n     * get the z index\r\n     */\r\n    get zIndex(): number {\r\n        return this._zIndex;\r\n    }\r\n\r\n    /**\r\n     * set the z index\r\n     */\r\n    set zIndex(newZ: number) {\r\n        this._zIndex = newZ;\r\n    }\r\n\r\n    protected setZIndex(newZ: number){\r\n\r\n    }\r\n\r\n    /**\r\n     * the the ol layer\r\n     */\r\n    get olLayer(): ol.layer.Layer {\r\n        return this.getOlLayer();\r\n    }\r\n\r\n    protected getOlLayer(): ol.layer.Layer{\r\n        return this._olLayer;\r\n    }\r\n}\r\n\r\nnm.LayerBase = LayerBase;\r\nexport default LayerBase;\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/layers/LayerBase.ts","import provide from './provide';\r\nlet nm = provide('util.checkDefined');\r\n\r\n/**\r\n * check if the input is undefined or null\r\n * @param input - input pointer\r\n * @returns true undefined or null\r\n */\r\nexport function undefinedOrNull (input): boolean{\r\n    \"use strict\";\r\n\r\n    return (typeof input === 'undefined' || input === null);\r\n}\r\n\r\nnm.undefinedOrNull = undefinedOrNull;\r\n\r\n\r\n/**\r\n * check if the input is defined and not null\r\n * @param input - input pointer\r\n * @returns true defined and not null\r\n */\r\nexport function definedAndNotNull (input: any): boolean{\r\n    \"use strict\";\r\n\r\n    return !(undefinedOrNull(input));\r\n}\r\n\r\nnm.definedAndNotNull = definedAndNotNull;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/util/checkDefined.ts","/**\r\n * Created by gavorhes on 12/7/2015.\r\n */\r\nimport {LayerBase, LayerBaseOptions} from './LayerBase';\r\nimport * as esriToOl from '../olHelpers/esriToOlStyle';\r\nimport mapPopup from '../olHelpers/mapPopup';\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nimport $ = require('jquery');\r\n\r\nconst nm = provide('layers');\r\n\r\n\r\nexport interface LayerEsriMapServerOptions extends LayerBaseOptions {\r\n    addPopup?: boolean;\r\n    showLayers?: Array<number>;\r\n}\r\n\r\n/**\r\n * esri mapserver layer\r\n * @augments LayerBase\r\n */\r\nexport class LayerEsriMapServer extends LayerBase {\r\n    _esriFormat: ol.format.EsriJSON;\r\n    _popupRequest: JQueryXHR;\r\n\r\n    /**\r\n     * The base layer for all others\r\n     * @param {string} url - resource url\r\n     * @param {object} [options] - config\r\n     * @param {string} [options.id] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] the z index for the layer\r\n     * @param {function} [options.loadCallback] function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent] additional content to add to the legend\r\n     * @param {boolean} [options.addPopup=false] if a popup should be added\r\n     * @param {undefined|Array<number>} [options.showLayers=undefined] if a popup should be added\r\n     */\r\n    constructor(url, options: LayerEsriMapServerOptions = {}) {\r\n\r\n        super(url, options);\r\n        this._source = new ol.source.TileArcGISRest(\r\n            {\r\n                url: this.url == '' ? undefined : this.url,\r\n                params: typeof options.showLayers == 'undefined' ? undefined : {layers: 'show:' + options.showLayers.join(',')}\r\n            }\r\n        );\r\n\r\n        this._olLayer = new ol.layer.Tile({\r\n            source: this._source as ol.source.Tile,\r\n            visible: this.visible,\r\n            opacity: this.opacity,\r\n            minResolution: this._minResolution,\r\n            maxResolution: this._maxResolution\r\n        });\r\n\r\n        this._olLayer.setZIndex(this._zIndex);\r\n\r\n        options.addPopup = typeof options.addPopup == 'boolean' ? options.addPopup : false;\r\n\r\n        this._esriFormat = new ol.format.EsriJSON();\r\n        this._popupRequest = null;\r\n\r\n        this.addLegendContent();\r\n\r\n        if (options.addPopup) {\r\n            mapPopup.addMapServicePopup(this);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * add additional content to the legend\r\n     * @param {string} [additionalContent=''] additional content for legend\r\n     */\r\n    addLegendContent(additionalContent?: string) {\r\n        let urlCopy = this.url;\r\n\r\n        if (urlCopy[urlCopy.length - 1] !== '/') {\r\n            urlCopy += '/';\r\n        }\r\n\r\n        urlCopy += 'legend?f=pjson&callback=?';\r\n\r\n        $.get(urlCopy, {}, (d) => {\r\n            let newHtml = esriToOl.makeMapServiceLegend(d);\r\n            super.addLegendContent(newHtml);\r\n        }, 'json');\r\n    }\r\n\r\n\r\n    getPopupInfo(queryParams) {\r\n        if (!this.visible) {\r\n            return;\r\n        }\r\n\r\n        let urlCopy = this.url;\r\n\r\n        if (urlCopy[urlCopy.length - 1] != '/') {\r\n            urlCopy += '/';\r\n        }\r\n\r\n        urlCopy += 'identify?callback=?';\r\n\r\n        let __this = this;\r\n\r\n        if (this._popupRequest != null) {\r\n            this._popupRequest.abort();\r\n        }\r\n\r\n\r\n        this._popupRequest = $.get(urlCopy, queryParams, function (d) {\r\n            for (let r of d['results']) {\r\n\r\n                let popupHtml = '<table class=\"esri-popup-table\">';\r\n\r\n                for (let a in r['attributes']) {\r\n                    if (r['attributes'].hasOwnProperty(a)) {\r\n                        let attrVal = r['attributes'][a];\r\n\r\n                        if (attrVal == null || attrVal.toString().toLowerCase() == 'null') {\r\n                            continue;\r\n                        }\r\n\r\n                        let attr = a;\r\n                        if (attr.length > 14) {\r\n                            attr = attr.slice(0, 11) + '...';\r\n                        }\r\n\r\n                        popupHtml += `<tr><td>${attr}</td><td>${attrVal}</td></tr>`;\r\n                    }\r\n                }\r\n\r\n                popupHtml += '</table>';\r\n\r\n                mapPopup.addMapServicePopupContent(__this._esriFormat.readFeature(r), __this, popupHtml, r['layerName']);\r\n            }\r\n        }, 'json');\r\n\r\n        this._popupRequest.always(function () {\r\n            __this._popupRequest = null;\r\n        });\r\n\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {ol.source.TileArcGISRest} the vector source\r\n     */\r\n    get source(): ol.source.TileArcGISRest {\r\n        return super.getSource() as ol.source.TileArcGISRest;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns the ol layer\r\n     */\r\n    get olLayer(): ol.layer.Tile {\r\n        return super.getOlLayer() as ol.layer.Tile;\r\n    }\r\n}\r\nnm.LayerEsriMapServer = LayerEsriMapServer;\r\nexport default LayerEsriMapServer;\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/layers/LayerEsriMapServer.ts","import LayerBaseVector from \"../layers/LayerBaseVector\";\r\nimport MapInteractionBase from './mapInteractionBase';\r\nimport * as checkDefined from '../util/checkDefined';\r\nimport provide from '../util/provide';\r\nimport makeGuid from '../util/makeGuid';\r\nimport ol = require('custom-ol');\r\nimport $ = require('jquery');\r\nconst nm = provide('olHelpers');\r\n\r\n\r\nexport interface extentObject{\r\n    minX: number;\r\n    minY: number;\r\n    maxX: number;\r\n    maxY: number;\r\n}\r\n\r\nexport interface mapMoveCallbackFunction{\r\n    /**\r\n     *\r\n     * @param extent extent as predefined object minX, minX, maxX, maxY\r\n     * @param zoomLevel current zoom level\r\n     * @param evtType the event type 'change:center', 'change:resolution'\r\n     */\r\n    (extent: extentObject, zoomLevel: number, evtType?: string): any\r\n}\r\n\r\n\r\n/**\r\n * assists with map move interactions, trigger callback functions\r\n * @augments MapInteractionBase\r\n */\r\nexport class MapMoveCls extends MapInteractionBase {\r\n    _mapExtent: extentObject;\r\n    _zoomLevel: number;\r\n    _lookupLayer: Object;\r\n    _arrLayer: Array<LayerBaseVector>;\r\n    _arrLyrTimeout: Array<number>;\r\n    _mapMoveCallbackTimeout: Array<number>;\r\n    _mapMoveCallbackDelays: Array<number>;\r\n    _mapMoveCallbacksLookup: Object;\r\n    _mapMoveCallbackContext: Array<Object>;\r\n    _mapMoveCallbacks: Array<mapMoveCallbackFunction>;\r\n    _arrLyrRequest: Array<any>;\r\n\r\n    /**\r\n     * constructor called implicitly\r\n     */\r\n    constructor() {\r\n        super('map move');\r\n        this._arrLyrRequest = [];\r\n        this._arrLyrTimeout = [];\r\n        this._arrLayer = [];\r\n        this._lookupLayer = {};\r\n\r\n        this._mapMoveCallbacks = [];\r\n        this._mapMoveCallbacksLookup = {};\r\n        this._mapMoveCallbackDelays = [];\r\n        this._mapMoveCallbackContext = [];\r\n        this._mapMoveCallbackTimeout = [];\r\n\r\n        this._mapExtent = undefined;\r\n        this._zoomLevel = undefined;\r\n\r\n    }\r\n\r\n    /**\r\n     * initialize the map move object\r\n     * @param theMap - the ol map\r\n     */\r\n    init(theMap: ol.Map){\r\n        super.init(theMap);\r\n\r\n        this.map.getView().on(['change:center', 'change:resolution'], (e) =>{\r\n\r\n           this._updateMapExtent();\r\n\r\n            // trigger the layer updates\r\n            for (let i = 0; i < this._arrLayer.length; i++) {\r\n                this.triggerLyrLoad(this._arrLayer[i], i, e.type);\r\n            }\r\n\r\n            // trigger the map callbacks\r\n            for (let i = 0; i < this._mapMoveCallbacks.length; i++) {\r\n                this.triggerMoveCallback(i, e.type);\r\n            }\r\n        });\r\n    }\r\n\r\n    _updateMapExtent() {\r\n        let theView = this.map.getView();\r\n        this._zoomLevel = theView.getZoom();\r\n\r\n        let extentArray = theView.calculateExtent(this.map.getSize());\r\n\r\n        this._mapExtent = {\r\n            minX: extentArray[0],\r\n            minY: extentArray[1],\r\n            maxX: extentArray[2],\r\n            maxY: extentArray[3]\r\n        };\r\n    }\r\n\r\n    /**\r\n     * return the map extent\r\n     */\r\n    get mapExtent() {\r\n        if (!this._mapExtent) {\r\n            this._updateMapExtent();\r\n        }\r\n\r\n        return this._mapExtent;\r\n    }\r\n\r\n    /**\r\n     * Trigger the layer load\r\n     * @param lyr the layer being acted on\r\n     * @param index index of the layer\r\n     * @param eventType the event triggering the load, as 'change:center' or 'change:resolution'\r\n     */\r\n    triggerLyrLoad(lyr: LayerBaseVector, index?: number, eventType?: string) {\r\n\r\n        if (checkDefined.undefinedOrNull(lyr) && checkDefined.undefinedOrNull(index)) {\r\n            throw 'need to define lyr or index';\r\n        } else if (checkDefined.definedAndNotNull(lyr) && checkDefined.undefinedOrNull(index)) {\r\n            index = this._arrLayer.indexOf(lyr);\r\n        } else if (checkDefined.undefinedOrNull(lyr) && checkDefined.definedAndNotNull(index)) {\r\n            lyr = this._arrLayer[index];\r\n        }\r\n\r\n        // clear the timeout\r\n        if (this._arrLyrTimeout[index] != null) {\r\n            clearTimeout(this._arrLyrTimeout[index]);\r\n            this._arrLyrTimeout[index] = null;\r\n        }\r\n\r\n        // abort if necessary and clear the request\r\n        if (this._arrLyrRequest[index] != null && this._arrLyrRequest[index] != 4) {\r\n            this._arrLyrRequest[index].abort();\r\n            this._arrLyrRequest[index] = null;\r\n        }\r\n\r\n        // dummy callback used if before load returns false\r\n        let callbackFunc = function () {};\r\n\r\n        if (lyr.mapMoveBefore(this._zoomLevel, eventType)) {\r\n            lyr.mapMoveMakeGetParams(this._mapExtent, this._zoomLevel);\r\n\r\n            let __this = this;\r\n\r\n            callbackFunc = function () {\r\n                function innerFunction(theLayer, theIndex) {\r\n                    let _innerThis = this;\r\n                    this._arrLyrRequest[theIndex] = $.get(\r\n                        theLayer.url,\r\n                        theLayer.mapMoveParams,\r\n                        function (d) {\r\n                            /**\r\n                             * @type {LayerBaseVector}\r\n                             */\r\n                            theLayer.mapMoveCallback(d);\r\n                            theLayer.loadCallback();\r\n                        }, 'json').fail(\r\n                        function (jqXHR) {\r\n                            if (jqXHR.statusText != 'abort') {\r\n                                console.log('failed');\r\n                                console.log(theLayer.url);\r\n                                console.log(theLayer.mapMoveParams);\r\n                            }\r\n                        }).always(\r\n                        function () {\r\n                            _innerThis._arrLyrTimeout[theIndex] = null;\r\n                            _innerThis._arrLyrRequest[theIndex] = null;\r\n                        });\r\n                }\r\n                innerFunction.call(__this, lyr, index);\r\n            };\r\n        } else {\r\n            lyr.clear();\r\n        }\r\n        this._arrLyrTimeout[index] = setTimeout(callbackFunc, lyr.onDemandDelay);\r\n    }\r\n\r\n    /**\r\n     * trigger the map move call back at the given index\r\n     * @param ind - the index of the layer\r\n     * @param eventType=undefined the event triggering the load as 'change:center' or 'change:resolution'\r\n     * @param functionId=undefined the function id used to reference the added callback function\r\n     */\r\n    triggerMoveCallback(ind: number, eventType?: string, functionId?: string) {\r\n\r\n        if (typeof ind == 'undefined' && typeof functionId == 'undefined'){\r\n            throw 'either the function index or the id must be defined';\r\n        }\r\n\r\n        if (typeof ind !== 'number'){\r\n            ind = this._mapMoveCallbacks.indexOf(this._mapMoveCallbacksLookup[functionId]);\r\n        }\r\n\r\n        if (ind < 0){\r\n            console.log('function not found');\r\n\r\n            return;\r\n        }\r\n\r\n        // clear the timeout\r\n        if (this._mapMoveCallbackTimeout[ind] != null) {\r\n            clearTimeout(this._mapMoveCallbackTimeout[ind]);\r\n            this._mapMoveCallbackTimeout[ind] = null;\r\n        }\r\n\r\n        let ctx = this._mapMoveCallbackContext[ind];\r\n        let theFunc = this._mapMoveCallbacks[ind];\r\n\r\n        let __this = this;\r\n\r\n        let f = function () {\r\n            if (ctx !== null) {\r\n                theFunc.call(ctx, __this._mapExtent, __this._zoomLevel, eventType);\r\n            } else {\r\n                theFunc(__this._mapExtent, __this._zoomLevel, eventType);\r\n            }\r\n        };\r\n\r\n        this._mapMoveCallbackTimeout[ind] = setTimeout(f, this._mapMoveCallbackDelays[ind]);\r\n    }\r\n\r\n    /**\r\n     * Add a layer to the interaction\r\n     * @param  lyr - layer to add\r\n     * @param triggerOnAdd - if the layer should be loaded on add\r\n     */\r\n    addVectorLayer(lyr: LayerBaseVector, triggerOnAdd: boolean = true) {\r\n        if (this._arrLayer.indexOf(lyr) > -1) {\r\n            console.log('already added ' + lyr.name + ' to map move');\r\n\r\n            return;\r\n        }\r\n        this._checkInit();\r\n\r\n        this._arrLyrRequest.push(null);\r\n        this._arrLyrTimeout.push(null);\r\n        this._arrLayer.push(lyr);\r\n        this._lookupLayer[lyr.id] = lyr;\r\n\r\n        triggerOnAdd = typeof triggerOnAdd == 'boolean' ? triggerOnAdd : true;\r\n\r\n        if (triggerOnAdd) {\r\n            if (this._mapExtent === undefined) {\r\n                this._updateMapExtent();\r\n            }\r\n            this.triggerLyrLoad(lyr, this._arrLayer.length - 1);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * add a callback to the map move event\r\n     * @param func - callback function\r\n     * @param context - the context to use for this function\r\n     * @param delay=50 the delay before call load\r\n     * @param triggerOnAdd if the layer should be loaded on add to mapMove\r\n     * @param functionId optional id to reference the function later for outside triggering\r\n     */\r\n    addCallback(func: mapMoveCallbackFunction, context?: any, delay?: number, triggerOnAdd? : boolean, functionId?: string) {\r\n\r\n        if (this._mapMoveCallbacks.indexOf(func) > -1) {\r\n            console.log('this function already added to map move');\r\n            return;\r\n        }\r\n        this._checkInit();\r\n        if (!functionId){\r\n            functionId = makeGuid();\r\n        }\r\n\r\n        this._mapMoveCallbacks.push(func);\r\n        this._mapMoveCallbacksLookup[functionId] = functionId;\r\n        this._mapMoveCallbackDelays.push(typeof delay == 'number' ? delay : 50);\r\n        this._mapMoveCallbackContext.push(checkDefined.definedAndNotNull(context) ? context : null);\r\n        this._mapMoveCallbackTimeout.push(null);\r\n\r\n        triggerOnAdd = typeof triggerOnAdd == 'boolean' ? triggerOnAdd : true;\r\n\r\n        if (triggerOnAdd) {\r\n            if (this._mapExtent === undefined) {\r\n                this._updateMapExtent();\r\n            }\r\n            this.triggerMoveCallback(this._mapMoveCallbacks.length - 1);\r\n        }\r\n    }\r\n}\r\n\r\nnm.MapMoveCls = MapMoveCls;\r\nexport default MapMoveCls;\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/olHelpers/mapMoveCls.ts","/**\r\n * Created by gavorhes on 11/3/2015.\r\n */\r\n\r\nimport MapInteractionBase from './mapInteractionBase';\r\nimport propertiesZoomStyle from '../olHelpers/propertiesZoomStyle';\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nimport {LayerBaseVector} from \"../layers/LayerBaseVector\";\r\nimport LayerEsriMapServer from \"../layers/LayerEsriMapServer\";\r\nimport $ = require('jquery');\r\n\r\nconst nm = provide('olHelpers');\r\n\r\nexport interface popupChangedFunction {\r\n    ($popContent: JQuery): any;\r\n}\r\n\r\n/**\r\n *\r\n */\r\nexport interface popupCallback {\r\n    /**\r\n     * Callback function for the popup\r\n     * @param featureProperties\r\n     * @param jqRef\r\n     */\r\n    (featureProperties: Object, jqRef?: JQuery): string | boolean;\r\n}\r\n\r\ninterface mapEvent {\r\n    coordinate: ol.Coordinate;\r\n    pixel: ol.Pixel;\r\n    dragging: boolean|any;\r\n    originalEvent: Event;\r\n}\r\n\r\n\r\nexport class FeatureLayerProperties {\r\n\r\n    feature: ol.Feature;\r\n    layer: LayerBaseVector|LayerEsriMapServer;\r\n    layerIndex: number;\r\n    selectionLayer: ol.layer.Vector;\r\n    popupContent: string;\r\n    esriLayerName: string;\r\n\r\n    /**\r\n     *\r\n     * @param feature the feature\r\n     * @param layer - the layer in the popup\r\n     * @param layerIndex - index of the layer\r\n     * @param selectionLayer - the ol selection layer\r\n     * @param [esriLayerName=undefined] - esri layer name\r\n     */\r\n    constructor(feature: ol.Feature, layer: LayerBaseVector|LayerEsriMapServer, layerIndex: number, selectionLayer: ol.layer.Vector, esriLayerName?: string) {\r\n        this.feature = feature;\r\n        this.layer = layer;\r\n        this.layerIndex = layerIndex;\r\n        this.selectionLayer = selectionLayer;\r\n        this.popupContent = '';\r\n        this.esriLayerName = typeof esriLayerName == 'string' ? esriLayerName : undefined;\r\n    }\r\n\r\n    get layerName() {\r\n        if (typeof this.esriLayerName == 'string') {\r\n            return this.esriLayerName;\r\n        } else {\r\n            return this.layer.name;\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * map popup class\r\n * @augments MapInteractionBase\r\n */\r\nexport class MapPopupCls extends MapInteractionBase {\r\n    private _popupOpen: boolean;\r\n    private _passThroughLayerFeatureArray: Array<FeatureLayerProperties>;\r\n    private _currentPopupIndex: number;\r\n    private _popupContentLength: number;\r\n    private _esriMapServiceLayers: Array<LayerEsriMapServer>;\r\n    private _$popupCloser: JQuery;\r\n    private _$popupContent: JQuery;\r\n    private _$popupContainer: JQuery;\r\n    private _popupOverlay: ol.Overlay;\r\n    private _arrPopupLayers: Array<LayerBaseVector>;\r\n    private _popupCoordinate: ol.Coordinate;\r\n    private _popupChangedFunctions: Array<popupChangedFunction>;\r\n    private _mapClickFunctions: Array<Function>;\r\n    private _selectionLayerLookup: Object;\r\n    private _arrPopupLayerIds: Array<string>;\r\n    private _arrPopupLayerNames: Array<string>;\r\n    private _arrPopupOlLayers: Array<ol.layer.Vector>;\r\n    private _arrPopupContentFunction: Array<popupCallback>;\r\n    private _selectionLayers: Array<ol.layer.Vector>;\r\n\r\n    /**\r\n     * Definition for openlayers style function\r\n     * @callback olStyleFunction\r\n     * &param feature the openlayers vector feature\r\n     * $param\r\n     */\r\n\r\n\r\n    /**\r\n     * map popup constructor\r\n     */\r\n    constructor() {\r\n        super('map popup');\r\n        this._arrPopupLayerIds = [];\r\n        this._arrPopupLayerNames = [];\r\n        this._arrPopupLayers = [];\r\n        this._arrPopupOlLayers = [];\r\n        this._arrPopupContentFunction = [];\r\n        this._$popupContainer = undefined;\r\n        this._$popupContent = undefined;\r\n        this._$popupCloser = undefined;\r\n        this._popupOverlay = undefined;\r\n        this._selectionLayers = [];\r\n        this._selectionLayerLookup = {};\r\n        this._mapClickFunctions = [];\r\n\r\n        //let a = function($jqueryContent){console.log($jqueryContent)};\r\n        //this._popupChangedLookup = {'a': a};\r\n        this._popupChangedFunctions = [];\r\n        this._esriMapServiceLayers = [];\r\n\r\n        this._popupOpen = false;\r\n        this._popupCoordinate = null;\r\n\r\n        this._passThroughLayerFeatureArray = [];\r\n\r\n        this._currentPopupIndex = -1;\r\n        this._popupContentLength = 0;\r\n\r\n    }\r\n\r\n    /**\r\n     * map popup initialization\r\n     * @param {ol.Map} theMap - the ol map\r\n     */\r\n    init(theMap: ol.Map) {\r\n        super.init(theMap);\r\n\r\n        let $map;\r\n        let target = this.map.getTarget();\r\n\r\n        if (typeof target == 'string') {\r\n            $map = $('#' + target);\r\n        }\r\n        else {\r\n            $map = $(target);\r\n        }\r\n\r\n        $map.append(\r\n            '<div class=\"ol-popup\">' +\r\n            '<span class=\"ol-popup-closer\">X</span>' +\r\n            '<div class=\"popup-content\"></div>' +\r\n            '</div>'\r\n        );\r\n\r\n        this._$popupContainer = $map.find('.ol-popup');\r\n        this._$popupContent = $map.find('.popup-content');\r\n        this._$popupCloser = $map.find('.ol-popup-closer');\r\n\r\n        let _ease = (n: number): number => {\r\n            return ol.easing.inAndOut(n);\r\n        };\r\n\r\n\r\n        this._popupOverlay = new ol.Overlay({\r\n            element: this._$popupContainer[0],\r\n            autoPan: true,\r\n            autoPanAnimation: {\r\n                duration: 250,\r\n                source: theMap.getView().getCenter(),\r\n                easing: _ease\r\n            }\r\n        });\r\n\r\n        this._map.addOverlay(this._popupOverlay);\r\n\r\n        this._$popupCloser.click((evt) => {\r\n            this.closePopup();\r\n        });\r\n\r\n        // display popup on click\r\n        this._map.on('singleclick', (evt) => {\r\n\r\n            this.closePopup();\r\n            this._popupCoordinate = evt['coordinate'];\r\n\r\n            // esri map service layers\r\n            if (this._esriMapServiceLayers.length > 0) {\r\n\r\n                let queryParams = {\r\n                    geometry: evt['coordinate'].join(','),\r\n                    geometryType: 'esriGeometryPoint',\r\n                    layers: 'all',\r\n                    sr: this._map.getView().getProjection().getCode().split(':')[1],\r\n                    mapExtent: (this._map.getView().calculateExtent(this._map.getSize()) as number[]).join(','),\r\n                    imageDisplay: (this._map.getSize() as number[]).join(',') + ',96',\r\n                    returnGeometry: true,\r\n                    tolerance: 15,\r\n                    f: 'pjson'\r\n                };\r\n\r\n                for (let l of this._esriMapServiceLayers) {\r\n                    l.getPopupInfo(queryParams);\r\n                }\r\n            }\r\n\r\n            let layerFeatureObjectArray = this._featuresAtPixel(evt['pixel']);\r\n\r\n            this._passThroughLayerFeatureArray = [];\r\n            this._currentPopupIndex = -1;\r\n\r\n            for (let i = 0; i < layerFeatureObjectArray.length; i++) {\r\n                let featObj = layerFeatureObjectArray[i];\r\n\r\n                let props = featObj.feature.getProperties();\r\n\r\n                let popupContentResponse = this._arrPopupContentFunction[featObj.layerIndex](props, this._$popupContent);\r\n\r\n                //skip if return was false\r\n                if (popupContentResponse === false) {\r\n                    //continue;\r\n                } else if (typeof popupContentResponse == 'string') {\r\n                    featObj.popupContent = popupContentResponse as string;\r\n                    this._passThroughLayerFeatureArray.push(featObj);\r\n                } else {\r\n                    featObj.selectionLayer.getSource().addFeature(featObj.feature);\r\n                }\r\n            }\r\n\r\n            this._popupContentLength = this._passThroughLayerFeatureArray.length;\r\n\r\n            this._currentPopupIndex = -1;\r\n\r\n            let popupHtml = '<div class=\"ol-popup-nav\">';\r\n            popupHtml += '<span class=\"previous-popup ol-popup-nav-arrow\">&#9664;</span>';\r\n            popupHtml += '<span class=\"next-popup ol-popup-nav-arrow\">&#9654;</span>';\r\n            popupHtml += `<span class=\"current-popup-item-number\" style=\"font-weight: bold;\"></span>`;\r\n            popupHtml += `<span>&nbsp;of&nbsp;</span>`;\r\n            popupHtml += `<span class=\"popup-content-length\" style=\"font-weight: bold;\">${this._popupContentLength}</span>`;\r\n            popupHtml += `<span>&nbsp;&nbsp;-&nbsp;&nbsp;</span>`;\r\n            popupHtml += `<span class=\"current-popup-layer-name\"></span>`;\r\n            popupHtml += '</div>';\r\n            popupHtml += '<div class=\"ol-popup-inner\">';\r\n\r\n            popupHtml += '</div>';\r\n\r\n            this._$popupContent.html(popupHtml);\r\n\r\n            this._$popupContent.find('.previous-popup').click(() => {\r\n                if (this._popupContentLength == 1) {\r\n                    return;\r\n                }\r\n\r\n                if (this._currentPopupIndex == 0) {\r\n                    this._currentPopupIndex = this._popupContentLength - 1;\r\n                } else {\r\n                    this._currentPopupIndex--;\r\n                }\r\n                this._triggerFeatSelect();\r\n            });\r\n\r\n            let nextPopup = this._$popupContent.find('.next-popup');\r\n\r\n            nextPopup.click(() => {\r\n                if (this._popupContentLength == 1 && this._currentPopupIndex > -1) {\r\n                    return;\r\n                }\r\n\r\n                if (this._currentPopupIndex == this._popupContentLength - 1) {\r\n                    this._currentPopupIndex = 0;\r\n                } else {\r\n                    this._currentPopupIndex++;\r\n                }\r\n                this._triggerFeatSelect();\r\n            });\r\n\r\n\r\n            if (this._popupContentLength > 0) {\r\n                nextPopup.trigger('click');\r\n                this._popupOverlay.setPosition(this._popupCoordinate);\r\n                this._$popupContent.scrollTop(0);\r\n                this._popupOpen = true;\r\n            }\r\n        });\r\n\r\n        //change mouse cursor when over marker\r\n        this._map.on('pointermove', (evt) => {\r\n            if (evt['dragging']) {\r\n                return;\r\n            }\r\n            let pixel = this.map.getEventPixel(evt['originalEvent']);\r\n            let hit = this.map.hasFeatureAtPixel(pixel, (lyrCandidate) => {\r\n                for (let olLayer of this._arrPopupOlLayers) {\r\n                    if (lyrCandidate == olLayer) {\r\n                        return true;\r\n                    }\r\n                }\r\n\r\n                return false;\r\n            });\r\n            let mapElement = this.map.getTargetElement() as HTMLElement;\r\n            mapElement.style.cursor = hit ? 'pointer' : '';\r\n        });\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * helper to select features\r\n     * @private\r\n     */\r\n    _triggerFeatSelect() {\r\n        let $currentPopupItemNumber = this._$popupContent.find('.current-popup-item-number');\r\n        let $innerPopup = this._$popupContent.find('.ol-popup-inner');\r\n        let $layerNameSpan = this._$popupContent.find('.current-popup-layer-name');\r\n        this.clearSelection();\r\n        let lyrFeatObj = this._passThroughLayerFeatureArray[this._currentPopupIndex];\r\n        $currentPopupItemNumber.html((this._currentPopupIndex + 1).toFixed());\r\n        $layerNameSpan.html(lyrFeatObj.layerName);\r\n        $innerPopup.html(lyrFeatObj.popupContent);\r\n        lyrFeatObj.selectionLayer.getSource().addFeature(lyrFeatObj.feature);\r\n        for (let f of this._popupChangedFunctions) {\r\n            f(this._$popupContent);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     *\r\n     * @param feature - the ol feature\r\n     * @param {LayerEsriMapServer} lyr - the map server layer\r\n     * @param {string} popupContent - popup content\r\n     * @param {string} esriName - esri layer name\r\n     */\r\n    addMapServicePopupContent(feature: ol.Feature, lyr: LayerEsriMapServer, popupContent: string, esriName: string) {\r\n\r\n        let featLayerObject = new FeatureLayerProperties(\r\n            feature, lyr, this._popupContentLength, this._selectionLayerLookup[lyr.id], esriName\r\n        );\r\n        featLayerObject.popupContent = popupContent;\r\n\r\n        this._passThroughLayerFeatureArray.push(featLayerObject);\r\n        this._popupContentLength++;\r\n\r\n        $('.popup-content-length').html(this._popupContentLength.toFixed());\r\n\r\n        if (!this._popupOpen) {\r\n            this._$popupContent.find('.next-popup').trigger('click');\r\n\r\n            this._popupOverlay.setPosition(this._popupCoordinate);\r\n            this._$popupContent.scrollTop(0);\r\n            this._popupOpen = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param  pixel - the ol pixel\r\n     * @returns  feature layer properties\r\n     * @private\r\n     */\r\n    _featuresAtPixel(pixel: ol.Pixel): Array<FeatureLayerProperties> {\r\n        let layerFeatureObjectArray = [];\r\n\r\n        this.map.forEachFeatureAtPixel(pixel, (feature: ol.Feature, layer: ol.layer.Vector) => {\r\n            let lyrIndex = this._arrPopupOlLayers.indexOf(layer);\r\n\r\n            if (lyrIndex > -1) {\r\n                layerFeatureObjectArray.push(\r\n                    new FeatureLayerProperties(\r\n                        feature, this._arrPopupLayers[lyrIndex], lyrIndex, this._selectionLayers[lyrIndex]));\r\n            }\r\n        });\r\n\r\n        return layerFeatureObjectArray;\r\n    }\r\n\r\n    closePopup() {\r\n        this._checkInit();\r\n        this._popupOpen = false;\r\n        this._popupOverlay.setPosition(undefined);\r\n        this._$popupCloser[0].blur();\r\n        this.clearSelection();\r\n        this._$popupContent.html('');\r\n\r\n        return false;\r\n    };\r\n\r\n\r\n    /**\r\n     *\r\n     * @param chgFunction - popup change function\r\n     */\r\n    addPopupChangedFunction(chgFunction: popupChangedFunction) {\r\n        this._popupChangedFunctions.push(chgFunction);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {LayerBase|*} lyr - the layer being acted on\r\n     * @param {object} [selectionStyle={}] the selection style configuration\r\n     * @param {string} [selectionStyle.color=rgba(255,170,0,0.5)] the selection color\r\n     * @param {number} [selectionStyle.width=10] the selection width for linear features\r\n     * @param {object|function} [selectionStyle.olStyle=undefined] an openlayers style object or function\r\n     * @returns  the new selection layer\r\n     * @private\r\n     */\r\n    _addPopupLayer(lyr: LayerBaseVector, selectionStyle: {color?: string, width?: number, olStyle?: ol.style.Style}): ol.layer.Vector {\r\n        this._checkInit();\r\n\r\n        selectionStyle = selectionStyle || {};\r\n        selectionStyle.color = selectionStyle.color || 'rgba(255,170,0,0.5)';\r\n        selectionStyle.width = selectionStyle.width || 10;\r\n\r\n        let theStyle;\r\n\r\n        if (selectionStyle.olStyle) {\r\n            theStyle = selectionStyle.olStyle;\r\n        } else {\r\n            theStyle = new ol.style.Style({\r\n                stroke: new ol.style.Stroke({\r\n                    color: selectionStyle.color,\r\n                    width: selectionStyle.width\r\n                }),\r\n                image: new ol.style.Circle({\r\n                    radius: 7,\r\n                    fill: new ol.style.Fill({color: selectionStyle.color}),\r\n                    stroke: new ol.style.Stroke({color: selectionStyle.color, width: 1})\r\n                }),\r\n                fill: new ol.style.Fill({\r\n                    color: selectionStyle.color\r\n                })\r\n            });\r\n        }\r\n\r\n        let selectionLayer = new ol.layer.Vector(\r\n            {\r\n                source: new ol.source.Vector(),\r\n                style: theStyle\r\n            }\r\n        );\r\n\r\n        selectionLayer.setZIndex(100);\r\n\r\n        this._selectionLayers.push(selectionLayer);\r\n        this._selectionLayerLookup[lyr.id] = selectionLayer;\r\n        this.map.addLayer(selectionLayer);\r\n\r\n        return selectionLayer;\r\n    }\r\n\r\n\r\n    /**\r\n     * Add popup to the map\r\n     * @param {LayerBase|*} lyr The layer that the popup with act on\r\n     * @param {popupCallback} popupContentFunction - popup content function that makes popup info\r\n     * @param {object} [selectionStyle={}] the selection style configuration\r\n     * @param {string} [selectionStyle.color=rgba(255,170,0,0.5)] the selection color\r\n     * @param {number} [selectionStyle.width=10] the selection width for linear features\r\n     * @param {object|function} [selectionStyle.olStyle=undefined] an openlayers style object or function\r\n     * @returns {object} a reference to the ol selection layer\r\n     */\r\n    addVectorPopup(lyr: LayerBaseVector, popupContentFunction: popupCallback,\r\n                   selectionStyle?: {color?: string, width?: number, olStyle?: ol.style.Style}) {\r\n        let selectionLayer = this._addPopupLayer(lyr, selectionStyle);\r\n        this._arrPopupLayerIds.push(lyr.id);\r\n        this._arrPopupLayerNames.push(lyr.name);\r\n        this._arrPopupLayers.push(lyr);\r\n        this._arrPopupOlLayers.push(lyr.olLayer);\r\n        this._arrPopupContentFunction.push(popupContentFunction);\r\n\r\n        return selectionLayer;\r\n    };\r\n\r\n\r\n    /**\r\n     *\r\n     * @param {LayerBase} lyr - layer\r\n     */\r\n    removeVectorPopup(lyr) {\r\n        let idx = this._arrPopupLayerIds.indexOf(lyr.id);\r\n\r\n        if (idx > -1) {\r\n            this._arrPopupLayerIds.splice(idx, 1);\r\n            this._arrPopupLayerNames.splice(idx, 1);\r\n            this._arrPopupLayers.splice(idx, 1);\r\n            this._arrPopupOlLayers.splice(idx, 1);\r\n            this._arrPopupContentFunction.splice(idx, 1);\r\n            this._selectionLayers.splice(idx, 1);\r\n            delete this._selectionLayerLookup[lyr.id];\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {LayerEsriMapServer} lyr - map server layer\r\n     * @param {object} [selectionStyle={}] the selection style configuration\r\n     * @param {string} [selectionStyle.color=rgba(255,170,0,0.5)] the selection color\r\n     * @param {number} [selectionStyle.width=10] the selection width for linear features\r\n     * @param {object|function} [selectionStyle.olStyle=undefined] an openlayers style object or function\r\n     * @returns {object} a reference to the ol selection layer\r\n     */\r\n    addMapServicePopup(lyr, selectionStyle?: ol.style.Style|Array<ol.style.Style>|ol.StyleFunction) {\r\n        let selectionLayer = this._addPopupLayer(lyr, selectionStyle);\r\n        this._esriMapServiceLayers.push(lyr);\r\n\r\n        return selectionLayer;\r\n    }\r\n\r\n    clearSelection() {\r\n        this._checkInit();\r\n        for (let i = 0; i < this._selectionLayers.length; i++) {\r\n            this._selectionLayers[i].getSource().clear();\r\n        }\r\n        for (let f of this._mapClickFunctions) {\r\n            f();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Add a function to be called when the map is clicked but before any popups are implemented\r\n     * @param {function} func - the map click function\r\n     */\r\n    addMapClickFunction(func: Function) {\r\n        this._mapClickFunctions.push(func);\r\n    }\r\n}\r\nnm.MapPopupCls = MapPopupCls;\r\nexport default MapPopupCls;\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/olHelpers/mapPopupCls.ts","/**\r\n * Created by gavorhes on 12/15/2015.\r\n */\r\n\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nimport $ = require('jquery');\r\nconst nm = provide('olHelpers');\r\n\r\nexport interface quickMapOptions {\r\n    divId?: string;\r\n    center?: {x: number, y: number};\r\n    zoom?: number;\r\n    minZoom?: number;\r\n    maxZoom?: number;\r\n    baseSwitcher?: boolean;\r\n    fullScreen?: boolean;\r\n}\r\n\r\n/**\r\n * Sets up a map with some default parameters and initializes\r\n * mapMove and mapPopup\r\n *\r\n * @param [options={}] config options\r\n * @param [options.divId=map] map div id\r\n * @param [options.center={}] center config object\r\n * @param [options.center.x=-10018378] center x, web mercator x or lon\r\n * @param [options.center.y=5574910] center y, web mercator y or lat\r\n * @param [options.zoom=7] zoom level\r\n * @param [options.minZoom=undefined] min zoom\r\n * @param [options.maxZoom=undefined] max zoom\r\n * @param [options.baseSwitcher=true] if add base map switcher\r\n * @param [options.fullScreen=false] if add base map switcher\r\n * @returns the ol map\r\n */\r\nexport function quickMapBase(options?: quickMapOptions): ol.Map {\r\n    options = options || {} as quickMapOptions;\r\n    options.divId = options.divId || 'map';\r\n    options.center = options.center || {x: -10018378, y: 5574910};\r\n    options.zoom = typeof options.zoom == 'number' ? options.zoom : 7;\r\n    options.baseSwitcher = typeof options.baseSwitcher == 'boolean' ? options.baseSwitcher : true;\r\n    options.fullScreen = typeof options.fullScreen == 'boolean' ? options.fullScreen : false;\r\n\r\n\r\n    let $mapDiv = $('#' + options.divId);\r\n    $mapDiv.css('position', 'relative');\r\n\r\n    let osmLayer = new ol.layer.Tile({source: new ol.source.OSM()});\r\n    // let satLayer = new ol.layer.Tile({visible: false, source: new ol.source.MapQuest({layer: 'sat'})});\r\n\r\n    let osmCss = \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURQAAADQ1NDk5OURFREtLS1FHSFlZWGJRVGJiYWdmZWxsbHRmaXBpanN0c3V0dHp5eX5+fIVzd4F3eeV0jud5juZ8k4aHhomHhoyGh5eGj5OVlJiVlZiYl5qZmJydnKOTlaKZmqKdnaOioaqqqKuzsbOvrrSysLa3tbW4uLm6ub27ub+/vbGXwbCZwbCgxLKlxrOqyLStybO3yrSxyrWzzbW2y7a1zbK4y7W6zbW8y760yrTAzbTFzrPKzrLOzrTJzrTOzr7CwbXC0LXK0LTO0L3I0bPQz7TQz7PS0bXQ0LnR0brW1bzT0r7U077V1Lzc2dqNqteUsdyXscaquuOHneaGmueHnOeJnuiBleiKn+eNoOiOoOWUpOiRo+iSpeiUpeqYpumaqOmdrPSynemgruSqtOmisOmlsuuqtequuOW1vOuxu+uxvOq1ve+xvPK0pvW3o/W5pfO5qvS7qfCwvMOuwc2/wNenxNyyzNe/0Nq31Nq51dy72Oy3wOu4wOu+xey4wO+6xO2+xfTAr/TCsvfFtPHLvvTJuMPDwMfHxcXKyc3DxMvFyMvLyM3PzcDV08DV1MTX1cbY1s7X1sjZ1sra2Mnd3M7b2c7c2tfH1tnB1t7F2d7M29fX1tLY1tDd2tHe3NTf3NnS19rZ1tva2Nnf3t3d28rh3tXg3Nnh3tzj393k39ni4N7k4N7n5uXDyOfLz+zAxu3CyOzEyezKzeDJ3eLM3uvP0u3P0ePf2+7R0u7Q1u/U0+7U1ezc0+7a2e/d2+3f3vbFzvLOwfHN0PPQw/TUx/LWyvLYzPDQ1fPe0ubc4vve4uHh3+nh3+/h2u/h3vHj2vHl3uHm4eTn4uDp5ebo4+Xo5ODq6ebq6OTv6+nl4+/j4O7l4e7n5ujp4+np5Ozq5e7s5urt6O7t6Orw6u7x6u3x7vPj5PDl4fDo4vDq5fDt5vDu6PDv7PTv6fDx6vHx7fH17fXw6fXy7fb07/bz8fT18vn38vr39fr48/r59Pr6+P3++//+/gAAALNTSk0AAAEAdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBT9wclAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGHRFWHRTb2Z0d2FyZQBwYWludC5uZXQgNC4wLjlsM35OAAAFNElEQVRIS1VVCZxVUxi/9l0UIUT2bMnY43bVI2c0Y01kSWIaS0j2JEtkN41piomZrPPKQ2aQ7JKImOZlnm2493TJzDufuU1Zi+v/fee+mZ//793vnPOd7zvfes5zDBEZkBBjAcIjb+Iiotqgdhat8AMK0vl7/R9N7GiWtshqIr+EZ5gYKibyUsXY1l/mfFpssvUlWQ0FkU3gy4+RB/+kwYcO8pRSnldcOU/r2lAHARSwk2ORgEmOdC1EsuRiYSqMPwwroMIraZk5V2fYJQjCKfZrRmh3gSAZi2i4b7wSylWu8EqZwS59JkFUaW96JbNSc+CEUmt4rorwuZmWdDaoc+uZETuQlTCU5xYzR7muUnVUVo+BcRhre/VwUpasgJwhH7JkYIYA0sNxhmCwUK+lw6vCKBZehw01dEiyw4Q4aE0Z4ahDhKaFQsGnJ2BgqKoTBsNjFy0SlW6whRAZTdm8DBJmkBZhDi1j4xJQBk6ywrWUTymaCxac8lROcdauRGzQSNtA7EHUYhXyEwhhgjFUqRuO+rauhF1awFpzCsmwUbjIFBR0u1bKtyGpulW/H/cVVzkyGaIWTIR9pFAV6GK2gPMXMX8gPk9zzxXgI1kimcAltEYr+cjio1imlKpEa9rOipLm+p+CZ6Bw//qd1/f/O+GwMxbSLpyoZEcwkyh2jIks+3hmdd2jWUw4scxNysnHxU7nSspTRcJjCZGL3IsjsYJMMg5mwgx7gaIOLBFCogAgBBoNa9w+DE6I+Bs7FTgwwrJbHjWDgpYo2KwtBTcYEDuloC9geQw+k2RGnPGpTaOlq7AS+YICUz4DZVaX2TiNDhuYfTtY4geLi0IoCm3XccwM9hx4kU28StQEljDs3ZEpFGA+8dKzLmV9ymIwF5FOGn2GdJM8KLHDJbXyiYVMG9MRTLiXGGg2QKaxM3khPSRrwM9zEIardxU2w/EiA0gOeYKHzDR0V7/QGV3lKIA9ktrDArxO3gdA+k6SKoBiVwcm7NjZb9+Hnztg282TuHVZ9LOISFNt9MgyCetZVczSxnyDbl17Penq6mqpg1IhRaEO2aVLUO4/r17H8tTv6f13h71dduvZI3Y+uMdWksNSauLovJw5hsqiPIUvt0ku7/iBeUR3sksmomYWtRbAjbiLfv2lX9/V7LVG4uYnUZXhQ7f2OPCZEx9wrYWTcePEQqPEML8pl4mMdr/jlXlvHiRiJ2+MSTFY4TTSYStuvz2R/JXh+PPeGXm055J+3/YDWuNu3R3DArPutyg0ZgykMVDU9Ndm22+wYalr2rse48CnsTIFcMn73vfhNrktx1EUcZnPv6ah3Yy5cDTRdBEoGoBeah71dqFyjZDJLkWk3N3v4uuktssjWpzciMPxQeHj8nMKzcGuB0tAyzFhdCKOYWv4HwOQVwIxLG99a6uvH3sJCyO3h+k4EZ+G7+xj5f4XXksoaGrdMRzSc8ARA8+cdOuk2x6fffNNt5x+Ro1omPlrT/CQDlcNlpx4NBIWXhkx7Y3Zp3ofNR7Uv89Om/beW0TLIynHv3vs1VsOFpSWSXvfuPUf9BrRFyxgXdHoKJnQFegPOovvzz59ntrzye240ig8UQ3lDI2VqwagrKIQcLXNFL3wglN2OHdBQ6/vI3kENDVBwRb3k1XtczFbjWn4EzMYi7CF3129+JTYuRSdrGuS92g5dpqn6qXoJQs5xmL8p+Wt4hLbt0mx2OLNZR2bbPy8zJNQGFM/f/CfXZekRYFjGCWjIJpM+WiCzGBPWHhoyaAsjRT/B2Gy5yzYJkwUAAAAAElFTkSuQmCC')\";\r\n    let aerialCss = \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURQALBgIMDQgOBwQOEQcTBwUSCwoVDAwdBw8ZDgUREwYUGAYZFQYZGgkTFQoVGQsZFAwZHBMeDhIbFBEbHAwWIA4bIREcIQ4hCQwjFw4lHBgkDB8sDxUiExIiGhAoGxohFRshGRorHQcrKQsiIQwmKgooJA0pKQ81Jw8yLRMiIxImKxUrJREuKhslJB0rIhooKRUuMBMyLhkwJhozKh48LxUzMRM9MBwzMiUvFCMtGiMwEiwzFCgzHDI+GSIsISkvJSQxIiM2LiY5Jic+Lyk0JSo0Ky49JSs9KSU1NSM7NCs2NS8+NDM1JzU9Ljg7IDJCHS1DLSNAMitCMSxIOjREITZLIDZJKDlFIjpFKztKJT1LKzJBMzpHMD1JMjpKPD1RKjlQNC1DQj5QQEA8MEJGJkBKJUJNK0lLLEJMMkVMPEpONENSLUdZL0pTLkpaLkRUMkRSPEVZMktUM0pVOklZMklZNEpcNU1ZMk1ZNUxfMk5dNkxcOVFUM1RUOFJbNVFZOVNYPVFdOVJdPFVaOVVaPVVdOlVdPVpaNlpdO0phN01hOlBiN1NhPFNoP1piPWFbPmRjPENOQEtPSURTQkJVS0xVQk1VSkxbQkxcS0heUVFXRFRcQlJfTFxeQlpeS05lQk1kSFRjQVRjSlZpQ1tkQlxlSlxpRF1rSVVnUVtlU1llXF9tU1xoXlxwSl9ramRfQmJlQ2FhSWFlSWFlTmVlSWRmTGFoQWFpRWFsRmVpRWVtRmNsSmtlRGpqRmpsS2BmWGRsUmFrW2ptUmZyR2RxTGpxTWVyU2RyW2d5V2tzUmt0WW15VG15WXFuTHNtVnFxTXF4T3h0TnJzUnJ1XHJ4VXN6Wnp0VHx1W315VXp8XGR0YGx0YHVzZXJ0aHR9ZXV+aHl9YHOCXXqBXXeCYHyCY3iEaHyIYn+JaXqKcYB5WIN6Y4SCXoCDZIGEaYCIZoOLa4iCaImJbIOOdYuMco6OeIuVcpOKbZKPc5aQb5eXe5ufg6KjhAAAAAAAAAAAAAAAAOGCeQgAAAEAdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBT9wclAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGHRFWHRTb2Z0d2FyZQBwYWludC5uZXQgNC4wLjlsM35OAAAH80lEQVRISy1WbXQUVxm+6wqnk3Zmpxl2FG2EGg92C8GDlWptVTwa+uF3xcKmDfFzCUzDsJNsunXipglJXJbrtJWmwZNSnHD3jojRgUIm2UumIZ0JZ7JByrALbMWW0IBW8aRa4+cf76TeX3Nm3uc+z/s+7/vugl4r/aMTrT4e1pPTqnnmJNn5AyUzRnrRle/qE33dsvrBtAQVoxtpZNK3zSzYjUjviWO2Ag+R77dl7W36n/1Ep9KBPG/S+Py0PkjU/gPKQGqwTHryiWYFAXSvMairsio7SjyNsnCzh0qKImV9/7mhfHQZx2yN1O+7rXUm33MUPaboOkAJHaoIdXfJj2xWeyD8jMFEXkvIu5qzpU988gWB5zl+GS+sFe55trEVPdWZB2miq8bBVkNFO2R0qnrfkiXhcJhtDNXE6tbW97/s9O9/7ZfVhx86/CwrROpfvvxboMqeLsuqPr1j44qEwDNMOBximUiYoU8sw7BC/a7T72uEnyJDlGxZ9KcglZRyuqqrv/tSZErgOI4NgRBTIw9EmHAoFGZZnp6aGaJ2GTxfxYs8kKVUQh7WB5hQeC3LsUxoxVKW14l3BX2WcoUYPiZyLLe8teZ+iuT4GGhvV5KpKWkpyzxEr2MZgQ1xdRjfRBoH+2k6lIHjKTHPPBo8CSJISqqq4wGGOcWylIGlgvgNX1Gd8vF5f+IUIwb30ng+Gg2QfBRIMvy0jG8SVkYo4N0zvUXVRztbJ/L6xL7lUZEXBEHkuZqlS6gEAUgKJurnhFtfpACOYd8b/hVbJPqwi44a6KA0sPVjIi/SIyxb3u8KlAJ0S8jRVgrlW+nVHPdrhiXCxu42d86ByksDc80P3MkJFBFQ8Ho1lQegpWJRWFGsDsRwwv7pIyvuQW0ZkrX6NDVFbqcvaQI8vbyqzt5AARrsbKx5yhQEGs+wPO56bOK+0rcwMrOKkpUbZWYxV04UeZZv/cBKFhRL6Qdv9y4LfEDA7/thg7tTmv1a5/GnO0wl0dQg80wglZaHUmxRvjwAHOfyN0mxrpqLUpcjsK3NHYMo4R1o6eho2ZyIb2FoeOC3ILK8kZ2HQMOuWywGXUkJBCeTbYFS0+ym1h2/6UgmvnrvKYZZtIEXGf75C2cIAp5LHNd71x7uPoTjakrWH9e3KFpaatjUvJUysFw0KrLMYMW2lTg4PeUQx6kJEALvxXEmCdVyPLHtCSjBhc01XCjIgafxou+PE6KC1dhxSCwoBCc+N4P3btM84pmdSSjJnjO/nvY4LQfVyz5/I+v6IwjUOMjy+MVCxIbKupTJaEktp7cTKU42Pvjh2m/8cSpC6aPsaX/MHSuUQLVVsIa4RUTs/r/BVAexNdjdnsNG7j/rV93xheLMzKnFrPeTEQchCyCcKb25aAIn7lrAertrZwyNXM8N6zfWrFo3d2SmOEcF83x/r+OOFgrAHYWF7cELjhV7UQo/6WAIUVl9JFl8a//HZ66VpbY3I9QKZqPru77lA+iOWAIr0hKxHCmmr0othSyeIl5y3qt4xT8gSNrKEZozs8Els67rgsLOZ+ygzwMfbtNhobfgzpEyGnz7htPtzUi6PuOoj7K0WF/MXiUFxwGajRD1hjYXHXI9p406qOyinp5/tiWcDHY0jIu4n64Qfq7kliB2gemag9QbOia0PbbDMbd43SHuvxFxrAocxins7MX5Kqbe1QixKBxoV4//PfAgGCu+Rlm4SvZizyDH+0reDHp92iO0BuX3bCfItl0PEwvYLqpwXG2MHlGsQ4S8pMJZv1JGmHiEoHQDdOjwmVlEP/nE9ADKjI8xLI0OOGITfy0SbeG/C2jKUDGSlDhM9I3IpK9iup6XnbRNC7yqueNsJCCIiXzdQhnaGN+46umnEdy5U5UbUJ48LFM9GkJo8BdDOiAZ7ZIQbKhYLMqvhU2wmNxjEAsS2AI7y4nWF64duePbk7YV3zvAVLEMD9AxJRNa3KDUibV7DjnkuprMEYjScFNcaR2ceP2u9R/5k1052Ryme5phAFRswlHjAudiP4dOy7CaxLgdJh9vUlU1702/+LPa1U9fvPi9qlA4XEUBJc3dFlpsR457IDl1iPqLp7o81NQgyV19iYU38uTiv975Pd3SiwQcsGjx+v4/6fl5T7EOOMTCtpbKxfemsQq/3olQZcminADAAI0cuGLHaHOFxbuGvRk/Z9u7CULqoVR6NE0yx1avj30oRhc/jWUoIALGxkz0dg1Dl9iaI7LqOOXKsXJFwjiuEAi70Jra2nW1PL08zLBhZsMABpW5csI7TPfew9ipFKcn5k1i+1KyCWKjC3W/8dF1d666+RaabBVTFTHacjoojBNDh0NDxk+IPTlwfqJkWpbnpFHXIbLbmpxEQ3ff/Z0g/mauXsoln9wDRjy/NHsQFw3P6vWuTJ43/+FZrk2cvAFRipCKdfD9y2+pjRj78s0KdCUDKJvdV91ChngV38T20TM+gghjpJaPlpFr2xbEz5g4A/NGt5rNwdwmYGeeeMXBSLHHUIc+6RsojRH9VTUm3/mLf/64b470XvoxoTKhlMBQ2jMEzo2PjxdGMppmn1RM24bWFJqaQv4BcuJa2Sam7Zokq1ldCsz06NCBHrhwqVQYpfFj42NZexz1EW9SR/kT58nEeQKJb2fPXjjp0u/YUkwHEgLeOnf2nOuf1TRTM02CLKLTPy60/x1CCztqn7Ev+BdsC3m+30decQvW/wBNTwU+CfUQAQAAAABJRU5ErkJggg==')\";\r\n\r\n    if (options.baseSwitcher) {\r\n        //  let switcherContent = '<div class=\"base-map-switcher\" title=\"Toggle Base Layer\" style=\"';\r\n        //  switcherContent += 'position: absolute; top: 70px; left: 4px; border: solid black 1px; ';\r\n        //  switcherContent += `height: 50px; width: 50px; z-index: 10; border-radius: 4px; background: ${aerialCss};`;\r\n        //  switcherContent += '\"></div>';\r\n        //  $mapDiv.append(switcherContent);\r\n        //\r\n        // $mapDiv.find('.base-map-switcher').click(function() {\r\n        //      \"use strict\";\r\n        //      osmLayer.setVisible(!osmLayer.getVisible());\r\n        //      satLayer.setVisible(!satLayer.getVisible());\r\n        //\r\n        //      if (osmLayer.getVisible()){\r\n        //          $(this).css('background', aerialCss);\r\n        //      } else {\r\n        //          $(this).css('background', osmCss);\r\n        //      }\r\n        //  });\r\n    }\r\n\r\n    if (options.zoom < 0 || options.zoom > 28) {\r\n        throw 'zoom out of range';\r\n    }\r\n\r\n    if (options.center.x >= -180 && options.center.x <= 180 && options.center.y >= -90 && options.center.y <= 90) {\r\n        let p = new ol.geom.Point([options.center.x, options.center.y]);\r\n        new ol.proj.Projection({code: \"EPSG:4326\"});\r\n\r\n        p.transform(new ol.proj.Projection({code: \"EPSG:4326\"}), new ol.proj.Projection({code: \"EPSG:3857\"}));\r\n        let coordinates = p.getCoordinates();\r\n        options.center.x = coordinates[0];\r\n        options.center.y = coordinates[1];\r\n    }\r\n\r\n    const controls = ol.control.defaults({\r\n            attributionOptions: {collapsible: false}\r\n        }\r\n    );\r\n\r\n    const view = new ol.View({\r\n        center: [options.center.x, options.center.y],\r\n        zoom: options.zoom,\r\n        minZoom: options.minZoom,\r\n        maxZoom: options.maxZoom\r\n    });\r\n\r\n    let map = new ol.Map({\r\n        layers: [osmLayer],\r\n        target: options.divId,\r\n        controls: controls,\r\n        view: view\r\n    });\r\n\r\n    if (options.fullScreen) {\r\n        map.addControl(new ol.control.FullScreen({}));\r\n    }\r\n\r\n    return map;\r\n}\r\n\r\nnm.quickMapBase = quickMapBase;\r\nexport default quickMapBase;\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/olHelpers/quickMapBase.ts","/**\r\n * Created by gavorhes on 12/14/2015.\r\n */\r\n\r\nimport provide from '../util/provide';\r\nconst nm = provide('olHelpers.zoomResolutionConvert');\r\n\r\nlet _zoomResLookup = [\r\n    156543.03392804097, //0\r\n    78271.51696402048, //1\r\n    39135.75848201024, //2\r\n    19567.87924100512, //3\r\n    9783.93962050256, //4\r\n    4891.96981025128, //5\r\n    2445.98490512564, //6\r\n    1222.99245256282, //7\r\n    611.49622628141, //8\r\n    305.748113140705, //9\r\n    152.8740565703525, //10\r\n    76.43702828517625, //11\r\n    38.21851414258813, //12\r\n    19.109257071294063, //13\r\n    9.554628535647032, //14\r\n    4.777314267823516, //15\r\n    2.388657133911758, //16\r\n    1.194328566955879, //17\r\n    0.5971642834779395, //18\r\n    0.29858214173896974, //19\r\n    0.14929107086948487, //20\r\n    0.07464553543474244, //21\r\n    0.03732276771737122, //22\r\n    0.01866138385868561, //23\r\n    0.009330691929342804, //24\r\n    0.004665345964671402, //25\r\n    0.002332672982335701, //26\r\n    0.0011663364911678506, //27\r\n    0.0005831682455839253 //28\r\n];\r\n\r\n/**\r\n * Get the resolution given the zoom level\r\n * @param {number} zoomLevel - the zoom level\r\n * @returns {number|*} the map resolution\r\n */\r\nexport function zoomToResolution(zoomLevel) {\r\n    \"use strict\";\r\n\r\n    if (typeof zoomLevel == 'number') {\r\n        if (zoomLevel % 1 === 0 && zoomLevel >= 0 && zoomLevel <= 28) {\r\n            return _zoomResLookup[zoomLevel];\r\n        } else {\r\n            console.log(`invalid zoom level provided: ${zoomLevel}`);\r\n\r\n            return undefined;\r\n        }\r\n    } else {\r\n        return undefined;\r\n    }\r\n}\r\nnm.zoomToResolution = zoomToResolution;\r\n\r\n\r\n/**\r\n * Get resolution from the zoom level\r\n * @param {number} resolution - the resolution\r\n * @returns {number|*} the zoom level\r\n */\r\nexport function resolutionToZoom(resolution){\r\n    for (let i = 0; i < _zoomResLookup.length; i++){\r\n        if (resolution >= _zoomResLookup[i] ){\r\n            return i;\r\n        }\r\n    }\r\n\r\n    return 0;\r\n}\r\n\r\nnm.resolutionToZoom = resolutionToZoom;\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/olHelpers/zoomResolutionConvert.ts","module.exports = jquery-ui;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jquery-ui\"\n// module id = 15\n// module chunks = 0 4 5","/**\r\n * Created by gavorhes on 1/4/2016.\r\n */\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nconst nm = provide('olHelpers.esriToOlStyle');\r\n\r\n/**\r\n * This callback is displayed as part of the Requester class.\r\n * @callback styleFunc\r\n * @param {ol.Feature} feat - openlayers feature\r\n * @param {number} resolution - map resolution\r\n */\r\n\r\n/**\r\n *\r\n * @param {Array<number>} colorArray - input color array\r\n * @param {number} opacity - the opacity 0 to 1\r\n * @returns {string} rgba string\r\n * @private\r\n */\r\nfunction _colorArrayToRgba(colorArray, opacity) {\r\n    \"use strict\";\r\n\r\n    return `rgba(${colorArray[0]},${colorArray[1]},${colorArray[2]},${opacity})`;\r\n}\r\n\r\n/**\r\n * escape html charcters\r\n * @param {string} str - input string\r\n * @returns {string} escaped string\r\n */\r\nfunction htmlEscape(str) {\r\n    return String(str)\r\n        .replace(/&/g, '&amp;')\r\n        .replace(/\"/g, '&quot;')\r\n        .replace(/'/g, '&#39;')\r\n        .replace(/</g, '&lt;')\r\n        .replace(/>/g, '&gt;');\r\n}\r\n\r\nnm.htmlEscape = htmlEscape;\r\n\r\n\r\nexport interface EsriResponse{\r\n    drawingInfo: {\r\n        renderer: EsriRenderer\r\n    },\r\n    geometryType: string\r\n}\r\n\r\nexport interface EsriRenderer{\r\n    type: string;\r\n    symbol: EsriSymbol;\r\n    uniqueValueInfos: Array<{label: string, value: any, symbol: EsriSymbol}>;\r\n}\r\n\r\nexport interface EsriSymbol{\r\n    size: number;\r\n    type: string;\r\n    outline:{\r\n        color: string;\r\n        width: number;\r\n    },\r\n    color: string;\r\n    width: number;\r\n}\r\n\r\n\r\nclass CommonSymbol {\r\n    legendHtml: string;\r\n    opacity: number;\r\n    symbolObj: EsriSymbol;\r\n    olStyle: ol.style.Style|Array<ol.style.Style>|ol.StyleFunction;\r\n\r\n    /**\r\n     *\r\n     * @param symbolObj\r\n     * @param {number} opacity\r\n     */\r\n    constructor(symbolObj: EsriSymbol, opacity: number) {\r\n        this.symbolObj = symbolObj;\r\n        this.opacity = opacity;\r\n        this.olStyle = undefined;\r\n        this.legendHtml = '';\r\n    }\r\n}\r\n\r\ninterface ICommonSymbol{\r\n    new (symbolObj: EsriSymbol, opacity: number): CommonSymbol\r\n}\r\n\r\n\r\nclass PointSymbol extends CommonSymbol {\r\n    constructor(symbolObj: EsriSymbol, opacity: number) {\r\n        super(symbolObj, opacity);\r\n        switch (this.symbolObj.type) {\r\n            case 'esriSMS':\r\n                let innerColor = _colorArrayToRgba(this.symbolObj.color, this.opacity);\r\n                let outerColor = _colorArrayToRgba(this.symbolObj.outline.color, this.opacity);\r\n                let outlineWidth = this.symbolObj.outline.width;\r\n                let radius = this.symbolObj.size;\r\n\r\n\r\n                this.olStyle = new ol.style.Style({\r\n                    image: new ol.style.Circle({\r\n                        radius: radius,\r\n                        fill: new ol.style.Fill({\r\n                            color: innerColor\r\n                        }),\r\n                        stroke: new ol.style.Stroke({color: outerColor, width: outlineWidth})\r\n                    })\r\n                });\r\n                this.legendHtml = `<span class=\"legend-layer-icon\" style=\"color: ${innerColor}\">&#9679;</span>`;\r\n                break;\r\n            case 'esriPMS':\r\n                this.olStyle = new ol.style.Style({\r\n                    image: new ol.style.Icon({src: `data:image/png;base64,${this.symbolObj['imageData']}`})\r\n                });\r\n                this.legendHtml = `<img class=\"legend-layer-icon\" height=\"17\" src=\"data:image/png;base64,${this.symbolObj['imageData']}\">`;\r\n                break;\r\n            default:\r\n                console.log(this.symbolObj);\r\n                alert('Point symbol does not handle symbol type: ' + this.symbolObj['type']);\r\n        }\r\n    }\r\n}\r\n\r\nclass LineSymbol extends CommonSymbol {\r\n    constructor(symbolObj: EsriSymbol, opacity: number) {\r\n        super(symbolObj, opacity);\r\n        switch (this.symbolObj.type) {\r\n            case 'esriSLS':\r\n                let innerColor = _colorArrayToRgba(this.symbolObj.color, this.opacity);\r\n                let lineWidth = this.symbolObj.width;\r\n\r\n                this.olStyle = new ol.style.Style({\r\n                    stroke: new ol.style.Stroke({\r\n                        color: innerColor,\r\n                        //lineDash: [4],\r\n                        width: lineWidth\r\n                    })\r\n                });\r\n\r\n                this.legendHtml = `<span class=\"legend-layer-icon\" `;\r\n                this.legendHtml += `style=\"`;\r\n                this.legendHtml += `background-color: ${innerColor};`;\r\n                this.legendHtml += `width: 40px;`;\r\n                this.legendHtml += `height: 4px;`;\r\n                this.legendHtml += `position: relative;`;\r\n                this.legendHtml += `display: inline-block;`;\r\n                this.legendHtml += `top: -1px;`;\r\n                this.legendHtml += `\"></span>`;\r\n                break;\r\n            default:\r\n                console.log(this.symbolObj);\r\n                alert('Line symbol does not handle symbol type: ' + this.symbolObj['type']);\r\n        }\r\n    }\r\n}\r\n\r\nclass PolygonSymbol extends CommonSymbol {\r\n    constructor(symbolObj: EsriSymbol, opacity: number) {\r\n        super(symbolObj, opacity);\r\n        switch (this.symbolObj['type']) {\r\n            case 'esriSFS':\r\n                let innerColor = _colorArrayToRgba(this.symbolObj.color, this.opacity);\r\n                let outerColor = _colorArrayToRgba(this.symbolObj.outline.color, this.opacity);\r\n                let outlineWidth = this.symbolObj.outline.width;\r\n\r\n                this.olStyle = new ol.style.Style({\r\n                    stroke: new ol.style.Stroke({\r\n                        color: outerColor,\r\n                        //lineDash: [4],\r\n                        width: outlineWidth\r\n                    }),\r\n                    fill: new ol.style.Fill({\r\n                        color: innerColor\r\n                    })\r\n                });\r\n\r\n                this.legendHtml = `<span class=\"legend-layer-icon\" `;\r\n                this.legendHtml += `style=\"`;\r\n                this.legendHtml += `background-color: ${innerColor};`;\r\n                this.legendHtml += `border: solid ${outerColor} 1px;`;\r\n                this.legendHtml += `width: 40px;`;\r\n                this.legendHtml += `height: 9px;`;\r\n                this.legendHtml += `position: relative;`;\r\n                this.legendHtml += `display: inline-block;`;\r\n                this.legendHtml += `top: 2px;`;\r\n                this.legendHtml += `\"></span>`;\r\n                break;\r\n\r\n            default:\r\n                console.log(this.symbolObj);\r\n                alert('Polygon symbol does handle symbol type: ' + this.symbolObj['type']);\r\n        }\r\n    }\r\n}\r\n\r\nclass SymbolGenerator {\r\n    opacity: number;\r\n    renderer: EsriRenderer;\r\n    legendHtml: string;\r\n    olStyle: ol.style.Style|Array<ol.style.Style>|ol.StyleFunction;\r\n\r\n    constructor(esriResponse: EsriResponse) {\r\n        this.opacity = (100 - (esriResponse['drawingInfo']['transparency'] || 0)) / 100;\r\n        this.renderer = esriResponse.drawingInfo.renderer;\r\n        this.olStyle = undefined;\r\n        this.legendHtml = '';\r\n    }\r\n}\r\n\r\nclass SingleSymbol extends SymbolGenerator {\r\n    symbol: EsriSymbol;\r\n    /**\r\n     *\r\n     * @param {object} esriResponse - layer info\r\n     * @param SymbolClass - the symbol class to use\r\n     */\r\n    constructor(esriResponse, SymbolClass: ICommonSymbol) {\r\n        super(esriResponse);\r\n        this.symbol = this.renderer.symbol;\r\n        let symbolObj = new SymbolClass(this.symbol, this.opacity);\r\n        this.olStyle = symbolObj.olStyle;\r\n        this.legendHtml = symbolObj.legendHtml;\r\n    }\r\n}\r\n\r\nclass UniqueValueSymbol extends SymbolGenerator {\r\n\r\n    propertyName: string;\r\n    defaultSymbol: EsriSymbol;\r\n    defaultStyle: ol.style.Style|Array<ol.style.Style>|ol.StyleFunction;\r\n    defaultLabelHtml: string;\r\n    labelArray: Array<string>;\r\n    legendArray: Array<string>;\r\n    propertyStyleLookup: Object;\r\n    valueArray: Array<any>;\r\n    uniqueValueInfos: Array<{label: string, value: any, symbol: EsriSymbol}>;\r\n\r\n    /**\r\n     *\r\n     * @param {object} esriResponse - layer info\r\n     * @param SymbolClass - the Symbol class definition\r\n     */\r\n    constructor(esriResponse: EsriResponse, SymbolClass: ICommonSymbol) {\r\n        super(esriResponse);\r\n        this.uniqueValueInfos = this.renderer['uniqueValueInfos'];\r\n        this.propertyName = this.renderer['field1'];\r\n        this.defaultSymbol = this.renderer['defaultSymbol'];\r\n\r\n\r\n        if (this.defaultSymbol) {\r\n            let symbolObj = new SymbolClass(this.defaultSymbol, this.opacity);\r\n            this.defaultStyle = symbolObj.olStyle;\r\n            this.defaultLabelHtml = `<span class=\"legend-layer-subitem\">${htmlEscape(this.renderer['defaultLabel'])}</span>` + symbolObj.legendHtml;\r\n        } else {\r\n            this.defaultStyle = undefined;\r\n            this.defaultLabelHtml = 'other';\r\n        }\r\n\r\n        this.valueArray = [];\r\n        this.labelArray = [];\r\n        this.legendArray = [];\r\n        this.propertyStyleLookup = {};\r\n\r\n        for (let uniqueVal of this.uniqueValueInfos) {\r\n            this.labelArray.push(uniqueVal['label']);\r\n            this.valueArray.push(uniqueVal['value']);\r\n            let uniqueSym = new SymbolClass(uniqueVal.symbol, this.opacity);\r\n            this.legendArray.push(`<span class=\"legend-layer-subitem\">${htmlEscape(uniqueVal['label'])}</span>` + uniqueSym.legendHtml);\r\n            this.propertyStyleLookup[uniqueVal['value']] = uniqueSym.olStyle;\r\n        }\r\n\r\n\r\n        this.olStyle = (feature: ol.Feature) => {\r\n            let checkProperties = feature.getProperties();\r\n            let checkProperty = checkProperties[this.propertyName];\r\n\r\n            let returnValue;\r\n            if (this.propertyStyleLookup[checkProperty] !== undefined) {\r\n                returnValue = [this.propertyStyleLookup[checkProperty]];\r\n            } else {\r\n               returnValue = [this.defaultStyle];\r\n            }\r\n\r\n            return returnValue;\r\n        };\r\n\r\n        if (this.defaultLabelHtml !== null) {\r\n            this.legendArray.push(this.defaultLabelHtml);\r\n        }\r\n\r\n        this.legendHtml = '<ul>';\r\n        for (let h of this.legendArray) {\r\n            this.legendHtml += `<li>${h}</li>`;\r\n        }\r\n        this.legendHtml += '</ul>';\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * style and legend object\r\n * @typedef {object} styleAndLegend\r\n * @property {styleFunc} style - style function\r\n * @property {string} legend - legend content\r\n */\r\n\r\n/**\r\n *\r\n * @param {object} esriResponse - layer info\r\n * @returns {styleAndLegend} style and legend object\r\n */\r\nexport function makeFeatureServiceLegendAndSymbol(esriResponse: EsriResponse) {\r\n    \"use strict\";\r\n    let renderer = esriResponse.drawingInfo.renderer;\r\n    let symbolLegendOut: SymbolGenerator = null;\r\n\r\n    switch (renderer.type) {\r\n        case 'simple':\r\n            switch (esriResponse.geometryType) {\r\n                case 'esriGeometryPoint':\r\n                    symbolLegendOut = new SingleSymbol(esriResponse, PointSymbol);\r\n                    break;\r\n                case 'esriGeometryPolyline':\r\n                    symbolLegendOut = new SingleSymbol(esriResponse, LineSymbol);\r\n                    break;\r\n                case 'esriGeometryPolygon':\r\n                    symbolLegendOut = new SingleSymbol(esriResponse, PolygonSymbol);\r\n                    break;\r\n                default:\r\n                    console.log(esriResponse);\r\n                    alert(esriResponse.geometryType + ' not handled');\r\n            }\r\n            break;\r\n        case 'uniqueValue':\r\n            switch (esriResponse.geometryType) {\r\n                case 'esriGeometryPoint':\r\n                    symbolLegendOut = new UniqueValueSymbol(esriResponse, PointSymbol);\r\n                    break;\r\n                case 'esriGeometryPolyline':\r\n                    symbolLegendOut = new UniqueValueSymbol(esriResponse, LineSymbol);\r\n                    break;\r\n                case 'esriGeometryPolygon':\r\n                    symbolLegendOut = new UniqueValueSymbol(esriResponse, PolygonSymbol);\r\n                    break;\r\n                default:\r\n                    console.log(esriResponse);\r\n                    alert(esriResponse['geometryType'] + ' not handled');\r\n            }\r\n            break;\r\n        default:\r\n            alert('not handled renderer type: ' + renderer['type']);\r\n    }\r\n\r\n    if (symbolLegendOut == null) {\r\n        return {style: undefined, legend: ''};\r\n    } else {\r\n        return {style: symbolLegendOut.olStyle, legend: symbolLegendOut.legendHtml};\r\n    }\r\n}\r\n\r\nnm.makeFeatureServiceLegendAndSymbol = makeFeatureServiceLegendAndSymbol;\r\n\r\n\r\n/**\r\n *\r\n * @param {object} lyrObject - the layer as defined in the response\r\n * @param {boolean} [skipLayerNameAndExpander=false] use only icons\r\n * @returns {string} legend html\r\n */\r\nfunction mapServiceLegendItem(lyrObject, skipLayerNameAndExpander: boolean = false) {\r\n\r\n\r\n    skipLayerNameAndExpander = typeof skipLayerNameAndExpander == 'boolean' ? skipLayerNameAndExpander : false;\r\n    let layerName = lyrObject['layerName'];\r\n    let legendItems = lyrObject['legend'];\r\n    let legendHtml = '';\r\n\r\n    if (!skipLayerNameAndExpander) {\r\n        legendHtml += `<span class=\"legend-layer-subitem\">${layerName}</span>`;\r\n    }\r\n\r\n    if (legendItems.length == 1) {\r\n        legendHtml = `<img class=\"legend-layer-icon\" height=\"17\" src=\"data:image/png;base64,${legendItems[0]['imageData']}\">`;\r\n    } else {\r\n        if (!skipLayerNameAndExpander) {\r\n            legendHtml += '<span class=\"legend-items-expander\" title=\"Expand/Collapse\">&#9660;</span>';\r\n        }\r\n        legendHtml += '<ul>';\r\n        for (let i = 0; i < legendItems.length; i++) {\r\n            legendHtml += `<li>`;\r\n            legendHtml += `<span class=\"legend-layer-subitem\">${htmlEscape(legendItems[i]['label'])}</span>`;\r\n            legendHtml += `<img class=\"legend-layer-icon\" height=\"17\" src=\"data:image/png;base64,${legendItems[i]['imageData']}\">`;\r\n            legendHtml += `</li>`;\r\n        }\r\n        legendHtml += '</ul>';\r\n    }\r\n\r\n    if (!skipLayerNameAndExpander) {\r\n        legendHtml = `<span class=\"legend-layer-subitem\">${layerName}</span>` + legendHtml;\r\n    }\r\n\r\n    return legendHtml;\r\n}\r\n\r\n/**\r\n * make map service legent\r\n * @param {object} esriResponse - layer info\r\n * @returns {string} legend content\r\n */\r\nexport function makeMapServiceLegend(esriResponse) {\r\n    \"use strict\";\r\n\r\n    let newLegendHtml = '';\r\n\r\n    let layers = esriResponse['layers'];\r\n\r\n    if (layers.length == 1) {\r\n        newLegendHtml += mapServiceLegendItem(layers[0], true);\r\n    } else {\r\n        newLegendHtml += '<ul>';\r\n        for (let i = 0; i < layers.length; i++) {\r\n            newLegendHtml += '<li>' + mapServiceLegendItem(layers[i]) + '</li>';\r\n        }\r\n        newLegendHtml += '</ul>';\r\n    }\r\n\r\n    return newLegendHtml;\r\n}\r\n\r\nnm.makeMapServiceLegend = makeMapServiceLegend;\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/olHelpers/esriToOlStyle.ts","/**\r\n * Created by gavorhes on 11/2/2015.\r\n */\r\n\r\nimport provide from '../util/provide';\r\nimport {rangeChange} from './range-change';\r\nimport $ = require('jquery');\r\n\r\nlet nm = provide('domUtil');\r\n\r\n/**\r\n * @callback mediaCallback\r\n * @param {number} tm\r\n */\r\n\r\nfunction timeToLocalDateString(tm) {\r\n    \"use strict\";\r\n    let d = new Date(tm);\r\n    let p1 = d.toLocaleTimeString().split(' ');\r\n    let p2 = p1[0].split(':');\r\n    p2 = p2.slice(0, 2);\r\n\r\n    return d.toLocaleDateString() + '<br>' + p2.join(':') + ' ' + p1[1];\r\n}\r\n\r\nexport interface changeFunction{\r\n    (newVal?: number): void;\r\n}\r\n\r\nexport interface mediaRangeConfig{\r\n    min?: number;\r\n    max?: number;\r\n    val?: number;\r\n    step?: number;\r\n    playInterval?: number;\r\n    showAsDate?: boolean;\r\n}\r\n\r\n\r\n\r\nexport class MediaControl {\r\n    _container: JQuery;\r\n    _min: number;\r\n    _max: number;\r\n    _playInterval: number;\r\n    _step: number;\r\n    _currentValue: number;\r\n\r\n    _playing: boolean;\r\n\r\n    _$btnStop: JQuery;\r\n    _$slider: JQuery;\r\n    _$valLabelVal: JQuery;\r\n    _$valLabelMin: JQuery;\r\n    _$valLabelMax: JQuery;\r\n    _interval: number;\r\n    _showAsDate: boolean;\r\n\r\n    _changeFunc: changeFunction;\r\n\r\n    /**\r\n     *\r\n     * @param element\r\n     * @param changeFunc\r\n     * @param mediaConfig\r\n     */\r\n    constructor(\r\n        element: JQuery|HTMLElement|string,\r\n        changeFunc: changeFunction = (): void => {return;},\r\n        mediaConfig: mediaRangeConfig = {}) {\r\n\r\n        mediaConfig.min = typeof mediaConfig.min == 'number' ? mediaConfig.min : 0;\r\n        mediaConfig.max = typeof mediaConfig.max == 'number' ? mediaConfig.max : 100;\r\n        mediaConfig.val = typeof mediaConfig.val == 'number' ? mediaConfig.val : 0;\r\n        mediaConfig.step = typeof mediaConfig.step == 'number' ? mediaConfig.step : 5;\r\n        mediaConfig.playInterval = typeof mediaConfig.playInterval == 'number' ? mediaConfig.playInterval : 500;\r\n        mediaConfig.showAsDate = typeof mediaConfig.showAsDate == 'boolean' ? mediaConfig.showAsDate : false;\r\n\r\n        if (typeof  element == 'string'){\r\n            this._container = $('#' + element);\r\n        }\r\n        else if (typeof element['style'] !== 'undefined'){\r\n            this._container = $(element);\r\n        } else {\r\n            this._container = element as JQuery;\r\n        }\r\n\r\n        this._container.addClass('media-control-container');\r\n        this._playInterval = mediaConfig.playInterval;\r\n        this._changeFunc = changeFunc;\r\n\r\n        this._showAsDate = mediaConfig.showAsDate;\r\n\r\n        this._currentValue = undefined;\r\n        this._min = undefined;\r\n        this._max = undefined;\r\n        this._step = undefined;\r\n        this._playing = false;\r\n\r\n        let htmlStr =\r\n            '<span class=\"media-player-button media-back\"></span>' +\r\n            '<span class=\"media-player-button media-play\"></span>' +\r\n            '<span class=\"media-player-button media-pause media-disabled\"></span>' +\r\n            '<span class=\"media-player-button media-stop media-disabled\" ></span>' +\r\n            '<span class=\"media-player-button media-ahead\"></span>' +\r\n            `<input type=\"range\">` +\r\n            `<div class=\"media-control-value-label-container\">` +\r\n            `<span class=\"media-control-value-label-min\"></span>` +\r\n            `<span class=\"media-control-value-label-val\"></span>` +\r\n            `<span class=\"media-control-value-label-max\"></span>` +\r\n            `</div>`;\r\n\r\n        this._container.append(htmlStr);\r\n\r\n        // let btnPause = this._container.find('.media-pause');\r\n        let btnPlay = this._container.find('.media-play');\r\n        this._$btnStop = this._container.find('.media-stop');\r\n        let btnAhead = this._container.find('.media-ahead');\r\n        let btnBack = this._container.find('.media-back');\r\n        this._$slider = this._container.find('input[type=range]');\r\n\r\n        this._$valLabelMin = this._container.find('.media-control-value-label-min');\r\n        this._$valLabelVal = this._container.find('.media-control-value-label-val');\r\n        this._$valLabelMax = this._container.find('.media-control-value-label-max');\r\n\r\n        this.setMinMaxValueStep(mediaConfig.min, mediaConfig.max, mediaConfig.val, mediaConfig.step);\r\n\r\n        rangeChange(this._$slider,(newVal) => { this.currentValue = newVal;}, 100);\r\n\r\n        let ___this = this;\r\n\r\n        btnPlay.click(function () {\r\n            let $this = $(this);\r\n            $this.addClass('media-disabled');\r\n            ___this._$btnStop.removeClass('media-disabled');\r\n            btnAhead.addClass('media-locked');\r\n            btnBack.addClass('media-locked');\r\n            ___this._$slider.prop('disabled', true);\r\n            ___this._playing = true;\r\n\r\n            ___this._interval = setInterval(function () {\r\n                ___this.currentValue += ___this._step;\r\n            }, ___this._playInterval);\r\n        });\r\n\r\n        this._$btnStop.click(function () {\r\n            clearInterval(___this._interval);\r\n            let $this = $(this);\r\n            $this.addClass('media-disabled');\r\n            btnPlay.removeClass('media-disabled');\r\n            btnAhead.removeClass('media-locked');\r\n            btnBack.removeClass('media-locked');\r\n            ___this._$slider.prop('disabled', false);\r\n            ___this._playing = false;\r\n        });\r\n\r\n        btnAhead.click(function () {\r\n            ___this.currentValue = ___this.currentValue + ___this._step;\r\n        });\r\n\r\n        btnBack.click(function () {\r\n            ___this.currentValue = ___this.currentValue - ___this._step;\r\n        });\r\n    }\r\n\r\n    stopPlaying(){\r\n        if (this._playing){\r\n            this._$btnStop.trigger('click');\r\n        }\r\n    }\r\n\r\n    get playing(){\r\n        return this._playing;\r\n    }\r\n\r\n    get min() {\r\n        return this._min;\r\n    }\r\n\r\n    get max() {\r\n        return this._max;\r\n    }\r\n\r\n    get step() {\r\n        return this._step;\r\n    }\r\n\r\n    get currentValue() {\r\n        return this._currentValue;\r\n    }\r\n\r\n    set currentValue(newValue) {\r\n        if (newValue > this._max) {\r\n            newValue = this._min;\r\n        } else if (newValue < this._min) {\r\n            newValue = this._max;\r\n        }\r\n        this._currentValue = newValue;\r\n        this._$slider.val(this._currentValue.toFixed(2));\r\n\r\n        if (this._showAsDate) {\r\n            this._$valLabelVal.html(timeToLocalDateString(this.currentValue));\r\n        } else {\r\n            this._$valLabelVal.html(this.currentValue.toString());\r\n        }\r\n\r\n        this._changeFunc(newValue);\r\n    }\r\n\r\n    /**\r\n     * set min and max value with step\r\n     * @param {number} newMin the new min\r\n     * @param {number} newMax the new mas\r\n     * @param {number} [newValue=newMin] the value to set\r\n     * @param {number} [newStep=(newMax-newMin)/20] step value\r\n     */\r\n    setMinMaxValueStep(newMin, newMax, newValue, newStep) {\r\n        this._min = newMin;\r\n        this._max = newMax;\r\n\r\n        newValue = typeof newValue == 'number' ? newValue : newMin;\r\n        newStep = typeof newStep == 'number' ? newStep : (newMax-newMin)/20;\r\n\r\n        this._currentValue = newValue;\r\n        this._step = newStep;\r\n\r\n        this._$slider.prop('min', this.min.toString());\r\n        this._$slider.prop('max', this.max.toString());\r\n        this._$slider.prop('step', this.step.toString());\r\n        this._$slider.val(this.currentValue.toString());\r\n\r\n        if (this._showAsDate) {\r\n            this._$valLabelMin.html(timeToLocalDateString(this._min));\r\n            this._$valLabelVal.html(timeToLocalDateString(this.currentValue));\r\n            this._$valLabelMax.html(timeToLocalDateString(this._max));\r\n        } else {\r\n            this._$valLabelMin.html(this._min.toString());\r\n            this._$valLabelVal.html(this.currentValue.toString());\r\n            this._$valLabelMax.html(this._max.toString());\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {mediaCallback} newFunc the callback on change\r\n     */\r\n    set changeFunction(newFunc: changeFunction) {\r\n        this._changeFunc = newFunc;\r\n    }\r\n}\r\n\r\nnm.MediaControl = MediaControl;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/domUtil/media-control.ts","import provide from '../util/provide';\r\nimport $ = require('jquery');\r\n\r\nconst nm = provide('domUtil');\r\n\r\nlet mouseIn = false;\r\nlet mouseDown = false;\r\nlet timeout = null;\r\nlet dragged = false;\r\nlet lastVal;\r\n\r\n\r\n/**\r\n * callback on range change interaction, context of this is the firing dom element\r\n * @callback rangeChangeCallback\r\n * @param {number} newValue\r\n * @param {number} ratio value from 0 to 1 relative of the value to the min and max\r\n * @param {object} evt\r\n */\r\n\r\n/***\r\n * callback funcion after the slider has been moved\r\n */\r\nexport interface rangeChangedCallback{\r\n    /**\r\n     *\r\n     * @param newValue new value of the slider\r\n     * @param ratio ratio from low to high, 0 to 1\r\n     * @param evt the original event\r\n     */\r\n    (newValue: number, ratio: number, evt: Event): any\r\n}\r\n\r\n\r\n/**\r\n * Created by gavorhes on 11/2/2015.\r\n */\r\n\r\nfunction triggerCallback(callback: rangeChangedCallback, evt) {\r\n    \"use strict\";\r\n\r\n    let val = parseFloat(this.value);\r\n    let min = parseFloat(this.min);\r\n    let max = parseFloat(this.max);\r\n    let step = parseFloat(this.step);\r\n\r\n    if (max - val < step){\r\n        val = max;\r\n    }\r\n\r\n    let percent =  (val - min) / (max - min);\r\n\r\n    if (typeof lastVal == 'number' && val ==  lastVal){\r\n        return;\r\n    }\r\n    lastVal = val;\r\n    callback(val, percent, evt);\r\n}\r\n\r\n\r\n\r\n/**\r\n * Add a variety of listeners for range inputs applied to a common callback\r\n * @param  $slider - jquery reference to the slider\r\n * @param {rangeChangeCallback} callback - the callback\r\n * @param {number} [changeTimeout=75] before the callback is called\r\n * @this {jQuery}\r\n * @returns {jQuery} the jQuery object\r\n */\r\nexport function rangeChange ($slider: JQuery, callback: rangeChangedCallback, changeTimeout: number) {\r\n\r\n    changeTimeout = typeof  changeTimeout == 'number' ? changeTimeout : 75;\r\n\r\n    $slider.mouseenter(function () {\r\n        mouseIn = true;\r\n    });\r\n\r\n    $slider.mouseleave(function () {\r\n        mouseIn = false;\r\n        mouseDown = false;\r\n    });\r\n\r\n    $slider.mousedown(function () {\r\n        mouseDown = true;\r\n    });\r\n\r\n    $slider.mouseup(function () {\r\n        mouseDown = false;\r\n    });\r\n\r\n    $slider.mousemove(\r\n        /**\r\n         *\r\n         * @param {object} evt - event properties\r\n         * @this {HTMLElement}\r\n         */\r\n        function (evt) {\r\n        if (!(mouseIn && mouseDown)) {\r\n            return;\r\n        }\r\n\r\n        dragged = true;\r\n\r\n        if (lastVal == this['value']) {\r\n            return;\r\n        }\r\n        lastVal = this['value'];\r\n\r\n        if (timeout != null) {\r\n            clearTimeout(timeout);\r\n        }\r\n\r\n        let _this = this;\r\n\r\n        timeout = setTimeout(function () {\r\n            triggerCallback.call(_this, callback, evt);\r\n            timeout = null;\r\n\r\n        }, changeTimeout);\r\n    });\r\n\r\n    $slider.keyup(\r\n        /**\r\n         *\r\n         * @param {object} evt - event properties\r\n         */\r\n        function (evt) {\r\n        if (evt.keyCode == 37 || evt.keyCode == 39) {\r\n            triggerCallback.call(this, callback, evt);\r\n        }\r\n    });\r\n\r\n    $slider.change(function (evt) {\r\n        if (dragged) {\r\n            dragged = false;\r\n\r\n            return;\r\n        }\r\n        triggerCallback.call(this, callback, evt);\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\nnm.rangeChange = rangeChange;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/domUtil/range-change.ts","import {LayerBase, LayerBaseOptions} from './LayerBase';\r\nimport mapMove from '../olHelpers/mapMove';\r\nimport MapMoveCls from '../olHelpers/mapMoveCls'\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nimport $ = require('jquery');\r\n\r\nconst nm = provide('layers');\r\n\r\nexport interface makeMapMoveParams {\r\n    /**\r\n     *\r\n     * @param lyr\r\n     * @param extent\r\n     * @param zoomLevel\r\n     */\r\n    (lyr: LayerBaseVector, extent: Array<number>, zoomLevel?: number): any\r\n}\r\n\r\n\r\n\r\n\r\nexport interface LayerBaseVectorOptions extends LayerBaseOptions{\r\n    autoLoad?: boolean;\r\n    style?: ol.style.Style|Array<ol.style.Style>|ol.StyleFunction;\r\n    onDemand?: boolean;\r\n    onDemandDelay?: number;\r\n    mapMoveMakeGetParams?: makeMapMoveParams;\r\n    mapMoveObj?: MapMoveCls;\r\n    renderOrder?: (a: ol.Feature, b: ol.Feature) => number;\r\n\r\n}\r\n\r\n\r\n\r\n/**\r\n * The Vector layer base\r\n * @augments LayerBase\r\n * @abstract\r\n */\r\nexport class LayerBaseVector extends LayerBase {\r\n    _olLayer: ol.layer.Vector;\r\n    _source: ol.source.Vector;\r\n    _style: ol.style.Style|Array<ol.style.Style>|ol.StyleFunction;\r\n    _autoLoad: boolean;\r\n    _onDemand: boolean;\r\n    _onDemandDelay: number;\r\n    _mapMoveMakeGetParams: makeMapMoveParams;\r\n    _mapMoveParams: any;\r\n    _mapMove: MapMoveCls;\r\n    _projectionMap: ol.proj.Projection;\r\n    _projection4326: ol.proj.Projection;\r\n\r\n\r\n\r\n    /**\r\n     * The base vector layer\r\n     * @param {string} url - pass an empty string to prevent default load and add from a json source\r\n     * @param {object} options - config\r\n     * @param {string} [options.id] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] the z index for the layer\r\n     * @param {function} [options.loadCallback] function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent] additional content to add to the legend\r\n     *\r\n     * @param {boolean} [options.autoLoad=false] if the layer should auto load if not visible\r\n     * @param {object} [options.style=undefined] the layer style, use openlayers default style if not defined\r\n     * @param {boolean} [options.onDemand=false] if the layer should be loaded by extent on map move\r\n     * @param {number} [options.onDemandDelay=300] delay before the map move callback should be called\r\n     * @param {mapMoveMakeGetParams} [options.mapMoveMakeGetParams=function(lyr, extent, zoomLevel){}] function to create additional map move params\r\n     * @param {MapMoveCls} [options.mapMoveObj=mapMove] alternate map move object for use with multi map pages\r\n     *\r\n     */\r\n    constructor(url: string, options: LayerBaseVectorOptions = {}) {\r\n        super(url, options);\r\n\r\n        options = options as LayerBaseVectorOptions;\r\n\r\n        //prevent regular load if no url has been provided\r\n        if (this.url.trim() == '') {\r\n            this._loaded = true;\r\n        }\r\n\r\n        this._style = typeof options.style == 'undefined' ? undefined : options.style;\r\n\r\n        if (this.visible) {\r\n            this._autoLoad = true;\r\n        } else {\r\n            this._autoLoad = (typeof options['autoLoad'] == 'boolean' ? options['autoLoad'] : false);\r\n        }\r\n\r\n        this._onDemand = typeof options.onDemand == 'boolean' ? options.onDemand : false;\r\n        this._onDemandDelay = typeof options.onDemandDelay == 'number' ? options.onDemandDelay : 300;\r\n\r\n        if (options.mapMoveObj) {\r\n            this._mapMove = options.mapMoveObj;\r\n        } else {\r\n            this._mapMove = this._onDemand ? mapMove : undefined;\r\n        }\r\n\r\n\r\n        this._mapMoveMakeGetParams = typeof options.mapMoveMakeGetParams == 'function' ? options.mapMoveMakeGetParams :\r\n            function () {return {};};\r\n\r\n        if (this._onDemand) {\r\n            this._loaded = true;\r\n            this._mapMoveParams = {};\r\n            this._mapMove.checkInit();\r\n            this._mapMove.addVectorLayer(this);\r\n        }\r\n\r\n        this._source = new ol.source.Vector();\r\n\r\n\r\n        this._olLayer = new ol.layer.Vector(\r\n            {\r\n                source: this._source,\r\n                visible: this.visible,\r\n                style: this.style,\r\n                minResolution: this._minResolution,\r\n                maxResolution: this._maxResolution,\r\n                renderOrder: options.renderOrder\r\n            }\r\n        );\r\n\r\n        this.olLayer.setZIndex(this._zIndex);\r\n\r\n\r\n        this._projectionMap = null;\r\n        this._projection4326 = new ol.proj.Projection({code: \"EPSG:4326\"});\r\n    }\r\n\r\n    /**\r\n     * dummy to be overridden\r\n     * @param {object} featureCollection - geojson or esrijson object\r\n     */\r\n    addFeatures(featureCollection) {\r\n        console.log('Layer vector base addFeatures is a placeholder and does nothing');\r\n    }\r\n\r\n    /**\r\n     * Before call to map move callback, can prevent call by returning false\r\n     * @param {number} zoom - zoom level\r\n     * @param {string} [evtType=undefined] undefined for initial load, otherwise one of 'change:center', 'change:resolution'\r\n     * @returns {boolean} if the call should proceed\r\n     */\r\n    mapMoveBefore(zoom, evtType) {\r\n        if (this.minZoom !== undefined) {\r\n            if (zoom < this.minZoom) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        if (this.maxZoom !== undefined) {\r\n            if (zoom > this.maxZoom) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return this.visible;\r\n    }\r\n\r\n    /**\r\n     * callback to generate the parameters passed in the get request\r\n     * @param {object} extent - extent object\r\n     * @param {number} extent.minX - minX\r\n     * @param {number} extent.minY - minY\r\n     * @param {number} extent.maxX - maxX\r\n     * @param {number} extent.maxY - maxY\r\n     * @param {number} zoomLevel - zoom level\r\n     */\r\n    mapMoveMakeGetParams(extent, zoomLevel) {\r\n        this._mapMoveParams = {};\r\n        $.extend(this._mapMoveParams, this.params);\r\n        $.extend(this._mapMoveParams, this._mapMoveMakeGetParams(this, extent, zoomLevel));\r\n    }\r\n\r\n    /**\r\n     * callback function on map move\r\n     * @param {object} d - the json response\r\n     */\r\n    mapMoveCallback(d) {\r\n        if (this.source) {\r\n            this._source.clear();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * clear features in the layer\r\n     */\r\n    clear() {\r\n        if (this._source) {\r\n            this._source.clear();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * get on demand delay in miliseconds\r\n     */\r\n    get onDemandDelay(): number {\r\n        return this._onDemandDelay;\r\n    }\r\n\r\n    /**\r\n     * get if the layer is autoloaded\r\n     */\r\n    get autoLoad(): boolean {\r\n        return this._autoLoad;\r\n    }\r\n\r\n    /**\r\n     * get the style definition\r\n     */\r\n    get style(): ol.StyleFunction|Array<ol.style.Style>|ol.style.Style {\r\n        return this._style;\r\n    }\r\n\r\n    /**\r\n     * set the style\r\n     * @param style - the style or function\r\n     */\r\n    set style(style: ol.StyleFunction|Array<ol.style.Style>|ol.style.Style) {\r\n        this._style = style;\r\n        this.olLayer.setStyle(this._style as ol.style.Style);\r\n    }\r\n\r\n    /**\r\n     * get the map CRS if it is defined by the map move object\r\n     */\r\n    get mapCrs(): string {\r\n        return this.mapProj == null ? null : this.mapProj.getCode();\r\n    }\r\n\r\n    get mapProj(): ol.proj.Projection{\r\n        if (this._projectionMap != null){\r\n            return this._projectionMap;\r\n        }\r\n\r\n        if (this._mapMove) {\r\n            this._projectionMap = this._mapMove.map.getView().getProjection();\r\n            return this._projectionMap;\r\n        } else {\r\n            return null;\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * get the map move object\r\n     * @type {MapMoveCls|*}\r\n     */\r\n    get mapMove(): MapMoveCls {\r\n        return this._mapMove;\r\n    }\r\n\r\n    /**\r\n     * map move params\r\n     * @type {object}\r\n     */\r\n    get mapMoveParams() {\r\n        return this._mapMoveParams;\r\n    }\r\n\r\n    get visible(): boolean{\r\n        return this._visible;\r\n    }\r\n\r\n    /**\r\n     * Set the layer visibility\r\n     * @type {boolean}\r\n     * @override\r\n     */\r\n    set visible(visibility) {\r\n        super.setVisible(visibility);\r\n\r\n        if (this._onDemand) {\r\n            this.mapMove.triggerLyrLoad(this);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * get the layer vector source\r\n     * @override\r\n     */\r\n    get source(): ol.source.Vector {\r\n        return this.getSource() as ol.source.Vector;\r\n    }\r\n\r\n    /**\r\n     * array of ol features\r\n     */\r\n    get features(): Array<ol.Feature> {\r\n        return this.source.getFeatures();\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    get olLayer(): ol.layer.Vector {\r\n        return super.getOlLayer() as ol.layer.Vector;\r\n    }\r\n\r\n    protected setZIndex(newZ: number) {\r\n        this.olLayer.setZIndex(newZ);\r\n    }\r\n}\r\n\r\nnm.LayerBaseVector = LayerBaseVector;\r\nexport default LayerBaseVector;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/layers/LayerBaseVector.ts","/**\r\n * Created by gavorhes on 11/2/2015.\r\n */\r\n\r\nimport {LayerBaseVector, LayerBaseVectorOptions} from './LayerBaseVector';\r\nimport * as esriToOl from '../olHelpers/esriToOlStyle';\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nimport $ = require('jquery');\r\nlet nm = provide('layers');\r\n\r\nexport interface LayerBaseVectorEsriOptions  extends LayerBaseVectorOptions{\r\n    format?: string;\r\n    outSR?: number;\r\n    where?: string;\r\n    outFields?: string;\r\n    useEsriStyle?: boolean;\r\n}\r\n\r\n/**\r\n * Base layer for esri vector layers\r\n * @augments LayerBaseVector\r\n */\r\nexport class LayerBaseVectorEsri extends LayerBaseVector {\r\n    _outSR: number;\r\n    _esriFormat: ol.format.EsriJSON;\r\n    _urlCopy: string;\r\n    _useEsriStyle: boolean;\r\n\r\n    /**\r\n     * The base vector layer\r\n     * @param {string} url - url for source\r\n     * @param {object} options - config\r\n     * @param {string} [options.id] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] the z index for the layer\r\n     * @param {function} [options.loadCallback] function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent] additional content to add to the legend\r\n     *\r\n     * @param {boolean} [options.autoLoad=false] if the layer should auto load if not visible\r\n     * @param {object} [options.style=undefined] the layer style, use openlayers default style if not defined\r\n     * @param {boolean} [options.onDemand=false] if the layer should be loaded by extent on map move\r\n     * @param {number} [options.onDemandDelay=300] delay before the map move callback should be called\r\n     * @param {MapMoveCls} [options.mapMoveObj=mapMove] alternate map move object for use with multi map pages\r\n     *\r\n     * @param {string} [options.where=1=1] the layer filter clause\r\n     * @param {string} [options.outFields=*] comma separated list of output fields, defaults to all\r\n     * @param {string} [options.format=pjson] the format the retrieve the data\r\n     * @param {number} [options.outSR=3857] the output spatial reference, defaults to web mercator\r\n     * @param {boolean} [options.useEsriStyle=false] if the map service style should be used\r\n     * @param {boolean} [options.collapseLegend=false] if the legend should be initially collapsed\r\n     * @param {number} [options.mapMoveMakeGetParams=function(extent, zoomLevel){}] function to create additional map move params\r\n     */\r\n    constructor(url: string, options: LayerBaseVectorEsriOptions) {\r\n\r\n        if (typeof options.params != 'object') {\r\n            options.params = {};\r\n        }\r\n        options.params['where'] = options.where || '1=1';\r\n        options.params['outFields'] = options.outFields || '*';\r\n        options.params['f'] = options.format || 'pjson';\r\n        options.params['outSR'] = options.outSR || 3857;\r\n\r\n        super(url, options);\r\n        this._outSR = this.params['outSR'];\r\n        this._esriFormat = new ol.format.EsriJSON();\r\n\r\n        if (this._url[this._url.length - 1] !== '/') {\r\n            this._url += '/';\r\n        }\r\n\r\n        this._urlCopy = this.url;\r\n        this._url += 'query?callback=?';\r\n\r\n        if (this.autoLoad || this.visible) {\r\n            this._load();\r\n        }\r\n\r\n        this._useEsriStyle = typeof options.useEsriStyle == 'boolean' ? options.useEsriStyle : false;\r\n\r\n        if (this._useEsriStyle) {\r\n            this.addLegendContent();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * add additional content to the legend\r\n     * @param {string} [additionalContent=''] additional content to add to legend\r\n     */\r\n    addLegendContent(additionalContent?: string) {\r\n        if (!this._useEsriStyle) {\r\n            super.addLegendContent(additionalContent);\r\n        } else {\r\n            $.get(this._urlCopy + '?f=pjson&callback=?', {}, (d) => {\r\n                if (d['subLayers'].length > 0) {\r\n                    alert('should only use single feature layers, not groups');\r\n\r\n                    return;\r\n                }\r\n\r\n                let newStyleAndLegend = esriToOl.makeFeatureServiceLegendAndSymbol(d);\r\n                this.style = newStyleAndLegend.style;\r\n                super.addLegendContent(newStyleAndLegend.legend);\r\n            }, 'json');\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * add feature collection\r\n     * @param {object} featureCollection - features as esrijson\r\n     */\r\n    addFeatures(featureCollection) {\r\n        let feats = this._esriFormat.readFeatures(featureCollection);\r\n        this.source.addFeatures(feats);\r\n    }\r\n\r\n    /**\r\n     * trigger load features\r\n     * @protected\r\n     * @returns {boolean} if already loaded\r\n     */\r\n    _load() {\r\n        if (super._load()) {\r\n            return true;\r\n        }\r\n        $.get(this._url, this.params, (d) => {\r\n            this.addFeatures(d);\r\n            this.loadCallback(this);\r\n        }, 'json').fail(() => {\r\n                this._loaded = false;\r\n            });\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * callback to generate the parameters passed in the get request\r\n     * @param {object} extent - extent object\r\n     * @param {number} extent.minX - minX\r\n     * @param {number} extent.minY - minY\r\n     * @param {number} extent.maxX - maxX\r\n     * @param {number} extent.maxY - maxY\r\n     * @param {number} zoomLevel - zoom level\r\n     */\r\n    mapMoveMakeGetParams(extent, zoomLevel) {\r\n        super.mapMoveMakeGetParams(extent, zoomLevel);\r\n        this.mapMoveParams['geometry'] = `${extent.minX},${extent.minY},${extent.maxX},${extent.maxY}`;\r\n        this.mapMoveParams['geometryType'] = 'esriGeometryEnvelope';\r\n        this.mapMoveParams['spatialRel'] = 'esriSpatialRelIntersects';\r\n        this.mapMoveParams['spatialRel'] = 'esriSpatialRelIntersects';\r\n        this.mapMoveParams['inSR'] = 3857;\r\n        if (this._outSR == 3857) {\r\n            this.mapMoveParams['geometryPrecision'] = 1;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Before call to map move callback, can prevent call by returning false\r\n     * @param {number} zoom - zoom level\r\n     * @param {string} [evtType=undefined] undefined for initial load, otherwise one of 'change:center', 'change:resolution'\r\n     * @returns {boolean} if the call should proceed\r\n     */\r\n    mapMoveBefore(zoom, evtType) {\r\n        return super.mapMoveBefore(zoom, evtType);\r\n        //if (super.mapMoveBefore(zoom, evtType)){\r\n        //    //place holder for additional processing\r\n        //    return true;\r\n        //} else {\r\n        //    return false;\r\n        //}\r\n    }\r\n\r\n    /**\r\n     * callback function on map move\r\n     * @param {object} d - the json response\r\n     */\r\n    mapMoveCallback(d) {\r\n        super.mapMoveCallback(d);\r\n        this.source.addFeatures(this._esriFormat.readFeatures(d));\r\n    }\r\n}\r\n\r\nnm.LayerBaseVectorEsri = LayerBaseVectorEsri;\r\nexport default LayerBaseVectorEsri;\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/layers/LayerBaseVectorEsri.ts","/**\r\n * Created by gavorhes on 11/4/2015.\r\n */\r\n\r\nimport {LayerBaseXyzTile} from './LayerBaseXyzTile';\r\nimport {LayerBaseOptions} from './LayerBase';\r\nimport RealEarthAnimateTile from '../mixin/RealEarthAnimateTile';\r\nimport provide from '../util/provide';\r\nimport {IRealEarthAnimate, timesLoadedCallback} from \"../mixin/RealEarthAnimate\";\r\nconst nm = provide('layers');\r\n\r\nexport interface LayerRealEarthTileOptions extends LayerBaseOptions {\r\n    products: string;\r\n    animate?: boolean;\r\n    timeLoadCallback?: timesLoadedCallback;\r\n}\r\n\r\n\r\n/**\r\n * Real earth tile\r\n * @augments LayerBaseXyzTile\r\n */\r\nexport class LayerRealEarthTile extends LayerBaseXyzTile implements IRealEarthAnimate {\r\n    _products: string;\r\n    animator: RealEarthAnimateTile;\r\n\r\n    /**\r\n     * The base layer for all others\r\n     * @param {object} options - config\r\n     * @param {string} [options.id] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] the z index for the layer\r\n     * @param {function} [options.loadCallback] function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent] additional content to add to the legend\r\n     *\r\n     * @param {string} options.products - the products to request\r\n     * @param {boolean} [options.hasTimes=false] If the layer is time dependent, fixed set of dates\r\n     * @param {boolean} [options.animate=false] if the layer should be animated\r\n     */\r\n    constructor(options: LayerRealEarthTileOptions) {\r\n        options.animate = typeof options.animate == 'boolean' ? options.animate : false;\r\n        if (options.animate) {\r\n            super('', options);\r\n            this._products = options.products;\r\n            this.animator = new RealEarthAnimateTile(this, options.timeLoadCallback);\r\n            this.animator.timeInit();\r\n        } else {\r\n            super(`http://realearth.ssec.wisc.edu/api/image?products=${options.products}&x={x}&y={y}&z={z}`, options);\r\n            this._products = options.products;\r\n        }\r\n    }\r\n\r\n    setLayerTime(theTime: number): boolean {\r\n        if (this.animator) {\r\n            return this.animator.setLayerTime(theTime);\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    _load(): boolean {\r\n        if (this.animator) {\r\n            return false;\r\n        }\r\n        return super._load();\r\n    }\r\n}\r\n\r\nnm.LayerRealEarthTile = LayerRealEarthTile;\r\nexport default LayerRealEarthTile;\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/layers/LayerRealEarthTile.ts","/**\r\n * Created by gavorhes on 12/4/2015.\r\n */\r\nimport {LayerBase, LayerBaseOptions} from './LayerBase';\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nconst nm = provide('layers');\r\n\r\n\r\n/**\r\n * XYZ tile\r\n * @augments LayerBase\r\n */\r\nexport class LayerBaseXyzTile extends LayerBase {\r\n\r\n\r\n    /**\r\n     * The XYZ tile layer\r\n     * @param {string} url - url for source\r\n     * @param {object} options - config\r\n     * @param {string} [options.id] - layer id\r\n     * @param {string} [options.name=Unnamed Layer] - layer name\r\n     * @param {number} [options.opacity=1] - opacity\r\n     * @param {boolean} [options.visible=true] - default visible\r\n     * @param {number} [options.minZoom=undefined] - min zoom level, 0 - 28\r\n     * @param {number} [options.maxZoom=undefined] - max zoom level, 0 - 28\r\n     * @param {object} [options.params={}] the get parameters to include to retrieve the layer\r\n     * @param {number} [options.zIndex=0] the z index for the layer\r\n     * @param {function} [options.loadCallback] function to call on load, context this is the layer object\r\n     * @param {boolean} [options.legendCollapse=false] if the legend item should be initially collapsed\r\n     * @param {boolean} [options.legendCheckbox=true] if the legend item should have a checkbox for visibility\r\n     * @param {boolean} [options.legendContent] additional content to add to the legend\r\n     * @param {boolean} [options.useEsriStyle=false] if the map service style should be used\r\n     */\r\n    constructor(url: string, options: LayerBaseOptions = {}) {\r\n        super(url, options);\r\n        this._source = new ol.source.XYZ({url: this.url == '' ? undefined : this.url});\r\n\r\n        this._olLayer = new ol.layer.Tile({\r\n            source: this._source as ol.source.XYZ,\r\n            visible: this.visible,\r\n            opacity: this.opacity,\r\n            minResolution: this._minResolution,\r\n            maxResolution: this._maxResolution\r\n        } );\r\n\r\n        this._olLayer.setZIndex(this._zIndex);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {ol.source.XYZ} the vector source\r\n     */\r\n    get source(): ol.source.XYZ {\r\n        return this._source as ol.source.XYZ;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {ol.layer.Tile|ol.layer.Base|undefined} the ol layer\r\n     */\r\n    get olLayer() : ol.layer.Tile {\r\n        return this._olLayer as ol.layer.Tile;\r\n    }\r\n}\r\n\r\nnm.LayerBaseXyzTile = LayerBaseXyzTile;\r\nexport default LayerBaseXyzTile;\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/layers/LayerBaseXyzTile.ts","/**\r\n * Created by gavorhes on 12/4/2015.\r\n */\r\nimport provide from '../util/provide';\r\nimport mapPopup from '../olHelpers/mapPopup';\r\nimport LayerRealEarthTile from \"../layers/LayerRealEarthTile\";\r\nimport {LayerVectorRealEarth} from '../layers/LayerRealEarthVector'\r\nimport $ = require('jquery');\r\n\r\nconst nm = provide('mixin');\r\n\r\n\r\n/**\r\n * The GMT offset time in minutes\r\n * @type {number}\r\n */\r\nlet offsetMinutes = (new Date()).getTimezoneOffset();\r\n\r\nexport interface IRealEarthAnimate{\r\n    setLayerTime(theTime: number): boolean;\r\n}\r\n\r\nexport interface timesLoadedCallback{\r\n    (lyr?: LayerRealEarthTile|LayerVectorRealEarth): void;\r\n}\r\n\r\n\r\n/**\r\n * Mixin to get the product times\r\n * Be sure to call getTimeInit after the mixin has been applied\r\n */\r\nexport class RealEarthAnimate {\r\n    _animateEnabled: boolean;\r\n    _currentIndex: number;\r\n    _localDates: Date[];\r\n    _rawDateStrings: string[];\r\n    _products: string;\r\n    loadCallback: timesLoadedCallback;\r\n    localTimes: number[];\r\n    _currentTime: number;\r\n\r\n    lyr: LayerRealEarthTile|LayerVectorRealEarth;\r\n\r\n    constructor(lyr: LayerRealEarthTile|LayerVectorRealEarth, loadCallback?: timesLoadedCallback){\r\n        this.lyr = lyr;\r\n        this._products = lyr._products;\r\n        if (loadCallback){\r\n            this.loadCallback = loadCallback;\r\n        } else {\r\n            this.loadCallback = function(): void {return;};\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * Call this after the mixin has been applied\r\n     */\r\n    timeInit() {\r\n\r\n        this._rawDateStrings = [];\r\n        this._localDates = [];\r\n        this.localTimes = [];\r\n        this._animateEnabled = true;\r\n        // this._loaded = true;\r\n        this._currentTime = undefined;\r\n        this._currentIndex = undefined;\r\n\r\n        $.get('http://realearth.ssec.wisc.edu/api/products', {products: this._products}, (d) => {\r\n            if (d.length == 0) {\r\n                console.log(`${this._products} layer not available or does not have times`);\r\n\r\n                return;\r\n            }\r\n            d = d[0];\r\n            for (let i = 0; i < d['times'].length; i++) {\r\n                this._loadDates.call(this, d['times'][i]);\r\n            }\r\n            this.loadCallback.call(this.lyr, this.lyr);\r\n            this._loadLatest.call(this);\r\n        }, 'json');\r\n    }\r\n\r\n\r\n    /**\r\n     * Given the raw time string, add to the arrays to keep track of dates and cache\r\n     * @param {string} inString - input string to parse\r\n     * @returns {string} the converted string\r\n     * @protected\r\n     */\r\n    _loadDates(inString: string): string {\r\n        let yr = inString.slice(0, 4);\r\n        let month = inString.slice(4, 6);\r\n        let d = inString.slice(6, 8);\r\n        let hr = inString.slice(9, 11);\r\n        let mn = inString.slice(11, 13);\r\n        let sec = inString.slice(13, 15);\r\n\r\n        let rawDateStr = inString.replace('.', '_');\r\n        this._rawDateStrings.push(rawDateStr);\r\n\r\n        let dteStr = `${month}/${d}/${yr} ${hr}:${mn}:${sec}`;\r\n        let newDte = new Date(dteStr);\r\n        newDte.setMinutes(newDte.getMinutes() - offsetMinutes);\r\n        this._localDates.push(newDte);\r\n        this.localTimes.push(newDte.getTime());\r\n\r\n        return rawDateStr;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @protected\r\n     * @returns {boolean} if should continue\r\n     */\r\n    _loadLatest(){\r\n        mapPopup.closePopup();\r\n        if (this.localTimes.length > 0){\r\n            this._currentIndex = this.localTimes.length -1;\r\n\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {number} theTime - the time\r\n     * @returns {boolean} true if new index, false if the same or below lowest value\r\n     */\r\n    setLayerTime(theTime: number): boolean{\r\n\r\n        this._currentTime = theTime;\r\n\r\n        let newIndex;\r\n\r\n        if (theTime < this.localTimes[0]){\r\n            return false;\r\n        } else if (theTime > this.localTimes[this.localTimes.length - 1]){\r\n            newIndex = this.localTimes.length - 1;\r\n        }\r\n\r\n        for (let i = 0; i < this.localTimes.length; i++){\r\n            if (this.localTimes[i] >= theTime){\r\n                newIndex = i;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (newIndex == this._currentIndex){\r\n            return false;\r\n        } else {\r\n            this._currentIndex = newIndex;\r\n            mapPopup.closePopup();\r\n\r\n            return true;\r\n        }\r\n    }\r\n}\r\n\r\nnm.RealEarthAnimate = RealEarthAnimate;\r\nexport default RealEarthAnimate;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/mixin/RealEarthAnimate.ts","/**\r\n * Created by gavorhes on 12/4/2015.\r\n */\r\nimport RealEarthAnimate from './RealEarthAnimate';\r\nimport provide from '../util/provide';\r\nimport ol = require('custom-ol');\r\nimport LayerRealEarthTile from \"../layers/LayerRealEarthTile\";\r\nconst nm = provide('mixin');\r\n\r\n/**\r\n * Animate real earth tile\r\n * @augments RealEarthAnimate\r\n */\r\nclass RealEarthAnimateTile extends RealEarthAnimate {\r\n    _sourceUrls: string[];\r\n    _source: ol.source.XYZ;\r\n    _olLayer: ol.layer.Tile;\r\n\r\n    constructor(layer: LayerRealEarthTile, loadCallback?: (lyr: LayerRealEarthTile) => void){\r\n        super(layer, loadCallback);\r\n        this._source = layer.source;\r\n        this._olLayer = layer.olLayer;\r\n    }\r\n\r\n\r\n\r\n    timeInit() {\r\n        super.timeInit();\r\n        this._sourceUrls = [];\r\n    }\r\n\r\n    _loadDates(inString: string): string {\r\n        let rawDte = super._loadDates(inString);\r\n        let dteProductUrl =\r\n            `http://realearth.ssec.wisc.edu/api/image?products=${this._products}_${rawDte}&x={x}&y={y}&z={z}`;\r\n        this._sourceUrls.push(dteProductUrl);\r\n        return '';\r\n    }\r\n\r\n    /**\r\n     * @protected\r\n     */\r\n    _loadLatest(): boolean {\r\n        if (super._loadLatest()){\r\n            this._source.setUrl(this._sourceUrls[this._sourceUrls.length - 1]);\r\n        }\r\n        return true;\r\n    }\r\n\r\n    setLayerTime(theTime: number): boolean {\r\n        if (super.setLayerTime(theTime)) {\r\n            if (this._olLayer.getZIndex() < 0){\r\n                this._olLayer.setZIndex(0);\r\n            }\r\n            this._source.setUrl(this._sourceUrls[this._currentIndex]);\r\n        } else {\r\n            this._olLayer.setZIndex(-1);\r\n        }\r\n        return true;\r\n    }\r\n}\r\n\r\nnm.RealEarthAnimateTile = RealEarthAnimateTile;\r\nexport default RealEarthAnimateTile;\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/mixin/RealEarthAnimateTile.ts","import {quickMap} from '../olHelpers/quickMap';\r\nimport LayerRealEarthTile from \"../layers/LayerRealEarthTile\";\r\nimport {MediaControl, changeFunction} from \"../domUtil/media-control\";\r\nimport $ = require('jquery');\r\nimport {LayerBaseVectorEsri} from \"../layers/LayerBaseVectorEsri\";\r\nimport {LayerEsriMapServer} from \"../layers/LayerEsriMapServer\";\r\nimport 'jquery-ui';\r\n\r\n\r\nlet nexrhresStatic = new LayerRealEarthTile({\r\n        products: 'nexrhres',\r\n        id: 'nexrhres-static',\r\n        opacity: 0.6,\r\n        animate: true,\r\n        name: 'Hybrid Reflectivity',\r\n        // maxZoom: 10,\r\n        timeLoadCallback: function (f) {\r\n            console.log(f);\r\n        }\r\n    }\r\n);\r\n\r\n\r\nlet d = new Date();\r\nlet endTime = d.getTime();\r\nd.setHours(d.getHours() - 4);\r\nlet startTime = d.getTime();\r\nlet rangeStep = Math.round((endTime - startTime) / 8);\r\n\r\nlet media = new MediaControl(\r\n    $('#control'),\r\n    (v: number) => {\r\n        nexrhresStatic.setLayerTime(v);\r\n    },\r\n    {\r\n        min: startTime,\r\n        max: endTime,\r\n        val: endTime,\r\n        step: rangeStep,\r\n        playInterval: 750,\r\n        showAsDate: true\r\n    }\r\n);\r\n\r\n\r\nlet map = quickMap();\r\nmap.addLayer(nexrhresStatic.olLayer);\r\n\r\n\r\nlet coordinationLayer = new LayerBaseVectorEsri(\r\n    'http://transportal.cee.wisc.edu/applications/arcgis2/rest/services/GLRTOC/GlrtocCoordination/MapServer/0',\r\n    {\r\n        visible: true,\r\n        autoLoad: true,\r\n        name: 'Coordination',\r\n        useEsriStyle: true\r\n    }\r\n);\r\n\r\nmap.addLayer(coordinationLayer.olLayer);\r\n\r\n    let oakRidgeLayers = [\r\n        ['Cameras', 'cameras33'],\r\n        ['HAR', 'HAR33'],\r\n        ['DMS', 'MessageSigns33'],\r\n        //['State Summary', 'statesummary'],\r\n        ['Traffic Control', 'TrafficControl33'],\r\n        ['Traffic Detection', 'TrafficDetectionMulti'],\r\n        ['Weather', 'Weather33']\r\n    ];\r\n\r\n\r\n    for (let i = 0; i < oakRidgeLayers.length; i++) {\r\n        let oakRidgeLayer = new LayerEsriMapServer(\r\n            `http://itsdpro.ornl.gov/arcgis/rest/services/ITSPublic/${oakRidgeLayers[i][1]}/MapServer`,\r\n            {\r\n                id: oakRidgeLayers[i][1],\r\n                name: oakRidgeLayers[i][0],\r\n                visible: true,\r\n                minZoom: 7,\r\n                zIndex: 20,\r\n                addPopup: true,\r\n                legendCollapse: true\r\n            }\r\n        );\r\n        map.addLayer(oakRidgeLayer.olLayer);\r\n    }\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ../../src/_test/animate.ts"],"sourceRoot":""}